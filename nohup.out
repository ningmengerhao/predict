2022-07-18 22:13:43.274 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 22:13:43.274 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 22:13:44,895 - tool.dba - INFO - Read data with sql
2022-07-18 22:13:44,895 - tool.dba - INFO - SELECT * FROM CARVIEW
Traceback (most recent call last):
  File "/home/zyuser/predict/task.py", line 4, in <module>
    from tool.logistics.predict import *
  File "/home/zyuser/predict/tool/logistics/predict.py", line 17, in <module>

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

    car = oracle155.read("SELECT * FROM CARVIEW")
  File "/home/zyuser/predict/tool/dba.py", line 36, in read
    self.cursor.execute(sql)
cx_Oracle.DatabaseError: ORA-00942: table or view does not exist
  Stopping...
2022-07-18 22:14:52.034 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 22:14:52.034 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 22:14:53,134 - tool.dba - INFO - Read data with sql
2022-07-18 22:14:53,134 - tool.dba - INFO - SELECT * FROM CARVIEW
Traceback (most recent call last):
  File "/home/zyuser/predict/task.py", line 4, in <module>
    from tool.logistics.predict import *
  File "/home/zyuser/predict/tool/logistics/predict.py", line 17, in <module>
    car = oracle155.read("SELECT * FROM CARVIEW")
  File "/home/zyuser/predict/tool/dba.py", line 36, in read
    self.cursor.execute(sql)
cx_Oracle.DatabaseError: ORA-00942: table or view does not exist

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

  Stopping...
2022-07-18 22:30:54.251 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 22:30:54.251 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 22:30:55,306 - tool.dba - INFO - Read data with sql
2022-07-18 22:30:55,306 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 22:30:55,309 - tool.dba - INFO - finish read total 3 rows
2022-07-18 22:30:55,428 - tool.dba - INFO - Read data with sql
2022-07-18 22:30:55,428 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 22:30:55,712 - tool.dba - INFO - finish read total 7998 rows
2022-07-18 22:30:55,713 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 22:30:55,713 - tool.dba - INFO - Read data with sql
2022-07-18 22:30:55,713 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

  Stopping...
2022-07-18 22:31:52.908 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 22:31:52.908 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 22:31:53,999 - tool.dba - INFO - Read data with sql
2022-07-18 22:31:53,999 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 22:31:54,002 - tool.dba - INFO - finish read total 3 rows
2022-07-18 22:31:54,081 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 22:31:54,081 - tool.dba - INFO - Read data with sql
2022-07-18 22:31:54,081 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-18 22:32:39,958 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 22:32:54,591 - tool.dba - INFO - Read data with sql
2022-07-18 22:32:54,592 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 22:32:54,837 - tool.dba - INFO - finish read total 7998 rows
2022-07-18 22:32:54,837 - tool.dba - INFO - Read data with sql
2022-07-18 22:32:54,837 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 22:32:55,148 - tool.dba - INFO - Read data with sql
2022-07-18 22:32:55,148 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 22:32:55,398 - tool.dba - INFO - finish read total 7998 rows
2022-07-18 22:32:55,399 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 22:32:55,399 - tool.dba - INFO - Read data with sql
2022-07-18 22:32:55,399 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-18 22:33:41,209 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 22:33:55,552 - tool.dba - INFO - Read data with sql
2022-07-18 22:33:55,552 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 22:33:55,804 - tool.dba - INFO - finish read total 7998 rows
2022-07-18 22:33:55,804 - tool.dba - INFO - Read data with sql
2022-07-18 22:33:55,804 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 22:33:55,851 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-18 22:33:55,853 - tool.dba - INFO - Read data with sql
2022-07-18 22:33:55,853 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:34:33,347 - tool.dba - INFO - finish read total 4776447 rows
2022-07-18 22:34:34,196 - tool.dba - INFO - Read data with sql
2022-07-18 22:34:34,196 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-18 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:34:58,130 - tool.dba - INFO - finish read total 2911245 rows
2022-07-18 22:34:58,951 - tool.dba - INFO - Read data with sql
2022-07-18 22:34:58,951 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-18 22:34:58,961 - tool.dba - INFO - finish read total 821 rows
2022-07-18 22:34:58,961 - tool.dba - INFO - Read data with sql
2022-07-18 22:34:58,961 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-18 22:34:58,987 - tool.dba - INFO - finish read total 5316 rows
2022-07-18 22:34:58,992 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-18 22:34:58,996 - tool.dba - INFO - Read data with sql
2022-07-18 22:34:58,996 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-01-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:35:19,794 - tool.dba - INFO - finish read total 2411192 rows
2022-07-18 22:35:20,246 - tool.dba - INFO - Read data with sql
2022-07-18 22:35:20,246 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-02-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-02-28 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:35:33,060 - tool.dba - INFO - finish read total 1526370 rows
2022-07-18 22:35:33,419 - tool.dba - INFO - Read data with sql
2022-07-18 22:35:33,419 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-03-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-03-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:35:56,854 - tool.dba - INFO - finish read total 2780033 rows
2022-07-18 22:35:57,432 - tool.dba - INFO - Read data with sql
2022-07-18 22:35:57,433 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-04-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-04-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:36:21,578 - tool.dba - INFO - finish read total 2858510 rows
2022-07-18 22:36:22,209 - tool.dba - INFO - Read data with sql
2022-07-18 22:36:22,209 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-05-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-05-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:36:48,663 - tool.dba - INFO - finish read total 3149113 rows
2022-07-18 22:36:49,340 - tool.dba - INFO - Read data with sql
2022-07-18 22:36:49,340 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:37:15,815 - tool.dba - INFO - finish read total 3203536 rows
2022-07-18 22:37:16,524 - tool.dba - INFO - Read data with sql
2022-07-18 22:37:16,524 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-07-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:37:45,201 - tool.dba - INFO - finish read total 3465862 rows
2022-07-18 22:37:45,968 - tool.dba - INFO - Read data with sql
2022-07-18 22:37:45,968 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-08-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-08-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:38:14,950 - tool.dba - INFO - finish read total 3510824 rows
2022-07-18 22:38:15,745 - tool.dba - INFO - Read data with sql
2022-07-18 22:38:15,745 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-09-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-09-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:38:41,726 - tool.dba - INFO - finish read total 3165659 rows
2022-07-18 22:38:42,447 - tool.dba - INFO - Read data with sql
2022-07-18 22:38:42,447 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-10-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-10-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:39:08,808 - tool.dba - INFO - finish read total 3143695 rows
2022-07-18 22:39:09,523 - tool.dba - INFO - Read data with sql
2022-07-18 22:39:09,523 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-11-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-11-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:39:32,122 - tool.dba - INFO - finish read total 2937364 rows
2022-07-18 22:39:32,748 - tool.dba - INFO - Read data with sql
2022-07-18 22:39:32,748 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2019-12-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2019-12-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:39:54,490 - tool.dba - INFO - finish read total 2912745 rows
2022-07-18 22:39:55,096 - tool.dba - INFO - Read data with sql
2022-07-18 22:39:55,096 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-01-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:40:10,092 - tool.dba - INFO - finish read total 1987885 rows
2022-07-18 22:40:10,562 - tool.dba - INFO - Read data with sql
2022-07-18 22:40:10,562 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-02-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-02-29 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:40:18,022 - tool.dba - INFO - finish read total 854105 rows
2022-07-18 22:40:18,269 - tool.dba - INFO - Read data with sql
2022-07-18 22:40:18,270 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-03-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-03-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:40:41,400 - tool.dba - INFO - finish read total 3042610 rows
2022-07-18 22:40:41,968 - tool.dba - INFO - Read data with sql
2022-07-18 22:40:41,968 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-04-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-04-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:41:06,857 - tool.dba - INFO - finish read total 3308868 rows
2022-07-18 22:41:07,539 - tool.dba - INFO - Read data with sql
2022-07-18 22:41:07,540 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-05-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-05-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:41:35,021 - tool.dba - INFO - finish read total 3687744 rows
2022-07-18 22:41:35,774 - tool.dba - INFO - Read data with sql
2022-07-18 22:41:35,774 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:42:03,170 - tool.dba - INFO - finish read total 3658688 rows
2022-07-18 22:42:03,971 - tool.dba - INFO - Read data with sql
2022-07-18 22:42:03,971 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-07-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:42:33,142 - tool.dba - INFO - finish read total 3909840 rows
2022-07-18 22:42:33,981 - tool.dba - INFO - Read data with sql
2022-07-18 22:42:33,981 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-08-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-08-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:43:15,437 - tool.dba - INFO - finish read total 4063524 rows
2022-07-18 22:43:16,305 - tool.dba - INFO - Read data with sql
2022-07-18 22:43:16,305 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-09-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-09-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:43:43,131 - tool.dba - INFO - finish read total 3675814 rows
2022-07-18 22:43:43,896 - tool.dba - INFO - Read data with sql
2022-07-18 22:43:43,897 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-10-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-10-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:44:07,975 - tool.dba - INFO - finish read total 3316931 rows
2022-07-18 22:44:08,705 - tool.dba - INFO - Read data with sql
2022-07-18 22:44:08,705 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-11-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-11-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:44:33,361 - tool.dba - INFO - finish read total 3309002 rows
2022-07-18 22:44:34,068 - tool.dba - INFO - Read data with sql
2022-07-18 22:44:34,069 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2020-12-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2020-12-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:44:58,345 - tool.dba - INFO - finish read total 3267297 rows
2022-07-18 22:44:59,056 - tool.dba - INFO - Read data with sql
2022-07-18 22:44:59,056 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-01-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:45:23,890 - tool.dba - INFO - finish read total 3321413 rows
2022-07-18 22:45:24,588 - tool.dba - INFO - Read data with sql
2022-07-18 22:45:24,588 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-02-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-02-28 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:45:43,386 - tool.dba - INFO - finish read total 2553991 rows
2022-07-18 22:45:43,980 - tool.dba - INFO - Read data with sql
2022-07-18 22:45:43,980 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-03-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-03-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:46:10,769 - tool.dba - INFO - finish read total 3504007 rows
2022-07-18 22:46:11,481 - tool.dba - INFO - Read data with sql
2022-07-18 22:46:11,481 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-04-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-04-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:46:39,912 - tool.dba - INFO - finish read total 3706702 rows
2022-07-18 22:46:40,662 - tool.dba - INFO - Read data with sql
2022-07-18 22:46:40,663 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-05-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-05-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:47:11,083 - tool.dba - INFO - finish read total 4067351 rows
2022-07-18 22:47:11,902 - tool.dba - INFO - Read data with sql
2022-07-18 22:47:11,903 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:47:44,269 - tool.dba - INFO - finish read total 4096402 rows
2022-07-18 22:47:45,125 - tool.dba - INFO - Read data with sql
2022-07-18 22:47:45,125 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-07-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:48:22,206 - tool.dba - INFO - finish read total 4560624 rows
2022-07-18 22:48:23,161 - tool.dba - INFO - Read data with sql
2022-07-18 22:48:23,161 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-08-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-08-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:48:57,656 - tool.dba - INFO - finish read total 4600519 rows
2022-07-18 22:48:58,612 - tool.dba - INFO - Read data with sql
2022-07-18 22:48:58,613 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-09-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-09-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:49:31,207 - tool.dba - INFO - finish read total 4192347 rows
2022-07-18 22:49:32,095 - tool.dba - INFO - Read data with sql
2022-07-18 22:49:32,095 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-10-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-10-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:50:05,058 - tool.dba - INFO - finish read total 4039159 rows
2022-07-18 22:50:05,897 - tool.dba - INFO - Read data with sql
2022-07-18 22:50:05,897 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-11-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-11-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:50:40,103 - tool.dba - INFO - finish read total 3752278 rows
2022-07-18 22:50:40,890 - tool.dba - INFO - Read data with sql
2022-07-18 22:50:40,891 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2021-12-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2021-12-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:51:10,659 - tool.dba - INFO - finish read total 3782115 rows
2022-07-18 22:51:11,447 - tool.dba - INFO - Read data with sql
2022-07-18 22:51:11,447 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-01-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-01-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:51:38,043 - tool.dba - INFO - finish read total 3509145 rows
2022-07-18 22:51:38,789 - tool.dba - INFO - Read data with sql
2022-07-18 22:51:38,789 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-02-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-02-28 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:51:59,683 - tool.dba - INFO - finish read total 2849457 rows
2022-07-18 22:52:00,309 - tool.dba - INFO - Read data with sql
2022-07-18 22:52:00,309 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-03-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-03-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:52:30,417 - tool.dba - INFO - finish read total 4041807 rows
2022-07-18 22:52:31,193 - tool.dba - INFO - Read data with sql
2022-07-18 22:52:31,193 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-04-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-04-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:52:58,312 - tool.dba - INFO - finish read total 3587571 rows
2022-07-18 22:52:59,087 - tool.dba - INFO - Read data with sql
2022-07-18 22:52:59,087 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-05-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-05-31 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:53:29,390 - tool.dba - INFO - finish read total 4056195 rows
2022-07-18 22:53:30,225 - tool.dba - INFO - Read data with sql
2022-07-18 22:53:30,225 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:54:06,197 - tool.dba - INFO - finish read total 4776447 rows
2022-07-18 22:54:07,203 - tool.dba - INFO - Read data with sql
2022-07-18 22:54:07,203 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-18 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 22:54:29,199 - tool.dba - INFO - finish read total 2911245 rows
2022-07-18 22:55:45,529 - tool.dba - INFO - Read data with sql
2022-07-18 22:55:45,529 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 22:55:45,794 - tool.dba - INFO - finish read total 7998 rows
2022-07-18 22:55:45,794 - tool.dba - INFO - Read data with sql
2022-07-18 22:55:45,795 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 22:55:45,804 - tool.dba - INFO - Read data with sql
2022-07-18 22:55:45,804 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-18 22:55:53,367 - tool.dba - INFO - finish read total 12116 rows
2022-07-18 22:55:53,568 - tool.dba - INFO - Read data with sql
2022-07-18 22:55:53,568 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-18 22:57:40,347 - tool.dba - INFO - finish read total 5938664 rows
2022-07-18 22:57:52,481 - tool.dba - INFO - Read data with sql
2022-07-18 22:57:52,481 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 22:57:52,712 - tool.dba - INFO - finish read total 7998 rows
2022-07-18 22:57:52,712 - tool.dba - INFO - Read data with sql
2022-07-18 22:57:52,712 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 22:57:52,718 - tool.dba - INFO - Read data with sql
2022-07-18 22:57:52,718 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
  Stopping...
2022-07-18 23:00:32.999 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 23:00:32.999 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 23:00:34,084 - tool.dba - INFO - Read data with sql
2022-07-18 23:00:34,084 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 23:00:34,087 - tool.dba - INFO - finish read total 3 rows
2022-07-18 23:00:34,167 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 23:00:34,167 - tool.dba - INFO - Read data with sql
2022-07-18 23:00:34,167 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-18 23:01:20,595 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 23:01:35,280 - tool.dba - INFO - Read data with sql
2022-07-18 23:01:35,280 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:01:35,532 - tool.dba - INFO - finish read total 7999 rows
2022-07-18 23:01:35,533 - tool.dba - INFO - Read data with sql
2022-07-18 23:01:35,533 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:01:35,553 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:04:13,493 - tool.dba - INFO - Read data with sql
2022-07-18 23:04:13,493 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:04:13,756 - tool.dba - INFO - finish read total 7999 rows
2022-07-18 23:04:13,757 - tool.dba - INFO - Create data with sql
2022-07-18 23:04:13,758 - tool.dba - INFO - 
        create table ZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
TRUE		NUMBER(19, 3),
PREDICT		NUMBER(19, 3),
            constraint G20220718230413_pk primary key (STORE_ID,DS)
        )
        
2022-07-18 23:04:13,841 - tool.dba - INFO - Read data with sql
2022-07-18 23:04:13,841 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:04:14,086 - tool.dba - INFO - finish read total 8000 rows
2022-07-18 23:04:14,087 - tool.dba - INFO - create table finish
2022-07-18 23:04:14,087 - tool.dba - INFO - Delete data with sql
2022-07-18 23:04:14,154 - tool.dba - INFO - Create data with sql
2022-07-18 23:04:14,154 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint G20220718230414_pk primary key (STORE_ID,DS)
        )
        
2022-07-18 23:04:14,173 - tool.dba - INFO - Read data with sql
2022-07-18 23:04:14,173 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:04:14,419 - tool.dba - INFO - finish read total 8001 rows
2022-07-18 23:04:14,420 - tool.dba - INFO - create table finish
2022-07-18 23:04:14,421 - tool.dba - INFO - insert data with sql
2022-07-18 23:04:14,554 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:04,  8.67it/s]  5%|▍         | 2/44 [00:00<00:04,  8.92it/s]  7%|▋         | 3/44 [00:00<00:04,  9.17it/s]  9%|▉         | 4/44 [00:00<00:05,  7.90it/s] 14%|█▎        | 6/44 [00:00<00:04,  8.97it/s] 16%|█▌        | 7/44 [00:00<00:04,  9.23it/s] 18%|█▊        | 8/44 [00:00<00:03,  9.12it/s] 20%|██        | 9/44 [00:01<00:04,  8.28it/s] 23%|██▎       | 10/44 [00:01<00:03,  8.68it/s] 25%|██▌       | 11/44 [00:01<00:03,  8.92it/s] 30%|██▉       | 13/44 [00:01<00:03,  9.40it/s] 32%|███▏      | 14/44 [00:01<00:03,  8.69it/s] 34%|███▍      | 15/44 [00:01<00:03,  8.97it/s] 39%|███▊      | 17/44 [00:01<00:02,  9.10it/s] 41%|████      | 18/44 [00:02<00:02,  9.20it/s] 43%|████▎     | 19/44 [00:02<00:03,  8.25it/s] 45%|████▌     | 20/44 [00:02<00:02,  8.56it/s] 48%|████▊     | 21/44 [00:02<00:02,  8.45it/s] 50%|█████     | 22/44 [00:02<00:02,  8.47it/s] 52%|█████▏    | 23/44 [00:02<00:02,  7.59it/s] 57%|█████▋    | 25/44 [00:02<00:02,  8.61it/s] 59%|█████▉    | 26/44 [00:02<00:02,  8.59it/s] 64%|██████▎   | 28/44 [00:03<00:01,  8.38it/s] 66%|██████▌   | 29/44 [00:03<00:01,  8.63it/s] 68%|██████▊   | 30/44 [00:03<00:01,  8.75it/s] 73%|███████▎  | 32/44 [00:03<00:01,  9.24it/s] 75%|███████▌  | 33/44 [00:03<00:01,  8.61it/s] 77%|███████▋  | 34/44 [00:03<00:01,  8.91it/s] 82%|████████▏ | 36/44 [00:04<00:00,  9.39it/s] 84%|████████▍ | 37/44 [00:04<00:00,  9.48it/s] 86%|████████▋ | 38/44 [00:04<00:00,  8.62it/s] 89%|████████▊ | 39/44 [00:04<00:00,  8.73it/s] 93%|█████████▎| 41/44 [00:04<00:00,  9.13it/s] 95%|█████████▌| 42/44 [00:04<00:00,  8.26it/s] 98%|█████████▊| 43/44 [00:04<00:00,  8.55it/s]100%|██████████| 44/44 [00:05<00:00,  8.79it/s]
2022-07-18 23:04:19,562 - tool.dba - INFO - insert finish
2022-07-18 23:04:19,566 - tool.dba - INFO - Delete data with sql
2022-07-18 23:04:19,566 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-18 23:04:19,599 - tool.dba - INFO - Delete data finish
2022-07-18 23:04:19,865 - tool.dba - INFO - insert data with sql
2022-07-18 23:04:20,006 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:05,  8.36it/s]  5%|▍         | 2/44 [00:00<00:05,  7.52it/s]  7%|▋         | 3/44 [00:00<00:06,  6.30it/s]  9%|▉         | 4/44 [00:00<00:06,  6.54it/s] 11%|█▏        | 5/44 [00:00<00:05,  7.00it/s] 14%|█▎        | 6/44 [00:00<00:05,  7.13it/s] 16%|█▌        | 7/44 [00:00<00:05,  7.38it/s] 18%|█▊        | 8/44 [00:01<00:05,  6.75it/s] 20%|██        | 9/44 [00:01<00:05,  6.99it/s] 23%|██▎       | 10/44 [00:01<00:04,  7.24it/s] 25%|██▌       | 11/44 [00:01<00:04,  7.47it/s] 27%|██▋       | 12/44 [00:01<00:04,  7.62it/s] 30%|██▉       | 13/44 [00:01<00:04,  6.91it/s] 32%|███▏      | 14/44 [00:01<00:04,  7.14it/s] 34%|███▍      | 15/44 [00:02<00:04,  7.16it/s] 36%|███▋      | 16/44 [00:02<00:03,  7.41it/s] 39%|███▊      | 17/44 [00:02<00:03,  7.55it/s] 41%|████      | 18/44 [00:02<00:03,  7.04it/s] 43%|████▎     | 19/44 [00:02<00:03,  7.37it/s] 45%|████▌     | 20/44 [00:02<00:03,  7.50it/s] 48%|████▊     | 21/44 [00:02<00:02,  7.67it/s] 50%|█████     | 22/44 [00:03<00:03,  6.97it/s] 52%|█████▏    | 23/44 [00:03<00:02,  7.21it/s] 55%|█████▍    | 24/44 [00:03<00:02,  7.53it/s] 57%|█████▋    | 25/44 [00:03<00:02,  7.58it/s] 59%|█████▉    | 26/44 [00:03<00:02,  7.72it/s] 61%|██████▏   | 27/44 [00:03<00:02,  7.02it/s] 64%|██████▎   | 28/44 [00:03<00:02,  6.71it/s] 66%|██████▌   | 29/44 [00:04<00:02,  7.16it/s] 68%|██████▊   | 30/44 [00:04<00:01,  7.20it/s] 70%|███████   | 31/44 [00:04<00:04,  3.16it/s] 73%|███████▎  | 32/44 [00:05<00:03,  3.65it/s] 75%|███████▌  | 33/44 [00:05<00:02,  4.38it/s] 77%|███████▋  | 34/44 [00:05<00:01,  5.06it/s] 80%|███████▉  | 35/44 [00:05<00:01,  5.70it/s] 82%|████████▏ | 36/44 [00:05<00:01,  6.29it/s] 84%|████████▍ | 37/44 [00:05<00:01,  6.19it/s] 86%|████████▋ | 38/44 [00:05<00:00,  6.55it/s] 89%|████████▊ | 39/44 [00:05<00:00,  6.88it/s] 91%|█████████ | 40/44 [00:06<00:00,  7.07it/s] 93%|█████████▎| 41/44 [00:06<00:00,  6.51it/s] 95%|█████████▌| 42/44 [00:06<00:00,  6.00it/s] 98%|█████████▊| 43/44 [00:06<00:00,  5.81it/s]100%|██████████| 44/44 [00:06<00:00,  6.49it/s]
2022-07-18 23:04:26,787 - tool.dba - INFO - insert finish
2022-07-18 23:04:27,121 - tool.dba - INFO - Read data with sql
2022-07-18 23:04:27,121 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:04:27,379 - tool.dba - INFO - finish read total 8000 rows
2022-07-18 23:04:27,380 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 23:04:27,380 - tool.dba - INFO - Read data with sql
2022-07-18 23:04:27,380 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-18 23:05:13,357 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 23:05:27,818 - tool.dba - INFO - Read data with sql
2022-07-18 23:05:27,818 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:05:28,080 - tool.dba - INFO - finish read total 8000 rows
2022-07-18 23:05:28,080 - tool.dba - INFO - Read data with sql
2022-07-18 23:05:28,081 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:05:28,096 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:08:04,273 - tool.dba - INFO - Read data with sql
2022-07-18 23:08:04,273 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:08:04,519 - tool.dba - INFO - finish read total 8000 rows
2022-07-18 23:08:04,520 - tool.dba - INFO - Delete data with sql
2022-07-18 23:08:04,586 - tool.dba - INFO - Create data with sql
2022-07-18 23:08:04,587 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint G20220718230804_pk primary key (STORE_ID,DS)
        )
        
2022-07-18 23:08:04,608 - tool.dba - INFO - Read data with sql
2022-07-18 23:08:04,609 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:08:04,836 - tool.dba - INFO - finish read total 8001 rows
2022-07-18 23:08:04,837 - tool.dba - INFO - create table finish
2022-07-18 23:08:04,837 - tool.dba - INFO - insert data with sql
2022-07-18 23:08:04,972 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/44 [00:00<?, ?it/s]  2%|▏         | 1/44 [00:00<00:05,  7.54it/s]  5%|▍         | 2/44 [00:00<00:04,  8.75it/s]  7%|▋         | 3/44 [00:00<00:04,  9.02it/s]  9%|▉         | 4/44 [00:00<00:04,  8.94it/s] 11%|█▏        | 5/44 [00:00<00:04,  7.80it/s] 14%|█▎        | 6/44 [00:00<00:05,  7.56it/s] 18%|█▊        | 8/44 [00:00<00:04,  8.74it/s] 23%|██▎       | 10/44 [00:01<00:03,  8.64it/s] 25%|██▌       | 11/44 [00:01<00:04,  7.75it/s] 27%|██▋       | 12/44 [00:02<00:09,  3.34it/s] 32%|███▏      | 14/44 [00:02<00:06,  4.76it/s] 34%|███▍      | 15/44 [00:02<00:05,  5.12it/s] 39%|███▊      | 17/44 [00:02<00:04,  6.15it/s] 43%|████▎     | 19/44 [00:02<00:03,  7.31it/s] 45%|████▌     | 20/44 [00:03<00:03,  7.31it/s] 48%|████▊     | 21/44 [00:03<00:02,  7.72it/s] 52%|█████▏    | 23/44 [00:03<00:02,  8.58it/s] 55%|█████▍    | 24/44 [00:03<00:02,  8.72it/s] 57%|█████▋    | 25/44 [00:03<00:02,  7.76it/s] 61%|██████▏   | 27/44 [00:03<00:01,  8.63it/s] 66%|██████▌   | 29/44 [00:04<00:01,  8.11it/s] 68%|██████▊   | 30/44 [00:04<00:01,  8.40it/s] 73%|███████▎  | 32/44 [00:04<00:01,  8.83it/s] 77%|███████▋  | 34/44 [00:04<00:01,  8.70it/s] 80%|███████▉  | 35/44 [00:04<00:01,  8.50it/s] 84%|████████▍ | 37/44 [00:04<00:00,  9.17it/s] 86%|████████▋ | 38/44 [00:05<00:00,  9.24it/s] 89%|████████▊ | 39/44 [00:05<00:01,  3.92it/s] 91%|█████████ | 40/44 [00:05<00:00,  4.59it/s] 93%|█████████▎| 41/44 [00:06<00:00,  5.27it/s] 95%|█████████▌| 42/44 [00:06<00:00,  5.71it/s]100%|██████████| 44/44 [00:06<00:00,  6.86it/s]100%|██████████| 44/44 [00:06<00:00,  6.92it/s]
2022-07-18 23:08:11,335 - tool.dba - INFO - insert finish
2022-07-18 23:08:11,339 - tool.dba - INFO - Delete data with sql
2022-07-18 23:08:11,340 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-18 23:08:30,001 - tool.dba - INFO - Delete data finish
2022-07-18 23:08:30,037 - tool.dba - INFO - insert data with sql
2022-07-18 23:08:30,176 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/44 [00:00<?, ?it/s]  5%|▍         | 2/44 [00:00<00:04,  9.55it/s]  7%|▋         | 3/44 [00:00<00:04,  9.16it/s]  9%|▉         | 4/44 [00:00<00:04,  8.98it/s] 11%|█▏        | 5/44 [00:00<00:04,  7.82it/s] 14%|█▎        | 6/44 [00:00<00:04,  8.10it/s] 16%|█▌        | 7/44 [00:00<00:04,  8.26it/s] 18%|█▊        | 8/44 [00:00<00:04,  8.39it/s] 20%|██        | 9/44 [00:01<00:04,  7.52it/s] 23%|██▎       | 10/44 [00:01<00:04,  7.78it/s] 25%|██▌       | 11/44 [00:01<00:04,  7.80it/s] 27%|██▋       | 12/44 [00:01<00:04,  7.83it/s] 30%|██▉       | 13/44 [00:01<00:03,  8.00it/s] 32%|███▏      | 14/44 [00:01<00:04,  7.23it/s] 34%|███▍      | 15/44 [00:01<00:03,  7.58it/s] 36%|███▋      | 16/44 [00:01<00:03,  7.90it/s] 39%|███▊      | 17/44 [00:02<00:03,  8.15it/s] 41%|████      | 18/44 [00:02<00:03,  7.31it/s] 43%|████▎     | 19/44 [00:02<00:03,  6.84it/s] 45%|████▌     | 20/44 [00:02<00:03,  7.29it/s] 48%|████▊     | 21/44 [00:02<00:03,  7.41it/s] 50%|█████     | 22/44 [00:02<00:02,  7.69it/s] 52%|█████▏    | 23/44 [00:02<00:02,  7.98it/s] 55%|█████▍    | 24/44 [00:03<00:02,  7.37it/s] 57%|█████▋    | 25/44 [00:03<00:02,  7.51it/s] 59%|█████▉    | 26/44 [00:03<00:02,  7.09it/s] 61%|██████▏   | 27/44 [00:03<00:02,  7.41it/s] 64%|██████▎   | 28/44 [00:03<00:02,  7.22it/s] 66%|██████▌   | 29/44 [00:03<00:01,  7.60it/s] 68%|██████▊   | 30/44 [00:03<00:01,  7.91it/s] 70%|███████   | 31/44 [00:03<00:01,  8.08it/s] 73%|███████▎  | 32/44 [00:04<00:01,  8.27it/s] 75%|███████▌  | 33/44 [00:04<00:01,  7.37it/s] 77%|███████▋  | 34/44 [00:04<00:01,  7.73it/s] 80%|███████▉  | 35/44 [00:04<00:01,  8.01it/s] 82%|████████▏ | 36/44 [00:04<00:00,  8.25it/s] 84%|████████▍ | 37/44 [00:04<00:00,  8.30it/s] 86%|████████▋ | 38/44 [00:04<00:00,  7.08it/s] 89%|████████▊ | 39/44 [00:05<00:00,  7.43it/s] 91%|█████████ | 40/44 [00:05<00:01,  3.07it/s] 93%|█████████▎| 41/44 [00:05<00:00,  3.60it/s] 95%|█████████▌| 42/44 [00:06<00:00,  4.35it/s] 98%|█████████▊| 43/44 [00:06<00:00,  4.91it/s]100%|██████████| 44/44 [00:06<00:00,  6.95it/s]
2022-07-18 23:08:36,507 - tool.dba - INFO - insert finish
2022-07-18 23:08:36,565 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-18 23:08:36,567 - tool.dba - INFO - Read data with sql
2022-07-18 23:08:36,567 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 23:09:13,420 - tool.dba - INFO - finish read total 4776447 rows
2022-07-18 23:09:14,280 - tool.dba - INFO - Read data with sql
2022-07-18 23:09:14,280 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-18 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 23:09:34,158 - tool.dba - INFO - finish read total 2911245 rows
2022-07-18 23:09:34,948 - tool.dba - INFO - Read data with sql
2022-07-18 23:09:34,948 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-18 23:09:34,957 - tool.dba - INFO - finish read total 821 rows
2022-07-18 23:09:34,957 - tool.dba - INFO - Read data with sql
2022-07-18 23:09:34,957 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-18 23:09:34,982 - tool.dba - INFO - finish read total 5316 rows
2022-07-18 23:10:51,453 - tool.dba - INFO - Read data with sql
2022-07-18 23:10:51,453 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:10:51,721 - tool.dba - INFO - finish read total 8000 rows
2022-07-18 23:10:51,721 - tool.dba - INFO - Read data with sql
2022-07-18 23:10:51,721 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:10:51,738 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:11:03,283 - tool.dba - INFO - Read data with sql
2022-07-18 23:11:03,284 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-18 23:11:03,327 - tool.dba - INFO - finish read total 5395 rows
2022-07-18 23:11:03,642 - tool.dba - INFO - Read data with sql
2022-07-18 23:11:03,642 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:11:03,908 - tool.dba - INFO - finish read total 8000 rows
2022-07-18 23:11:03,909 - tool.dba - INFO - Create data with sql
2022-07-18 23:11:03,910 - tool.dba - INFO - 
        create table ZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
SUPPORT		VARCHAR2(999),
TRUE		NUMBER(19, 3),
PREDICT		NUMBER(19, 3),
HOLIDAY_AFFECT		NUMBER(19, 3),
SAFE_STOCK		NUMBER(19, 3),
EXEDATE		DATE,
ERROR		NUMBER(19, 3),
ABS_ERROR		NUMBER(19, 3),
ERROR_PERCENTAGE		NUMBER(19, 3),
ABS_ERROR_PERCENTAGE		NUMBER(19, 3),
LABEL		VARCHAR2(999),
YH_UNIT		NUMBER(19, 3),
            constraint G20220718231103_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-18 23:11:03,950 - tool.dba - INFO - Read data with sql
2022-07-18 23:11:03,950 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:11:04,193 - tool.dba - INFO - finish read total 8001 rows
2022-07-18 23:11:04,194 - tool.dba - INFO - create table finish
2022-07-18 23:11:04,194 - tool.dba - INFO - Delete data with sql
2022-07-18 23:11:04,202 - tool.dba - INFO - Create data with sql
2022-07-18 23:11:04,203 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint G20220718231104_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-18 23:11:04,220 - tool.dba - INFO - Read data with sql
2022-07-18 23:11:04,220 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:11:04,442 - tool.dba - INFO - finish read total 8002 rows
2022-07-18 23:11:04,443 - tool.dba - INFO - create table finish
2022-07-18 23:11:04,444 - tool.dba - INFO - insert data with sql
2022-07-18 23:11:04,461 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  7.71it/s]100%|██████████| 1/1 [00:00<00:00,  7.68it/s]
2022-07-18 23:11:04,592 - tool.dba - INFO - insert finish
2022-07-18 23:11:04,593 - tool.dba - INFO - Delete data with sql
2022-07-18 23:11:04,594 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-18 23:11:04,613 - tool.dba - INFO - Delete data finish
2022-07-18 23:11:04,649 - tool.dba - INFO - insert data with sql
2022-07-18 23:11:04,675 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.01it/s]100%|██████████| 1/1 [00:00<00:00,  5.00it/s]
2022-07-18 23:11:04,876 - tool.dba - INFO - insert finish
2022-07-18 23:11:04,893 - tool.dba - INFO - Read data with sql
2022-07-18 23:11:04,893 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-18 23:11:12,796 - tool.dba - INFO - finish read total 12116 rows
2022-07-18 23:11:12,998 - tool.dba - INFO - Read data with sql
2022-07-18 23:11:12,998 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-18 23:12:19,120 - tool.dba - INFO - finish read total 5938664 rows
2022-07-18 23:12:31,209 - tool.dba - INFO - Read data with sql
2022-07-18 23:12:31,209 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:12:31,463 - tool.dba - INFO - finish read total 8001 rows
2022-07-18 23:12:31,463 - tool.dba - INFO - Read data with sql
2022-07-18 23:12:31,464 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:12:31,480 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:14:29,842 - tool.dba - INFO - Read data with sql
2022-07-18 23:14:29,843 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:14:30,105 - tool.dba - INFO - finish read total 8001 rows
2022-07-18 23:14:30,106 - tool.dba - INFO - Create data with sql
2022-07-18 23:14:30,107 - tool.dba - INFO - 
        create table ZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
LINE_ID		VARCHAR2(999),
POSTING_DATE		DATE,
TRUE		NUMBER(19, 3),
PREDICT		NUMBER(19, 3),
ADVICE		VARCHAR2(999),
            constraint G20220718231430_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-18 23:14:30,134 - tool.dba - INFO - Read data with sql
2022-07-18 23:14:30,134 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:14:30,358 - tool.dba - INFO - finish read total 8002 rows
2022-07-18 23:14:30,360 - tool.dba - INFO - create table finish
2022-07-18 23:14:30,360 - tool.dba - INFO - Delete data with sql
2022-07-18 23:14:30,365 - tool.dba - INFO - Create data with sql
2022-07-18 23:14:30,365 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint G20220718231430_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-18 23:14:30,379 - tool.dba - INFO - Read data with sql
2022-07-18 23:14:30,379 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-18 23:14:31,570 - tool.dba - INFO - finish read total 168995 rows
2022-07-18 23:14:31,570 - tool.dba - INFO - Read data with sql
2022-07-18 23:14:31,570 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-18 23:14:40,923 - tool.dba - INFO - finish read total 101687 rows
2022-07-18 23:14:41,207 - tool.dba - INFO - Read data with sql
2022-07-18 23:14:41,207 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-18 23:14:53,097 - tool.dba - INFO - finish read total 1046017 rows
2022-07-18 23:14:53,097 - tool.dba - INFO - Read data with sql
2022-07-18 23:14:53,097 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-18 23:15:02,161 - tool.dba - INFO - finish read total 1196929 rows
2022-07-18 23:15:02,161 - tool.dba - INFO - Read data with sql
2022-07-18 23:15:02,161 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-18 23:15:14,073 - tool.dba - INFO - finish read total 1268837 rows
2022-07-18 23:15:14,073 - tool.dba - INFO - Read data with sql
2022-07-18 23:15:14,073 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-18 23:15:23,258 - tool.dba - INFO - finish read total 1411272 rows
2022-07-18 23:15:23,258 - tool.dba - INFO - Read data with sql
2022-07-18 23:15:23,258 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-18 23:15:34,166 - tool.dba - INFO - finish read total 1438879 rows
2022-07-18 23:15:34,166 - tool.dba - INFO - Read data with sql
2022-07-18 23:15:34,166 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-18 23:15:45,076 - tool.dba - INFO - finish read total 1578869 rows
2022-07-18 23:16:16,022 - tool.dba - INFO - Read data with sql
2022-07-18 23:16:16,022 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-18 23:16:16,055 - tool.dba - INFO - finish read total 3241 rows
2022-07-18 23:16:19,642 - tool.dba - INFO - Create data with sql
2022-07-18 23:16:19,643 - tool.dba - INFO - 
        create table ZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
SAFETY_STOCK_RATE		NUMBER(19, 3),
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RATE		NUMBER(19, 3),
XSCOUNT_PREDICT		NUMBER(19, 3),
YH_PRODUCT_ID		VARCHAR2(999),
YH_UNIT		NUMBER(19, 3),
YHCOUNT_PREDICT		NUMBER(19, 3),
YH_COUNT		NUMBER(19, 3),
MAX_YH_COUNT		NUMBER(19, 3),
MIN_YH_COUNT		NUMBER(19, 3),
CREATE_TIME		DATE,
EXEDATE		VARCHAR2(999),
TS		VARCHAR2(999),
            constraint G20220718231619_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-18 23:16:19,675 - tool.dba - INFO - Read data with sql
2022-07-18 23:16:19,675 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:16:19,919 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:16:19,921 - tool.dba - INFO - create table finish
2022-07-18 23:16:19,921 - tool.dba - INFO - Delete data with sql
2022-07-18 23:16:20,094 - tool.dba - INFO - Create data with sql
2022-07-18 23:16:20,095 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint G20220718231620_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-18 23:16:20,111 - tool.dba - INFO - Read data with sql
2022-07-18 23:16:20,112 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:16:20,354 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:16:20,356 - tool.dba - INFO - create table finish
2022-07-18 23:16:20,356 - tool.dba - INFO - insert data with sql
2022-07-18 23:16:20,738 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.20it/s]  6%|▋         | 2/31 [00:00<00:04,  6.09it/s] 10%|▉         | 3/31 [00:00<00:04,  6.51it/s] 13%|█▎        | 4/31 [00:00<00:03,  7.02it/s] 16%|█▌        | 5/31 [00:00<00:03,  7.21it/s] 19%|█▉        | 6/31 [00:00<00:03,  7.11it/s] 23%|██▎       | 7/31 [00:01<00:03,  6.26it/s] 26%|██▌       | 8/31 [00:01<00:03,  6.32it/s] 29%|██▉       | 9/31 [00:01<00:03,  5.99it/s] 32%|███▏      | 10/31 [00:01<00:03,  6.15it/s] 35%|███▌      | 11/31 [00:01<00:03,  6.45it/s] 39%|███▊      | 12/31 [00:01<00:02,  6.85it/s] 42%|████▏     | 13/31 [00:01<00:02,  7.11it/s] 45%|████▌     | 14/31 [00:02<00:02,  6.39it/s] 48%|████▊     | 15/31 [00:02<00:02,  6.90it/s] 52%|█████▏    | 16/31 [00:02<00:02,  5.51it/s] 55%|█████▍    | 17/31 [00:02<00:02,  5.82it/s] 58%|█████▊    | 18/31 [00:02<00:02,  5.11it/s] 61%|██████▏   | 19/31 [00:03<00:02,  5.56it/s] 65%|██████▍   | 20/31 [00:03<00:01,  5.93it/s] 68%|██████▊   | 21/31 [00:03<00:01,  5.63it/s] 71%|███████   | 22/31 [00:03<00:01,  6.24it/s] 74%|███████▍  | 23/31 [00:03<00:01,  6.13it/s] 77%|███████▋  | 24/31 [00:03<00:01,  6.58it/s] 81%|████████  | 25/31 [00:03<00:00,  6.43it/s] 84%|████████▍ | 26/31 [00:04<00:00,  6.70it/s] 87%|████████▋ | 27/31 [00:04<00:00,  6.69it/s] 90%|█████████ | 28/31 [00:04<00:00,  5.88it/s] 94%|█████████▎| 29/31 [00:04<00:00,  5.53it/s] 97%|█████████▋| 30/31 [00:04<00:00,  5.84it/s]100%|██████████| 31/31 [00:04<00:00,  6.32it/s]
2022-07-18 23:16:25,647 - tool.dba - INFO - insert finish
2022-07-18 23:16:25,657 - tool.dba - INFO - Delete data with sql
2022-07-18 23:16:25,658 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-18 23:16:25,703 - tool.dba - INFO - Delete data finish
2022-07-18 23:16:26,130 - tool.dba - INFO - insert data with sql
2022-07-18 23:16:26,627 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:08,  3.66it/s]  6%|▋         | 2/31 [00:00<00:09,  2.97it/s] 10%|▉         | 3/31 [00:03<00:42,  1.51s/it] 13%|█▎        | 4/31 [00:03<00:27,  1.02s/it] 16%|█▌        | 5/31 [00:04<00:20,  1.28it/s] 19%|█▉        | 6/31 [00:04<00:15,  1.59it/s] 23%|██▎       | 7/31 [00:04<00:12,  1.90it/s] 26%|██▌       | 8/31 [00:05<00:11,  2.09it/s] 29%|██▉       | 9/31 [00:05<00:09,  2.25it/s] 32%|███▏      | 10/31 [00:05<00:08,  2.51it/s] 35%|███▌      | 11/31 [00:06<00:07,  2.66it/s] 39%|███▊      | 12/31 [00:06<00:06,  2.80it/s] 42%|████▏     | 13/31 [00:06<00:06,  2.93it/s] 45%|████▌     | 14/31 [00:09<00:19,  1.13s/it] 48%|████▊     | 15/31 [00:10<00:14,  1.13it/s] 52%|█████▏    | 16/31 [00:10<00:10,  1.38it/s] 55%|█████▍    | 17/31 [00:10<00:08,  1.66it/s] 58%|█████▊    | 18/31 [00:11<00:06,  1.91it/s] 61%|██████▏   | 19/31 [00:11<00:05,  2.16it/s] 65%|██████▍   | 20/31 [00:11<00:04,  2.32it/s] 68%|██████▊   | 21/31 [00:12<00:04,  2.47it/s] 71%|███████   | 22/31 [00:12<00:03,  2.73it/s] 74%|███████▍  | 23/31 [00:12<00:02,  2.81it/s] 77%|███████▋  | 24/31 [00:13<00:02,  2.72it/s] 81%|████████  | 25/31 [00:15<00:06,  1.08s/it] 84%|████████▍ | 26/31 [00:16<00:04,  1.15it/s] 87%|████████▋ | 27/31 [00:16<00:02,  1.41it/s] 90%|█████████ | 28/31 [00:16<00:01,  1.69it/s] 94%|█████████▎| 29/31 [00:17<00:01,  1.96it/s] 97%|█████████▋| 30/31 [00:17<00:00,  2.13it/s]100%|██████████| 31/31 [00:17<00:00,  2.76it/s]100%|██████████| 31/31 [00:17<00:00,  1.75it/s]
2022-07-18 23:16:44,340 - tool.dba - INFO - insert finish
  Stopping...
2022-07-18 23:18:20.027 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 23:18:20.027 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 23:18:21,177 - tool.dba - INFO - Read data with sql
2022-07-18 23:18:21,177 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 23:18:21,180 - tool.dba - INFO - finish read total 3 rows
2022-07-18 23:18:21,261 - tool.dba - INFO - Read data with sql
2022-07-18 23:18:21,261 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-18 23:18:28,997 - tool.dba - INFO - finish read total 12116 rows
2022-07-18 23:18:29,196 - tool.dba - INFO - Read data with sql
2022-07-18 23:18:29,196 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-18 23:19:33,632 - tool.dba - INFO - finish read total 5938666 rows
2022-07-18 23:19:45,841 - tool.dba - INFO - Read data with sql
2022-07-18 23:19:45,842 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:19:46,103 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:19:46,103 - tool.dba - INFO - Read data with sql
2022-07-18 23:19:46,103 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:19:46,118 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:21:32,805 - tool.dba - INFO - Read data with sql
2022-07-18 23:21:32,805 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:21:33,189 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:21:33,191 - tool.dba - INFO - Delete data with sql
2022-07-18 23:21:33,195 - tool.dba - INFO - Create data with sql
2022-07-18 23:21:33,196 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint A20220718232133_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-18 23:21:33,236 - tool.dba - INFO - Read data with sql
2022-07-18 23:21:33,237 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:21:33,510 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:21:33,511 - tool.dba - INFO - create table finish
2022-07-18 23:21:33,511 - tool.dba - INFO - insert data with sql
2022-07-18 23:21:33,519 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 54.89it/s]
2022-07-18 23:21:33,539 - tool.dba - INFO - insert finish
2022-07-18 23:21:33,539 - tool.dba - INFO - Delete data with sql
2022-07-18 23:21:33,539 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-18 23:21:33,546 - tool.dba - INFO - Delete data finish
2022-07-18 23:21:33,567 - tool.dba - INFO - insert data with sql
2022-07-18 23:21:33,577 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 41.31it/s]
2022-07-18 23:21:33,602 - tool.dba - INFO - insert finish
2022-07-18 23:21:33,882 - tool.dba - INFO - Read data with sql
2022-07-18 23:21:33,882 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:21:34,159 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:21:34,161 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 23:21:34,161 - tool.dba - INFO - Read data with sql
2022-07-18 23:21:34,161 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-18 23:22:20,957 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 23:22:35,551 - tool.dba - INFO - Read data with sql
2022-07-18 23:22:35,551 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:22:35,789 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:22:35,789 - tool.dba - INFO - Read data with sql
2022-07-18 23:22:35,789 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:22:35,806 - tool.dba - INFO - finish read total 2557 rows
  Stopping...
2022-07-18 23:23:10.951 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 23:23:10.951 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 23:23:12,063 - tool.dba - INFO - Read data with sql
2022-07-18 23:23:12,063 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 23:23:12,066 - tool.dba - INFO - finish read total 3 rows
2022-07-18 23:23:12,183 - tool.dba - INFO - Read data with sql
2022-07-18 23:23:12,183 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:23:12,447 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:23:12,448 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 23:23:12,448 - tool.dba - INFO - Read data with sql
2022-07-18 23:23:12,448 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-18 23:23:59,224 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 23:24:13,911 - tool.dba - INFO - Read data with sql
2022-07-18 23:24:13,911 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:24:14,212 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:24:14,212 - tool.dba - INFO - Read data with sql
2022-07-18 23:24:14,212 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:24:14,227 - tool.dba - INFO - finish read total 2557 rows
  Stopping...
2022-07-18 23:25:03.239 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 23:25:03.239 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 23:25:04,369 - tool.dba - INFO - Read data with sql
2022-07-18 23:25:04,369 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 23:25:04,371 - tool.dba - INFO - finish read total 3 rows
2022-07-18 23:25:04,489 - tool.dba - INFO - Read data with sql
2022-07-18 23:25:04,489 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:25:04,753 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:25:04,754 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 23:25:04,754 - tool.dba - INFO - Read data with sql
2022-07-18 23:25:04,754 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-18 23:25:50,785 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 23:26:05,406 - tool.dba - INFO - Read data with sql
2022-07-18 23:26:05,406 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:26:05,677 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:26:05,677 - tool.dba - INFO - Read data with sql
2022-07-18 23:26:05,677 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:26:05,692 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:28:41,049 - tool.dba - INFO - Read data with sql
2022-07-18 23:28:41,049 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:28:41,295 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:28:41,296 - tool.dba - INFO - Delete data with sql
2022-07-18 23:28:41,365 - tool.dba - INFO - Create data with sql
2022-07-18 23:28:41,365 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint Y20220718232841_pk primary key (STORE_ID,DS)
        )
        
2022-07-18 23:28:41,391 - tool.dba - INFO - Read data with sql
2022-07-18 23:28:41,392 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:28:41,675 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:28:41,676 - tool.dba - INFO - create table finish
2022-07-18 23:28:41,676 - tool.dba - INFO - insert data with sql
2022-07-18 23:28:41,810 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:04,  9.40it/s]  4%|▍         | 2/45 [00:00<00:04,  9.54it/s]  9%|▉         | 4/45 [00:00<00:04,  8.37it/s] 11%|█         | 5/45 [00:00<00:05,  7.48it/s] 16%|█▌        | 7/45 [00:00<00:04,  8.59it/s] 18%|█▊        | 8/45 [00:00<00:04,  8.89it/s] 20%|██        | 9/45 [00:01<00:04,  8.26it/s] 22%|██▏       | 10/45 [00:01<00:04,  8.65it/s] 24%|██▍       | 11/45 [00:01<00:04,  7.86it/s] 27%|██▋       | 12/45 [00:01<00:03,  8.28it/s] 29%|██▉       | 13/45 [00:01<00:03,  8.27it/s] 31%|███       | 14/45 [00:01<00:03,  7.84it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.83it/s] 40%|████      | 18/45 [00:02<00:02,  9.46it/s] 42%|████▏     | 19/45 [00:02<00:02,  8.81it/s] 47%|████▋     | 21/45 [00:02<00:02,  9.51it/s] 49%|████▉     | 22/45 [00:02<00:02,  8.83it/s] 51%|█████     | 23/45 [00:02<00:02,  8.22it/s] 56%|█████▌    | 25/45 [00:02<00:02,  9.08it/s] 58%|█████▊    | 26/45 [00:03<00:02,  8.54it/s] 60%|██████    | 27/45 [00:03<00:02,  8.79it/s] 62%|██████▏   | 28/45 [00:03<00:02,  8.20it/s] 67%|██████▋   | 30/45 [00:03<00:01,  8.95it/s] 69%|██████▉   | 31/45 [00:03<00:01,  7.69it/s] 73%|███████▎  | 33/45 [00:03<00:01,  7.91it/s] 76%|███████▌  | 34/45 [00:04<00:01,  8.25it/s] 80%|████████  | 36/45 [00:04<00:01,  8.94it/s] 84%|████████▍ | 38/45 [00:04<00:00,  8.77it/s] 89%|████████▉ | 40/45 [00:04<00:00,  8.54it/s] 93%|█████████▎| 42/45 [00:04<00:00,  8.44it/s] 98%|█████████▊| 44/45 [00:05<00:00,  8.87it/s]100%|██████████| 45/45 [00:05<00:00,  8.68it/s]
2022-07-18 23:28:46,997 - tool.dba - INFO - insert finish
2022-07-18 23:28:47,001 - tool.dba - INFO - Delete data with sql
2022-07-18 23:28:47,001 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-18 23:29:05,323 - tool.dba - INFO - Delete data finish
2022-07-18 23:29:05,378 - tool.dba - INFO - insert data with sql
2022-07-18 23:29:05,517 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:04,  9.95it/s]  4%|▍         | 2/45 [00:00<00:04,  8.62it/s]  7%|▋         | 3/45 [00:00<00:05,  7.40it/s]  9%|▉         | 4/45 [00:00<00:05,  7.40it/s] 11%|█         | 5/45 [00:00<00:05,  6.78it/s] 13%|█▎        | 6/45 [00:00<00:05,  6.89it/s] 16%|█▌        | 7/45 [00:01<00:05,  6.36it/s] 18%|█▊        | 8/45 [00:01<00:05,  6.77it/s] 20%|██        | 9/45 [00:01<00:05,  6.65it/s] 22%|██▏       | 10/45 [00:01<00:05,  6.34it/s] 24%|██▍       | 11/45 [00:01<00:05,  6.64it/s] 27%|██▋       | 12/45 [00:01<00:05,  6.09it/s] 29%|██▉       | 13/45 [00:01<00:04,  6.68it/s] 31%|███       | 14/45 [00:02<00:04,  6.48it/s] 33%|███▎      | 15/45 [00:02<00:06,  4.63it/s] 36%|███▌      | 16/45 [00:02<00:05,  5.22it/s] 38%|███▊      | 17/45 [00:02<00:05,  5.31it/s] 40%|████      | 18/45 [00:02<00:04,  5.78it/s] 42%|████▏     | 19/45 [00:03<00:04,  5.81it/s] 44%|████▍     | 20/45 [00:03<00:04,  6.19it/s] 47%|████▋     | 21/45 [00:03<00:03,  6.42it/s] 49%|████▉     | 22/45 [00:03<00:03,  6.13it/s] 51%|█████     | 23/45 [00:03<00:03,  5.93it/s] 53%|█████▎    | 24/45 [00:03<00:03,  6.33it/s] 56%|█████▌    | 25/45 [00:03<00:02,  6.69it/s] 58%|█████▊    | 26/45 [00:04<00:02,  6.34it/s] 60%|██████    | 27/45 [00:04<00:02,  6.61it/s] 62%|██████▏   | 28/45 [00:04<00:02,  6.43it/s] 64%|██████▍   | 29/45 [00:04<00:02,  6.84it/s] 67%|██████▋   | 30/45 [00:04<00:02,  7.06it/s] 69%|██████▉   | 31/45 [00:04<00:02,  6.52it/s] 71%|███████   | 32/45 [00:05<00:04,  3.08it/s] 73%|███████▎  | 33/45 [00:05<00:03,  3.58it/s] 76%|███████▌  | 34/45 [00:05<00:02,  4.05it/s] 78%|███████▊  | 35/45 [00:06<00:02,  4.69it/s] 80%|████████  | 36/45 [00:06<00:01,  4.81it/s] 82%|████████▏ | 37/45 [00:06<00:01,  5.36it/s] 84%|████████▍ | 38/45 [00:06<00:01,  5.51it/s] 87%|████████▋ | 39/45 [00:06<00:01,  6.00it/s] 89%|████████▉ | 40/45 [00:06<00:00,  6.46it/s] 91%|█████████ | 41/45 [00:07<00:00,  6.35it/s] 93%|█████████▎| 42/45 [00:07<00:00,  6.78it/s] 96%|█████████▌| 43/45 [00:07<00:00,  6.94it/s] 98%|█████████▊| 44/45 [00:07<00:00,  7.18it/s]100%|██████████| 45/45 [00:07<00:00,  6.02it/s]
2022-07-18 23:29:12,995 - tool.dba - INFO - insert finish
2022-07-18 23:29:13,055 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-18 23:29:13,056 - tool.dba - INFO - Read data with sql
2022-07-18 23:29:13,056 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 23:29:47,261 - tool.dba - INFO - finish read total 4776447 rows
2022-07-18 23:29:48,155 - tool.dba - INFO - Read data with sql
2022-07-18 23:29:48,155 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-18 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 23:30:06,488 - tool.dba - INFO - finish read total 2911245 rows
2022-07-18 23:30:07,298 - tool.dba - INFO - Read data with sql
2022-07-18 23:30:07,298 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-18 23:30:07,307 - tool.dba - INFO - finish read total 821 rows
2022-07-18 23:30:07,307 - tool.dba - INFO - Read data with sql
2022-07-18 23:30:07,307 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-18 23:30:07,331 - tool.dba - INFO - finish read total 5316 rows
2022-07-18 23:31:22,908 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:22,909 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:31:23,167 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:31:23,167 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:23,167 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:31:23,182 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:31:34,752 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:34,752 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-18 23:31:34,800 - tool.dba - INFO - finish read total 5395 rows
2022-07-18 23:31:35,121 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:35,121 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:31:35,400 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:31:35,401 - tool.dba - INFO - Delete data with sql
2022-07-18 23:31:35,408 - tool.dba - INFO - Create data with sql
2022-07-18 23:31:35,409 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint T20220718233135_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-18 23:31:35,439 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:35,439 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:31:35,691 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:31:35,692 - tool.dba - INFO - create table finish
2022-07-18 23:31:35,692 - tool.dba - INFO - insert data with sql
2022-07-18 23:31:35,707 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 10.19it/s]
2022-07-18 23:31:35,806 - tool.dba - INFO - insert finish
2022-07-18 23:31:35,808 - tool.dba - INFO - Delete data with sql
2022-07-18 23:31:35,808 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-18 23:31:36,082 - tool.dba - INFO - Delete data finish
2022-07-18 23:31:36,182 - tool.dba - INFO - insert data with sql
2022-07-18 23:31:36,204 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.13it/s]100%|██████████| 1/1 [00:00<00:00,  4.12it/s]
2022-07-18 23:31:36,447 - tool.dba - INFO - insert finish
2022-07-18 23:31:36,463 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:36,463 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-18 23:31:44,327 - tool.dba - INFO - finish read total 12116 rows
2022-07-18 23:31:44,538 - tool.dba - INFO - Read data with sql
2022-07-18 23:31:44,538 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-18 23:32:46,929 - tool.dba - INFO - finish read total 5938666 rows
2022-07-18 23:32:59,187 - tool.dba - INFO - Read data with sql
2022-07-18 23:32:59,187 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:32:59,436 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:32:59,436 - tool.dba - INFO - Read data with sql
2022-07-18 23:32:59,437 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:32:59,452 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:34:58,930 - tool.dba - INFO - Read data with sql
2022-07-18 23:34:58,931 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:34:59,178 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:34:59,179 - tool.dba - INFO - Delete data with sql
2022-07-18 23:34:59,183 - tool.dba - INFO - Create data with sql
2022-07-18 23:34:59,184 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint K20220718233459_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-18 23:34:59,210 - tool.dba - INFO - Read data with sql
2022-07-18 23:34:59,210 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:34:59,442 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:34:59,443 - tool.dba - INFO - create table finish
2022-07-18 23:34:59,444 - tool.dba - INFO - insert data with sql
2022-07-18 23:34:59,452 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 45.02it/s]
2022-07-18 23:34:59,476 - tool.dba - INFO - insert finish
2022-07-18 23:34:59,476 - tool.dba - INFO - Delete data with sql
2022-07-18 23:34:59,476 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-18 23:34:59,506 - tool.dba - INFO - Delete data finish
2022-07-18 23:34:59,534 - tool.dba - INFO - insert data with sql
2022-07-18 23:34:59,545 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 57.83it/s]
2022-07-18 23:34:59,563 - tool.dba - INFO - insert finish
2022-07-18 23:34:59,568 - tool.dba - INFO - Read data with sql
2022-07-18 23:34:59,568 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-18 23:35:00,745 - tool.dba - INFO - finish read total 168995 rows
2022-07-18 23:35:00,745 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:00,745 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-18 23:35:08,374 - tool.dba - INFO - finish read total 101687 rows
2022-07-18 23:35:08,650 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:08,650 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-18 23:35:15,869 - tool.dba - INFO - finish read total 1046017 rows
2022-07-18 23:35:15,870 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:15,870 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-18 23:35:25,593 - tool.dba - INFO - finish read total 1196929 rows
2022-07-18 23:35:25,593 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:25,593 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-18 23:35:35,393 - tool.dba - INFO - finish read total 1268837 rows
2022-07-18 23:35:35,394 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:35,394 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-18 23:35:44,727 - tool.dba - INFO - finish read total 1412865 rows
2022-07-18 23:35:44,728 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:44,728 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-18 23:35:55,625 - tool.dba - INFO - finish read total 1438879 rows
2022-07-18 23:35:55,625 - tool.dba - INFO - Read data with sql
2022-07-18 23:35:55,625 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-18 23:36:06,346 - tool.dba - INFO - finish read total 1580462 rows
2022-07-18 23:36:37,601 - tool.dba - INFO - Read data with sql
2022-07-18 23:36:37,601 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-18 23:36:37,626 - tool.dba - INFO - finish read total 3241 rows
2022-07-18 23:36:41,100 - tool.dba - INFO - Delete data with sql
2022-07-18 23:36:41,258 - tool.dba - INFO - Create data with sql
2022-07-18 23:36:41,258 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint Y20220718233641_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-18 23:36:41,291 - tool.dba - INFO - Read data with sql
2022-07-18 23:36:41,291 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:36:41,547 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:36:41,549 - tool.dba - INFO - create table finish
2022-07-18 23:36:41,549 - tool.dba - INFO - insert data with sql
2022-07-18 23:36:41,926 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:04,  6.38it/s]  6%|▋         | 2/31 [00:00<00:04,  6.88it/s] 10%|▉         | 3/31 [00:00<00:04,  6.23it/s] 13%|█▎        | 4/31 [00:00<00:04,  5.92it/s] 16%|█▌        | 5/31 [00:00<00:04,  6.40it/s] 19%|█▉        | 6/31 [00:00<00:03,  6.42it/s] 23%|██▎       | 7/31 [00:01<00:04,  5.92it/s] 26%|██▌       | 8/31 [00:01<00:03,  6.14it/s] 29%|██▉       | 9/31 [00:01<00:03,  6.12it/s] 32%|███▏      | 10/31 [00:01<00:03,  6.26it/s] 35%|███▌      | 11/31 [00:01<00:03,  6.52it/s] 39%|███▊      | 12/31 [00:01<00:03,  6.23it/s] 42%|████▏     | 13/31 [00:02<00:02,  6.71it/s] 45%|████▌     | 14/31 [00:02<00:02,  7.12it/s] 48%|████▊     | 15/31 [00:02<00:02,  7.38it/s] 52%|█████▏    | 16/31 [00:02<00:02,  7.24it/s] 55%|█████▍    | 17/31 [00:02<00:02,  6.48it/s] 58%|█████▊    | 18/31 [00:02<00:01,  6.79it/s] 61%|██████▏   | 19/31 [00:02<00:01,  6.86it/s] 65%|██████▍   | 20/31 [00:03<00:01,  7.25it/s] 68%|██████▊   | 21/31 [00:03<00:01,  7.46it/s] 71%|███████   | 22/31 [00:03<00:01,  7.01it/s] 74%|███████▍  | 23/31 [00:03<00:01,  7.18it/s] 77%|███████▋  | 24/31 [00:03<00:00,  7.04it/s] 81%|████████  | 25/31 [00:03<00:00,  7.28it/s] 84%|████████▍ | 26/31 [00:03<00:00,  6.46it/s] 87%|████████▋ | 27/31 [00:04<00:00,  6.51it/s] 90%|█████████ | 28/31 [00:04<00:00,  6.59it/s] 94%|█████████▎| 29/31 [00:04<00:00,  6.70it/s] 97%|█████████▋| 30/31 [00:04<00:00,  6.54it/s]100%|██████████| 31/31 [00:04<00:00,  6.77it/s]
2022-07-18 23:36:46,505 - tool.dba - INFO - insert finish
2022-07-18 23:36:46,516 - tool.dba - INFO - Delete data with sql
2022-07-18 23:36:46,516 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-18 23:37:01,851 - tool.dba - INFO - Delete data finish
2022-07-18 23:37:01,965 - tool.dba - INFO - insert data with sql
2022-07-18 23:37:02,452 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:08,  3.42it/s]  6%|▋         | 2/31 [00:00<00:08,  3.53it/s] 10%|▉         | 3/31 [00:00<00:07,  3.66it/s] 13%|█▎        | 4/31 [00:01<00:07,  3.42it/s] 16%|█▌        | 5/31 [00:01<00:07,  3.48it/s] 19%|█▉        | 6/31 [00:01<00:07,  3.53it/s] 23%|██▎       | 7/31 [00:02<00:07,  3.36it/s] 26%|██▌       | 8/31 [00:02<00:06,  3.44it/s] 29%|██▉       | 9/31 [00:02<00:06,  3.63it/s] 32%|███▏      | 10/31 [00:04<00:18,  1.16it/s] 35%|███▌      | 11/31 [00:04<00:13,  1.48it/s] 39%|███▊      | 12/31 [00:05<00:10,  1.85it/s] 42%|████▏     | 13/31 [00:05<00:08,  2.11it/s] 45%|████▌     | 14/31 [00:05<00:06,  2.43it/s] 48%|████▊     | 15/31 [00:06<00:05,  2.73it/s] 52%|█████▏    | 16/31 [00:06<00:05,  2.81it/s] 55%|█████▍    | 17/31 [00:06<00:04,  3.04it/s] 58%|█████▊    | 18/31 [00:06<00:04,  3.23it/s] 61%|██████▏   | 19/31 [00:07<00:03,  3.34it/s] 65%|██████▍   | 20/31 [00:07<00:03,  3.21it/s] 68%|██████▊   | 21/31 [00:07<00:02,  3.34it/s] 71%|███████   | 22/31 [00:08<00:02,  3.41it/s] 74%|███████▍  | 23/31 [00:08<00:02,  3.35it/s] 77%|███████▋  | 24/31 [00:08<00:02,  3.47it/s] 81%|████████  | 25/31 [00:10<00:04,  1.22it/s] 84%|████████▍ | 26/31 [00:11<00:03,  1.47it/s] 87%|████████▋ | 27/31 [00:11<00:02,  1.79it/s] 90%|█████████ | 28/31 [00:11<00:01,  2.13it/s] 94%|█████████▎| 29/31 [00:11<00:00,  2.33it/s] 97%|█████████▋| 30/31 [00:12<00:00,  2.57it/s]100%|██████████| 31/31 [00:12<00:00,  3.27it/s]100%|██████████| 31/31 [00:12<00:00,  2.51it/s]
2022-07-18 23:37:14,807 - tool.dba - INFO - insert finish
  Stopping...
2022-07-18 23:38:26.352 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-18 23:38:26.352 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-18 23:38:27,481 - tool.dba - INFO - Read data with sql
2022-07-18 23:38:27,481 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-18 23:38:27,483 - tool.dba - INFO - finish read total 3 rows
2022-07-18 23:38:27,598 - tool.dba - INFO - Read data with sql
2022-07-18 23:38:27,598 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:38:27,844 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:38:27,844 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-18 23:38:27,845 - tool.dba - INFO - Read data with sql
2022-07-18 23:38:27,845 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-18 23:39:14,283 - tool.dba - INFO - finish read total 6455117 rows
2022-07-18 23:39:28,874 - tool.dba - INFO - Read data with sql
2022-07-18 23:39:28,875 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:39:29,127 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:39:29,127 - tool.dba - INFO - Read data with sql
2022-07-18 23:39:29,127 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:39:29,142 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:42:04,562 - tool.dba - INFO - Read data with sql
2022-07-18 23:42:04,563 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:42:04,837 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:42:04,838 - tool.dba - INFO - Delete data with sql
2022-07-18 23:42:04,904 - tool.dba - INFO - Create data with sql
2022-07-18 23:42:04,905 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint A20220718234204_pk primary key (STORE_ID,DS)
        )
        
2022-07-18 23:42:04,959 - tool.dba - INFO - Read data with sql
2022-07-18 23:42:04,959 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:42:05,227 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:42:05,228 - tool.dba - INFO - create table finish
2022-07-18 23:42:05,228 - tool.dba - INFO - insert data with sql
2022-07-18 23:42:05,365 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:03, 10.97it/s]  9%|▉         | 4/45 [00:00<00:04,  9.40it/s] 13%|█▎        | 6/45 [00:00<00:03,  9.96it/s] 18%|█▊        | 8/45 [00:00<00:03,  9.90it/s] 20%|██        | 9/45 [00:00<00:04,  8.96it/s] 22%|██▏       | 10/45 [00:01<00:03,  8.85it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.44it/s] 31%|███       | 14/45 [00:01<00:03,  9.03it/s] 36%|███▌      | 16/45 [00:01<00:03,  9.41it/s] 38%|███▊      | 17/45 [00:02<00:04,  6.40it/s] 42%|████▏     | 19/45 [00:02<00:03,  7.07it/s] 47%|████▋     | 21/45 [00:02<00:03,  7.91it/s] 51%|█████     | 23/45 [00:02<00:02,  7.97it/s] 56%|█████▌    | 25/45 [00:02<00:02,  8.63it/s] 60%|██████    | 27/45 [00:03<00:01,  9.25it/s] 62%|██████▏   | 28/45 [00:03<00:01,  8.80it/s] 67%|██████▋   | 30/45 [00:03<00:01,  9.35it/s] 69%|██████▉   | 31/45 [00:03<00:01,  9.37it/s] 73%|███████▎  | 33/45 [00:03<00:01,  9.14it/s] 78%|███████▊  | 35/45 [00:03<00:01,  9.54it/s] 82%|████████▏ | 37/45 [00:04<00:00,  9.83it/s] 84%|████████▍ | 38/45 [00:04<00:00,  9.28it/s] 89%|████████▉ | 40/45 [00:04<00:00,  9.87it/s] 93%|█████████▎| 42/45 [00:04<00:00,  9.43it/s] 96%|█████████▌| 43/45 [00:04<00:00,  9.51it/s] 98%|█████████▊| 44/45 [00:05<00:00,  4.17it/s]100%|██████████| 45/45 [00:05<00:00,  8.07it/s]
2022-07-18 23:42:10,944 - tool.dba - INFO - insert finish
2022-07-18 23:42:10,948 - tool.dba - INFO - Delete data with sql
2022-07-18 23:42:10,948 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-18 23:42:30,292 - tool.dba - INFO - Delete data finish
2022-07-18 23:42:30,330 - tool.dba - INFO - insert data with sql
2022-07-18 23:42:30,471 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:04,  9.56it/s]  4%|▍         | 2/45 [00:00<00:04,  9.06it/s]  7%|▋         | 3/45 [00:00<00:05,  8.11it/s]  9%|▉         | 4/45 [00:00<00:04,  8.49it/s] 11%|█         | 5/45 [00:00<00:04,  8.67it/s] 13%|█▎        | 6/45 [00:00<00:04,  9.02it/s] 16%|█▌        | 7/45 [00:00<00:04,  7.91it/s] 18%|█▊        | 8/45 [00:00<00:04,  8.19it/s] 20%|██        | 9/45 [00:01<00:04,  8.35it/s] 22%|██▏       | 10/45 [00:01<00:04,  8.56it/s] 24%|██▍       | 11/45 [00:01<00:03,  8.65it/s] 27%|██▋       | 12/45 [00:01<00:04,  7.72it/s] 29%|██▉       | 13/45 [00:01<00:04,  7.96it/s] 31%|███       | 14/45 [00:01<00:03,  8.21it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.41it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.55it/s] 38%|███▊      | 17/45 [00:02<00:03,  7.66it/s] 40%|████      | 18/45 [00:02<00:03,  8.01it/s] 42%|████▏     | 19/45 [00:02<00:03,  8.22it/s] 44%|████▍     | 20/45 [00:02<00:02,  8.34it/s] 47%|████▋     | 21/45 [00:02<00:02,  8.48it/s] 49%|████▉     | 22/45 [00:02<00:03,  7.48it/s] 51%|█████     | 23/45 [00:02<00:02,  7.89it/s] 53%|█████▎    | 24/45 [00:02<00:02,  8.11it/s] 56%|█████▌    | 25/45 [00:03<00:02,  8.34it/s] 58%|█████▊    | 26/45 [00:03<00:02,  7.47it/s] 60%|██████    | 27/45 [00:03<00:02,  7.81it/s] 62%|██████▏   | 28/45 [00:03<00:02,  7.08it/s] 64%|██████▍   | 29/45 [00:03<00:02,  7.71it/s] 67%|██████▋   | 30/45 [00:03<00:01,  8.24it/s] 69%|██████▉   | 31/45 [00:03<00:01,  7.54it/s] 71%|███████   | 32/45 [00:03<00:01,  7.94it/s] 73%|███████▎  | 33/45 [00:04<00:01,  8.41it/s] 76%|███████▌  | 34/45 [00:04<00:01,  8.70it/s] 78%|███████▊  | 35/45 [00:04<00:01,  8.49it/s] 80%|████████  | 36/45 [00:05<00:04,  2.01it/s] 82%|████████▏ | 37/45 [00:05<00:03,  2.61it/s] 84%|████████▍ | 38/45 [00:05<00:02,  3.31it/s] 87%|████████▋ | 39/45 [00:06<00:01,  4.06it/s] 89%|████████▉ | 40/45 [00:06<00:01,  4.85it/s] 91%|█████████ | 41/45 [00:06<00:00,  5.23it/s] 93%|█████████▎| 42/45 [00:06<00:00,  5.95it/s] 98%|█████████▊| 44/45 [00:06<00:00,  7.18it/s]100%|██████████| 45/45 [00:06<00:00,  6.73it/s]
2022-07-18 23:42:37,153 - tool.dba - INFO - insert finish
2022-07-18 23:42:37,212 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-18 23:42:37,213 - tool.dba - INFO - Read data with sql
2022-07-18 23:42:37,214 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 23:43:08,903 - tool.dba - INFO - finish read total 4776447 rows
2022-07-18 23:43:09,792 - tool.dba - INFO - Read data with sql
2022-07-18 23:43:09,792 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-18 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-18 23:43:28,541 - tool.dba - INFO - finish read total 2911245 rows
2022-07-18 23:43:29,362 - tool.dba - INFO - Read data with sql
2022-07-18 23:43:29,362 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-18 23:43:29,372 - tool.dba - INFO - finish read total 821 rows
2022-07-18 23:43:29,373 - tool.dba - INFO - Read data with sql
2022-07-18 23:43:29,373 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-18 23:43:29,395 - tool.dba - INFO - finish read total 5316 rows
2022-07-18 23:44:45,234 - tool.dba - INFO - Read data with sql
2022-07-18 23:44:45,235 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:44:45,488 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:44:45,489 - tool.dba - INFO - Read data with sql
2022-07-18 23:44:45,489 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:44:45,504 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:44:56,672 - tool.dba - INFO - Read data with sql
2022-07-18 23:44:56,672 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-18 23:44:56,694 - tool.dba - INFO - finish read total 5395 rows
2022-07-18 23:44:56,997 - tool.dba - INFO - Read data with sql
2022-07-18 23:44:56,997 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:44:57,244 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:44:57,246 - tool.dba - INFO - Delete data with sql
2022-07-18 23:44:57,253 - tool.dba - INFO - Create data with sql
2022-07-18 23:44:57,254 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint M20220718234457_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-18 23:44:57,281 - tool.dba - INFO - Read data with sql
2022-07-18 23:44:57,281 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:44:57,513 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:44:57,514 - tool.dba - INFO - create table finish
2022-07-18 23:44:57,514 - tool.dba - INFO - insert data with sql
2022-07-18 23:44:57,531 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 10.88it/s]
2022-07-18 23:44:57,624 - tool.dba - INFO - insert finish
2022-07-18 23:44:57,625 - tool.dba - INFO - Delete data with sql
2022-07-18 23:44:57,625 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-18 23:44:57,863 - tool.dba - INFO - Delete data finish
2022-07-18 23:44:57,935 - tool.dba - INFO - insert data with sql
2022-07-18 23:44:57,959 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.78it/s]100%|██████████| 1/1 [00:00<00:00,  4.77it/s]
2022-07-18 23:44:58,169 - tool.dba - INFO - insert finish
2022-07-18 23:44:58,183 - tool.dba - INFO - Read data with sql
2022-07-18 23:44:58,184 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-18 23:45:05,867 - tool.dba - INFO - finish read total 12116 rows
2022-07-18 23:45:06,072 - tool.dba - INFO - Read data with sql
2022-07-18 23:45:06,072 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-18 23:46:08,462 - tool.dba - INFO - finish read total 5938666 rows
2022-07-18 23:46:20,573 - tool.dba - INFO - Read data with sql
2022-07-18 23:46:20,573 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:46:20,836 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:46:20,836 - tool.dba - INFO - Read data with sql
2022-07-18 23:46:20,836 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-18 23:46:20,851 - tool.dba - INFO - finish read total 2557 rows
2022-07-18 23:48:19,947 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:19,948 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:48:20,200 - tool.dba - INFO - finish read total 8003 rows
2022-07-18 23:48:20,201 - tool.dba - INFO - Delete data with sql
2022-07-18 23:48:20,206 - tool.dba - INFO - Create data with sql
2022-07-18 23:48:20,207 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint T20220718234820_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-18 23:48:20,233 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:20,233 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:48:20,409 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:48:20,410 - tool.dba - INFO - create table finish
2022-07-18 23:48:20,411 - tool.dba - INFO - insert data with sql
2022-07-18 23:48:20,419 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 52.72it/s]
2022-07-18 23:48:20,439 - tool.dba - INFO - insert finish
2022-07-18 23:48:20,439 - tool.dba - INFO - Delete data with sql
2022-07-18 23:48:20,439 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-18 23:48:20,510 - tool.dba - INFO - Delete data finish
2022-07-18 23:48:20,543 - tool.dba - INFO - insert data with sql
2022-07-18 23:48:20,554 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 62.01it/s]
2022-07-18 23:48:20,571 - tool.dba - INFO - insert finish
2022-07-18 23:48:20,576 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:20,576 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-18 23:48:21,782 - tool.dba - INFO - finish read total 168995 rows
2022-07-18 23:48:21,782 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:21,782 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-18 23:48:27,428 - tool.dba - INFO - finish read total 101687 rows
2022-07-18 23:48:27,704 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:27,705 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-18 23:48:35,161 - tool.dba - INFO - finish read total 1065561 rows
2022-07-18 23:48:35,161 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:35,161 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-18 23:48:44,050 - tool.dba - INFO - finish read total 1216473 rows
2022-07-18 23:48:44,050 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:44,050 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-18 23:48:53,461 - tool.dba - INFO - finish read total 1268837 rows
2022-07-18 23:48:53,461 - tool.dba - INFO - Read data with sql
2022-07-18 23:48:53,461 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-18 23:49:02,783 - tool.dba - INFO - finish read total 1412881 rows
2022-07-18 23:49:02,783 - tool.dba - INFO - Read data with sql
2022-07-18 23:49:02,783 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-18 23:49:12,772 - tool.dba - INFO - finish read total 1438879 rows
2022-07-18 23:49:12,772 - tool.dba - INFO - Read data with sql
2022-07-18 23:49:12,772 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-18 23:49:23,728 - tool.dba - INFO - finish read total 1580478 rows
2022-07-18 23:49:54,798 - tool.dba - INFO - Read data with sql
2022-07-18 23:49:54,798 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-18 23:49:54,820 - tool.dba - INFO - finish read total 3241 rows
2022-07-18 23:49:58,449 - tool.dba - INFO - Delete data with sql
2022-07-18 23:49:58,607 - tool.dba - INFO - Create data with sql
2022-07-18 23:49:58,608 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint K20220718234958_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-18 23:49:58,690 - tool.dba - INFO - Read data with sql
2022-07-18 23:49:58,691 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-18 23:49:58,932 - tool.dba - INFO - finish read total 8004 rows
2022-07-18 23:49:58,933 - tool.dba - INFO - create table finish
2022-07-18 23:49:58,933 - tool.dba - INFO - insert data with sql
2022-07-18 23:49:59,321 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.42it/s]  6%|▋         | 2/31 [00:00<00:03,  7.70it/s] 10%|▉         | 3/31 [00:00<00:04,  6.19it/s] 13%|█▎        | 4/31 [00:00<00:03,  6.75it/s] 16%|█▌        | 5/31 [00:00<00:04,  6.14it/s] 19%|█▉        | 6/31 [00:00<00:03,  6.31it/s] 23%|██▎       | 7/31 [00:01<00:04,  4.84it/s] 26%|██▌       | 8/31 [00:01<00:04,  5.21it/s] 29%|██▉       | 9/31 [00:01<00:03,  5.53it/s] 32%|███▏      | 10/31 [00:01<00:03,  5.41it/s] 35%|███▌      | 11/31 [00:01<00:03,  5.79it/s] 39%|███▊      | 12/31 [00:02<00:03,  5.78it/s] 42%|████▏     | 13/31 [00:02<00:03,  5.84it/s] 45%|████▌     | 14/31 [00:02<00:02,  6.64it/s] 48%|████▊     | 15/31 [00:02<00:02,  6.27it/s] 52%|█████▏    | 16/31 [00:02<00:02,  6.31it/s] 55%|█████▍    | 17/31 [00:02<00:02,  5.78it/s] 58%|█████▊    | 18/31 [00:03<00:02,  6.21it/s] 61%|██████▏   | 19/31 [00:03<00:01,  6.36it/s] 65%|██████▍   | 20/31 [00:03<00:01,  6.44it/s] 68%|██████▊   | 21/31 [00:03<00:01,  6.01it/s] 71%|███████   | 22/31 [00:03<00:01,  5.74it/s] 74%|███████▍  | 23/31 [00:03<00:01,  5.78it/s] 77%|███████▋  | 24/31 [00:03<00:01,  6.48it/s] 81%|████████  | 25/31 [00:04<00:00,  6.41it/s] 84%|████████▍ | 26/31 [00:04<00:00,  6.03it/s] 87%|████████▋ | 27/31 [00:04<00:00,  6.24it/s] 90%|█████████ | 28/31 [00:04<00:00,  6.34it/s] 94%|█████████▎| 29/31 [00:04<00:00,  6.35it/s] 97%|█████████▋| 30/31 [00:04<00:00,  6.32it/s]100%|██████████| 31/31 [00:05<00:00,  6.53it/s]100%|██████████| 31/31 [00:05<00:00,  6.11it/s]
2022-07-18 23:50:04,397 - tool.dba - INFO - insert finish
2022-07-18 23:50:04,408 - tool.dba - INFO - Delete data with sql
2022-07-18 23:50:04,409 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-18 23:50:21,049 - tool.dba - INFO - Delete data finish
2022-07-18 23:50:21,171 - tool.dba - INFO - insert data with sql
2022-07-18 23:50:21,664 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:09,  3.33it/s]  6%|▋         | 2/31 [00:00<00:08,  3.61it/s] 10%|▉         | 3/31 [00:00<00:07,  3.60it/s] 13%|█▎        | 4/31 [00:01<00:07,  3.42it/s] 16%|█▌        | 5/31 [00:04<00:31,  1.22s/it] 19%|█▉        | 6/31 [00:04<00:22,  1.10it/s] 23%|██▎       | 7/31 [00:04<00:16,  1.43it/s] 26%|██▌       | 8/31 [00:04<00:12,  1.78it/s] 29%|██▉       | 9/31 [00:05<00:10,  2.11it/s] 32%|███▏      | 10/31 [00:05<00:09,  2.32it/s] 35%|███▌      | 11/31 [00:05<00:07,  2.61it/s] 39%|███▊      | 12/31 [00:06<00:06,  2.79it/s] 42%|████▏     | 13/31 [00:06<00:06,  2.86it/s] 45%|████▌     | 14/31 [00:06<00:05,  3.08it/s] 48%|████▊     | 15/31 [00:06<00:04,  3.27it/s] 52%|█████▏    | 16/31 [00:07<00:04,  3.36it/s] 55%|█████▍    | 17/31 [00:07<00:04,  3.27it/s] 58%|█████▊    | 18/31 [00:07<00:03,  3.39it/s] 61%|██████▏   | 19/31 [00:08<00:03,  3.45it/s] 65%|██████▍   | 20/31 [00:08<00:03,  3.11it/s] 68%|██████▊   | 21/31 [00:08<00:03,  3.20it/s] 71%|███████   | 22/31 [00:09<00:02,  3.30it/s] 74%|███████▍  | 23/31 [00:09<00:02,  3.19it/s] 77%|███████▋  | 24/31 [00:09<00:02,  3.22it/s] 81%|████████  | 25/31 [00:09<00:01,  3.38it/s] 84%|████████▍ | 26/31 [00:10<00:01,  3.25it/s] 87%|████████▋ | 27/31 [00:10<00:01,  3.33it/s] 90%|█████████ | 28/31 [00:10<00:00,  3.42it/s] 94%|█████████▎| 29/31 [00:11<00:00,  3.41it/s] 97%|█████████▋| 30/31 [00:11<00:00,  3.58it/s]100%|██████████| 31/31 [00:11<00:00,  4.40it/s]100%|██████████| 31/31 [00:11<00:00,  2.70it/s]
2022-07-18 23:50:33,138 - tool.dba - INFO - insert finish
2022-07-19 05:00:00,862 - tool.dba - INFO - Read data with sql
2022-07-19 05:00:00,862 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:00:01,162 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:00:01,163 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-19 05:00:01,163 - tool.dba - INFO - Read data with sql
2022-07-19 05:00:01,163 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-19 05:00:48,239 - tool.dba - INFO - finish read total 6460143 rows
2022-07-19 05:01:03,274 - tool.dba - INFO - Read data with sql
2022-07-19 05:01:03,274 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:01:03,524 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:01:03,524 - tool.dba - INFO - Read data with sql
2022-07-19 05:01:03,524 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-19 05:01:03,540 - tool.dba - INFO - finish read total 2557 rows
2022-07-19 05:03:39,045 - tool.dba - INFO - Read data with sql
2022-07-19 05:03:39,045 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:03:39,292 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:03:39,293 - tool.dba - INFO - Delete data with sql
2022-07-19 05:03:39,352 - tool.dba - INFO - Create data with sql
2022-07-19 05:03:39,353 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint A20220719050339_pk primary key (STORE_ID,DS)
        )
        
2022-07-19 05:03:39,379 - tool.dba - INFO - Read data with sql
2022-07-19 05:03:39,379 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:03:39,603 - tool.dba - INFO - finish read total 8004 rows
2022-07-19 05:03:39,604 - tool.dba - INFO - create table finish
2022-07-19 05:03:39,605 - tool.dba - INFO - insert data with sql
2022-07-19 05:03:39,738 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:05,  8.58it/s]  9%|▉         | 4/45 [00:00<00:04,  8.95it/s] 13%|█▎        | 6/45 [00:00<00:04,  9.65it/s] 16%|█▌        | 7/45 [00:00<00:04,  8.77it/s] 18%|█▊        | 8/45 [00:00<00:04,  8.98it/s] 22%|██▏       | 10/45 [00:01<00:03,  9.75it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.50it/s] 31%|███       | 14/45 [00:01<00:03,  9.94it/s] 36%|███▌      | 16/45 [00:01<00:02, 10.17it/s] 40%|████      | 18/45 [00:01<00:02,  9.51it/s] 44%|████▍     | 20/45 [00:02<00:02,  9.84it/s] 47%|████▋     | 21/45 [00:02<00:02,  8.09it/s] 49%|████▉     | 22/45 [00:02<00:02,  8.35it/s] 53%|█████▎    | 24/45 [00:02<00:02,  8.93it/s] 56%|█████▌    | 25/45 [00:02<00:02,  9.09it/s] 58%|█████▊    | 26/45 [00:02<00:02,  8.51it/s] 62%|██████▏   | 28/45 [00:03<00:01,  9.26it/s] 67%|██████▋   | 30/45 [00:03<00:01,  9.48it/s] 69%|██████▉   | 31/45 [00:03<00:01,  8.81it/s] 73%|███████▎  | 33/45 [00:03<00:01,  9.43it/s] 76%|███████▌  | 34/45 [00:03<00:01,  8.88it/s] 80%|████████  | 36/45 [00:03<00:01,  8.78it/s] 84%|████████▍ | 38/45 [00:04<00:00,  9.33it/s] 89%|████████▉ | 40/45 [00:04<00:00,  8.95it/s] 93%|█████████▎| 42/45 [00:04<00:00,  9.12it/s] 98%|█████████▊| 44/45 [00:04<00:00,  9.58it/s]100%|██████████| 45/45 [00:04<00:00,  9.29it/s]
2022-07-19 05:03:44,584 - tool.dba - INFO - insert finish
2022-07-19 05:03:44,588 - tool.dba - INFO - Delete data with sql
2022-07-19 05:03:44,588 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-19 05:04:02,591 - tool.dba - INFO - Delete data finish
2022-07-19 05:04:02,735 - tool.dba - INFO - insert data with sql
2022-07-19 05:04:02,880 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:07,  6.18it/s]  4%|▍         | 2/45 [00:00<00:06,  7.16it/s]  7%|▋         | 3/45 [00:00<00:05,  7.41it/s]  9%|▉         | 4/45 [00:00<00:05,  7.77it/s] 11%|█         | 5/45 [00:00<00:05,  7.02it/s] 13%|█▎        | 6/45 [00:00<00:05,  7.50it/s] 16%|█▌        | 7/45 [00:00<00:04,  7.69it/s] 18%|█▊        | 8/45 [00:01<00:04,  7.92it/s] 20%|██        | 9/45 [00:01<00:04,  8.16it/s] 22%|██▏       | 10/45 [00:01<00:04,  7.42it/s] 24%|██▍       | 11/45 [00:01<00:04,  7.82it/s] 27%|██▋       | 12/45 [00:01<00:07,  4.35it/s] 29%|██▉       | 13/45 [00:02<00:06,  5.14it/s] 31%|███       | 14/45 [00:02<00:05,  5.88it/s] 33%|███▎      | 15/45 [00:02<00:05,  5.84it/s] 36%|███▌      | 16/45 [00:02<00:04,  6.48it/s] 38%|███▊      | 17/45 [00:02<00:04,  6.89it/s] 40%|████      | 18/45 [00:02<00:04,  6.63it/s] 42%|████▏     | 19/45 [00:02<00:03,  7.18it/s] 44%|████▍     | 20/45 [00:02<00:03,  6.95it/s] 47%|████▋     | 21/45 [00:03<00:03,  7.34it/s] 49%|████▉     | 22/45 [00:03<00:02,  7.72it/s] 51%|█████     | 23/45 [00:03<00:02,  7.93it/s] 53%|█████▎    | 24/45 [00:03<00:02,  7.32it/s] 56%|█████▌    | 25/45 [00:03<00:02,  7.70it/s] 58%|█████▊    | 26/45 [00:03<00:02,  7.84it/s] 60%|██████    | 27/45 [00:03<00:02,  8.03it/s] 62%|██████▏   | 28/45 [00:03<00:02,  8.08it/s] 64%|██████▍   | 29/45 [00:04<00:02,  7.23it/s] 67%|██████▋   | 30/45 [00:04<00:01,  7.62it/s] 69%|██████▉   | 31/45 [00:04<00:01,  7.96it/s] 71%|███████   | 32/45 [00:04<00:01,  8.25it/s] 73%|███████▎  | 33/45 [00:04<00:01,  8.49it/s] 76%|███████▌  | 34/45 [00:04<00:01,  7.69it/s] 78%|███████▊  | 35/45 [00:04<00:01,  8.01it/s] 80%|████████  | 36/45 [00:04<00:01,  8.31it/s] 82%|████████▏ | 37/45 [00:05<00:00,  8.41it/s] 84%|████████▍ | 38/45 [00:05<00:00,  8.20it/s] 87%|████████▋ | 39/45 [00:05<00:00,  7.18it/s] 89%|████████▉ | 40/45 [00:05<00:00,  7.41it/s] 91%|█████████ | 41/45 [00:05<00:00,  7.58it/s] 93%|█████████▎| 42/45 [00:05<00:00,  7.75it/s] 96%|█████████▌| 43/45 [00:05<00:00,  7.05it/s] 98%|█████████▊| 44/45 [00:06<00:00,  7.33it/s]100%|██████████| 45/45 [00:06<00:00,  7.32it/s]
2022-07-19 05:04:09,032 - tool.dba - INFO - insert finish
2022-07-19 05:04:09,089 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-19 05:04:09,090 - tool.dba - INFO - Read data with sql
2022-07-19 05:04:09,090 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-19 05:04:45,082 - tool.dba - INFO - finish read total 4776447 rows
2022-07-19 05:04:45,964 - tool.dba - INFO - Read data with sql
2022-07-19 05:04:45,964 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-19 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-19 05:05:07,595 - tool.dba - INFO - finish read total 2911245 rows
2022-07-19 05:05:08,407 - tool.dba - INFO - Read data with sql
2022-07-19 05:05:08,408 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-19 05:05:08,425 - tool.dba - INFO - finish read total 821 rows
2022-07-19 05:05:08,425 - tool.dba - INFO - Read data with sql
2022-07-19 05:05:08,425 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-19 05:05:08,452 - tool.dba - INFO - finish read total 5350 rows
2022-07-19 05:06:22,970 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:22,970 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:06:23,175 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:06:23,175 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:23,175 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-19 05:06:23,189 - tool.dba - INFO - finish read total 2557 rows
2022-07-19 05:06:34,712 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:34,712 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-19 05:06:34,753 - tool.dba - INFO - finish read total 5395 rows
2022-07-19 05:06:35,068 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:35,068 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:06:35,346 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:06:35,347 - tool.dba - INFO - Delete data with sql
2022-07-19 05:06:35,355 - tool.dba - INFO - Create data with sql
2022-07-19 05:06:35,356 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint D20220719050635_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-19 05:06:35,387 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:35,387 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:06:35,630 - tool.dba - INFO - finish read total 8004 rows
2022-07-19 05:06:35,632 - tool.dba - INFO - create table finish
2022-07-19 05:06:35,632 - tool.dba - INFO - insert data with sql
2022-07-19 05:06:35,647 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  7.03it/s]100%|██████████| 1/1 [00:00<00:00,  7.01it/s]
2022-07-19 05:06:35,791 - tool.dba - INFO - insert finish
2022-07-19 05:06:35,792 - tool.dba - INFO - Delete data with sql
2022-07-19 05:06:35,793 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-19 05:06:36,025 - tool.dba - INFO - Delete data finish
2022-07-19 05:06:36,061 - tool.dba - INFO - insert data with sql
2022-07-19 05:06:36,086 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.46it/s]100%|██████████| 1/1 [00:00<00:00,  5.45it/s]
2022-07-19 05:06:36,271 - tool.dba - INFO - insert finish
2022-07-19 05:06:36,285 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:36,285 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-19 05:06:44,080 - tool.dba - INFO - finish read total 12116 rows
2022-07-19 05:06:44,283 - tool.dba - INFO - Read data with sql
2022-07-19 05:06:44,283 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-19 05:08:30,718 - tool.dba - INFO - finish read total 5938666 rows
2022-07-19 05:08:42,690 - tool.dba - INFO - Read data with sql
2022-07-19 05:08:42,690 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:08:42,955 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:08:42,955 - tool.dba - INFO - Read data with sql
2022-07-19 05:08:42,955 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-19 05:08:42,971 - tool.dba - INFO - finish read total 2557 rows
2022-07-19 05:10:30,164 - tool.dba - INFO - Read data with sql
2022-07-19 05:10:30,164 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:10:30,425 - tool.dba - INFO - finish read total 8003 rows
2022-07-19 05:10:30,426 - tool.dba - INFO - Delete data with sql
2022-07-19 05:10:30,430 - tool.dba - INFO - Create data with sql
2022-07-19 05:10:30,431 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint C20220719051030_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-19 05:10:30,458 - tool.dba - INFO - Read data with sql
2022-07-19 05:10:30,458 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:10:30,710 - tool.dba - INFO - finish read total 8004 rows
2022-07-19 05:10:30,711 - tool.dba - INFO - create table finish
2022-07-19 05:10:30,711 - tool.dba - INFO - insert data with sql
2022-07-19 05:10:30,719 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 35.47it/s]
2022-07-19 05:10:30,748 - tool.dba - INFO - insert finish
2022-07-19 05:10:30,748 - tool.dba - INFO - Delete data with sql
2022-07-19 05:10:30,748 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-19 05:10:30,790 - tool.dba - INFO - Delete data finish
2022-07-19 05:10:30,829 - tool.dba - INFO - insert data with sql
2022-07-19 05:10:30,840 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 48.62it/s]
2022-07-19 05:10:30,862 - tool.dba - INFO - insert finish
2022-07-19 05:10:30,867 - tool.dba - INFO - Read data with sql
2022-07-19 05:10:30,867 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-19 05:10:32,016 - tool.dba - INFO - finish read total 168948 rows
2022-07-19 05:10:32,016 - tool.dba - INFO - Read data with sql
2022-07-19 05:10:32,016 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-19 05:10:46,908 - tool.dba - INFO - finish read total 97885 rows
2022-07-19 05:10:47,183 - tool.dba - INFO - Read data with sql
2022-07-19 05:10:47,183 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-19 05:10:56,923 - tool.dba - INFO - finish read total 916527 rows
2022-07-19 05:10:56,923 - tool.dba - INFO - Read data with sql
2022-07-19 05:10:56,923 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-19 05:11:05,418 - tool.dba - INFO - finish read total 1066567 rows
2022-07-19 05:11:05,418 - tool.dba - INFO - Read data with sql
2022-07-19 05:11:05,418 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-19 05:11:16,993 - tool.dba - INFO - finish read total 1267769 rows
2022-07-19 05:11:16,993 - tool.dba - INFO - Read data with sql
2022-07-19 05:11:16,993 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-19 05:11:22,788 - tool.dba - INFO - finish read total 874046 rows
2022-07-19 05:11:22,788 - tool.dba - INFO - Read data with sql
2022-07-19 05:11:22,788 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-19 05:11:33,535 - tool.dba - INFO - finish read total 1436199 rows
2022-07-19 05:11:33,535 - tool.dba - INFO - Read data with sql
2022-07-19 05:11:33,535 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-19 05:11:40,828 - tool.dba - INFO - finish read total 1039050 rows
2022-07-19 05:12:09,863 - tool.dba - INFO - Read data with sql
2022-07-19 05:12:09,863 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-19 05:12:09,888 - tool.dba - INFO - finish read total 3241 rows
2022-07-19 05:12:13,371 - tool.dba - INFO - Delete data with sql
2022-07-19 05:12:13,522 - tool.dba - INFO - Create data with sql
2022-07-19 05:12:13,522 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint C20220719051213_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-19 05:12:13,559 - tool.dba - INFO - Read data with sql
2022-07-19 05:12:13,559 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-19 05:12:13,791 - tool.dba - INFO - finish read total 8004 rows
2022-07-19 05:12:13,792 - tool.dba - INFO - create table finish
2022-07-19 05:12:13,792 - tool.dba - INFO - insert data with sql
2022-07-19 05:12:14,159 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.18it/s]  7%|▋         | 2/29 [00:00<00:03,  8.05it/s] 10%|█         | 3/29 [00:00<00:03,  7.86it/s] 14%|█▍        | 4/29 [00:00<00:03,  6.82it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.10it/s] 21%|██        | 6/29 [00:00<00:03,  7.13it/s] 24%|██▍       | 7/29 [00:00<00:03,  7.06it/s] 28%|██▊       | 8/29 [00:01<00:02,  7.05it/s] 31%|███       | 9/29 [00:01<00:02,  6.74it/s] 34%|███▍      | 10/29 [00:01<00:02,  6.79it/s] 38%|███▊      | 11/29 [00:01<00:02,  7.19it/s] 41%|████▏     | 12/29 [00:01<00:02,  7.57it/s] 45%|████▍     | 13/29 [00:01<00:02,  7.65it/s] 48%|████▊     | 14/29 [00:01<00:01,  7.81it/s] 52%|█████▏    | 15/29 [00:02<00:01,  7.62it/s] 55%|█████▌    | 16/29 [00:02<00:01,  7.43it/s] 59%|█████▊    | 17/29 [00:02<00:01,  6.68it/s] 62%|██████▏   | 18/29 [00:02<00:01,  6.82it/s] 66%|██████▌   | 19/29 [00:02<00:01,  6.69it/s] 69%|██████▉   | 20/29 [00:02<00:01,  6.59it/s] 72%|███████▏  | 21/29 [00:03<00:01,  6.19it/s] 76%|███████▌  | 22/29 [00:03<00:01,  6.55it/s] 79%|███████▉  | 23/29 [00:03<00:00,  6.81it/s] 83%|████████▎ | 24/29 [00:03<00:00,  7.12it/s] 86%|████████▌ | 25/29 [00:03<00:00,  6.96it/s] 90%|████████▉ | 26/29 [00:03<00:00,  6.21it/s] 93%|█████████▎| 27/29 [00:03<00:00,  6.27it/s] 97%|█████████▋| 28/29 [00:04<00:00,  6.53it/s]100%|██████████| 29/29 [00:04<00:00,  6.67it/s]100%|██████████| 29/29 [00:04<00:00,  6.92it/s]
2022-07-19 05:12:18,348 - tool.dba - INFO - insert finish
2022-07-19 05:12:18,360 - tool.dba - INFO - Delete data with sql
2022-07-19 05:12:18,360 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-19 05:12:28,453 - tool.dba - INFO - Delete data finish
2022-07-19 05:12:28,590 - tool.dba - INFO - insert data with sql
2022-07-19 05:12:29,079 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:08,  3.37it/s]  7%|▋         | 2/29 [00:00<00:07,  3.64it/s] 10%|█         | 3/29 [00:00<00:06,  3.80it/s] 14%|█▍        | 4/29 [00:01<00:06,  3.72it/s] 17%|█▋        | 5/29 [00:01<00:06,  3.43it/s] 21%|██        | 6/29 [00:01<00:06,  3.44it/s] 24%|██▍       | 7/29 [00:01<00:06,  3.57it/s] 28%|██▊       | 8/29 [00:04<00:18,  1.12it/s] 31%|███       | 9/29 [00:04<00:14,  1.42it/s] 34%|███▍      | 10/29 [00:04<00:10,  1.77it/s] 38%|███▊      | 11/29 [00:05<00:08,  2.04it/s] 41%|████▏     | 12/29 [00:05<00:07,  2.38it/s] 45%|████▍     | 13/29 [00:05<00:05,  2.69it/s] 48%|████▊     | 14/29 [00:05<00:05,  2.84it/s] 52%|█████▏    | 15/29 [00:06<00:04,  3.05it/s] 55%|█████▌    | 16/29 [00:06<00:04,  3.14it/s] 59%|█████▊    | 17/29 [00:06<00:03,  3.10it/s] 62%|██████▏   | 18/29 [00:07<00:03,  3.25it/s] 66%|██████▌   | 19/29 [00:07<00:02,  3.33it/s] 69%|██████▉   | 20/29 [00:07<00:02,  3.15it/s] 72%|███████▏  | 21/29 [00:07<00:02,  3.28it/s] 76%|███████▌  | 22/29 [00:10<00:06,  1.06it/s] 79%|███████▉  | 23/29 [00:10<00:04,  1.36it/s] 83%|████████▎ | 24/29 [00:10<00:03,  1.64it/s] 86%|████████▌ | 25/29 [00:11<00:02,  1.98it/s] 90%|████████▉ | 26/29 [00:11<00:01,  2.28it/s] 93%|█████████▎| 27/29 [00:11<00:00,  2.42it/s] 97%|█████████▋| 28/29 [00:12<00:00,  2.72it/s]100%|██████████| 29/29 [00:12<00:00,  2.89it/s]100%|██████████| 29/29 [00:12<00:00,  2.34it/s]
2022-07-19 05:12:41,481 - tool.dba - INFO - insert finish
2022-07-20 05:00:00,447 - tool.dba - INFO - Read data with sql
2022-07-20 05:00:00,448 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:00:00,806 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:00:00,807 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-20 05:00:00,807 - tool.dba - INFO - Read data with sql
2022-07-20 05:00:00,807 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-20 05:00:48,017 - tool.dba - INFO - finish read total 6465308 rows
2022-07-20 05:01:03,129 - tool.dba - INFO - Read data with sql
2022-07-20 05:01:03,129 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:01:03,322 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:01:03,322 - tool.dba - INFO - Read data with sql
2022-07-20 05:01:03,322 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-20 05:01:03,338 - tool.dba - INFO - finish read total 2557 rows
2022-07-20 05:03:37,720 - tool.dba - INFO - Read data with sql
2022-07-20 05:03:37,720 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:03:38,008 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:03:38,009 - tool.dba - INFO - Delete data with sql
2022-07-20 05:03:38,075 - tool.dba - INFO - Create data with sql
2022-07-20 05:03:38,075 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint K20220720050338_pk primary key (STORE_ID,DS)
        )
        
2022-07-20 05:03:38,111 - tool.dba - INFO - Read data with sql
2022-07-20 05:03:38,111 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:03:38,367 - tool.dba - INFO - finish read total 8008 rows
2022-07-20 05:03:38,368 - tool.dba - INFO - create table finish
2022-07-20 05:03:38,368 - tool.dba - INFO - insert data with sql
2022-07-20 05:03:38,505 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:07,  6.16it/s]  4%|▍         | 2/45 [00:00<00:05,  7.65it/s]  9%|▉         | 4/45 [00:00<00:04,  8.93it/s] 11%|█         | 5/45 [00:00<00:04,  8.22it/s] 16%|█▌        | 7/45 [00:00<00:04,  9.13it/s] 20%|██        | 9/45 [00:01<00:03,  9.54it/s] 22%|██▏       | 10/45 [00:01<00:03,  8.85it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.41it/s] 31%|███       | 14/45 [00:01<00:03,  9.78it/s] 33%|███▎      | 15/45 [00:01<00:03,  9.01it/s] 38%|███▊      | 17/45 [00:01<00:02,  9.51it/s] 42%|████▏     | 19/45 [00:02<00:02,  9.52it/s] 44%|████▍     | 20/45 [00:02<00:02,  8.94it/s] 49%|████▉     | 22/45 [00:02<00:02,  9.17it/s] 53%|█████▎    | 24/45 [00:02<00:02,  9.16it/s] 58%|█████▊    | 26/45 [00:02<00:01, 10.01it/s] 62%|██████▏   | 28/45 [00:02<00:01, 10.74it/s] 67%|██████▋   | 30/45 [00:03<00:01, 10.11it/s] 71%|███████   | 32/45 [00:03<00:01, 10.02it/s] 76%|███████▌  | 34/45 [00:03<00:01,  9.17it/s] 80%|████████  | 36/45 [00:03<00:00,  9.48it/s] 82%|████████▏ | 37/45 [00:03<00:00,  9.50it/s] 87%|████████▋ | 39/45 [00:04<00:00,  9.01it/s] 91%|█████████ | 41/45 [00:04<00:00,  9.22it/s] 96%|█████████▌| 43/45 [00:04<00:00,  8.87it/s]100%|██████████| 45/45 [00:04<00:00,  9.56it/s]100%|██████████| 45/45 [00:04<00:00,  9.35it/s]
2022-07-20 05:03:43,317 - tool.dba - INFO - insert finish
2022-07-20 05:03:43,321 - tool.dba - INFO - Delete data with sql
2022-07-20 05:03:43,321 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-20 05:04:02,521 - tool.dba - INFO - Delete data finish
2022-07-20 05:04:02,572 - tool.dba - INFO - insert data with sql
2022-07-20 05:04:02,714 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:04,  9.96it/s]  7%|▋         | 3/45 [00:00<00:05,  7.75it/s]  9%|▉         | 4/45 [00:00<00:05,  8.08it/s] 11%|█         | 5/45 [00:00<00:04,  8.34it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.49it/s] 16%|█▌        | 7/45 [00:00<00:04,  8.56it/s] 18%|█▊        | 8/45 [00:00<00:04,  7.59it/s] 20%|██        | 9/45 [00:01<00:04,  7.88it/s] 22%|██▏       | 10/45 [00:01<00:04,  7.75it/s] 24%|██▍       | 11/45 [00:01<00:04,  8.05it/s] 27%|██▋       | 12/45 [00:01<00:03,  8.28it/s] 29%|██▉       | 13/45 [00:01<00:04,  7.40it/s] 31%|███       | 14/45 [00:01<00:03,  7.76it/s] 33%|███▎      | 15/45 [00:01<00:03,  7.90it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.00it/s] 38%|███▊      | 17/45 [00:02<00:03,  7.68it/s] 40%|████      | 18/45 [00:02<00:03,  7.11it/s] 42%|████▏     | 19/45 [00:02<00:03,  7.52it/s] 44%|████▍     | 20/45 [00:02<00:03,  7.66it/s] 47%|████▋     | 21/45 [00:02<00:03,  7.92it/s] 49%|████▉     | 22/45 [00:02<00:03,  7.09it/s] 51%|█████     | 23/45 [00:02<00:02,  7.53it/s] 53%|█████▎    | 24/45 [00:03<00:02,  7.80it/s] 56%|█████▌    | 25/45 [00:03<00:02,  8.09it/s] 58%|█████▊    | 26/45 [00:03<00:02,  8.26it/s] 60%|██████    | 27/45 [00:03<00:02,  7.32it/s] 62%|██████▏   | 28/45 [00:03<00:02,  7.68it/s] 64%|██████▍   | 29/45 [00:03<00:02,  7.93it/s] 67%|██████▋   | 30/45 [00:03<00:01,  8.09it/s] 69%|██████▉   | 31/45 [00:03<00:01,  8.25it/s] 71%|███████   | 32/45 [00:05<00:08,  1.61it/s] 73%|███████▎  | 33/45 [00:05<00:05,  2.12it/s] 76%|███████▌  | 34/45 [00:05<00:04,  2.75it/s] 78%|███████▊  | 35/45 [00:06<00:02,  3.42it/s] 80%|████████  | 36/45 [00:06<00:02,  4.17it/s] 82%|████████▏ | 37/45 [00:06<00:01,  4.61it/s] 84%|████████▍ | 38/45 [00:06<00:01,  5.33it/s] 87%|████████▋ | 39/45 [00:06<00:00,  6.05it/s] 89%|████████▉ | 40/45 [00:06<00:00,  6.65it/s] 91%|█████████ | 41/45 [00:06<00:00,  6.46it/s] 93%|█████████▎| 42/45 [00:06<00:00,  7.04it/s] 96%|█████████▌| 43/45 [00:07<00:00,  7.48it/s] 98%|█████████▊| 44/45 [00:07<00:00,  7.84it/s]100%|██████████| 45/45 [00:07<00:00,  6.17it/s]
2022-07-20 05:04:10,014 - tool.dba - INFO - insert finish
2022-07-20 05:04:10,070 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-20 05:04:10,072 - tool.dba - INFO - Read data with sql
2022-07-20 05:04:10,072 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-20 05:04:46,205 - tool.dba - INFO - finish read total 4776447 rows
2022-07-20 05:04:47,072 - tool.dba - INFO - Read data with sql
2022-07-20 05:04:47,073 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-20 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-20 05:05:09,852 - tool.dba - INFO - finish read total 3078181 rows
2022-07-20 05:05:10,701 - tool.dba - INFO - Read data with sql
2022-07-20 05:05:10,701 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-20 05:05:10,709 - tool.dba - INFO - finish read total 824 rows
2022-07-20 05:05:10,710 - tool.dba - INFO - Read data with sql
2022-07-20 05:05:10,710 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-20 05:05:10,734 - tool.dba - INFO - finish read total 5362 rows
2022-07-20 05:06:26,225 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:26,225 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:06:26,502 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:06:26,502 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:26,502 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-20 05:06:26,517 - tool.dba - INFO - finish read total 2557 rows
2022-07-20 05:06:38,194 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:38,194 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-20 05:06:38,230 - tool.dba - INFO - finish read total 5396 rows
2022-07-20 05:06:38,534 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:38,534 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:06:38,790 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:06:38,791 - tool.dba - INFO - Delete data with sql
2022-07-20 05:06:38,799 - tool.dba - INFO - Create data with sql
2022-07-20 05:06:38,800 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint X20220720050638_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-20 05:06:38,828 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:38,828 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:06:39,098 - tool.dba - INFO - finish read total 8008 rows
2022-07-20 05:06:39,099 - tool.dba - INFO - create table finish
2022-07-20 05:06:39,099 - tool.dba - INFO - insert data with sql
2022-07-20 05:06:39,116 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.90it/s]100%|██████████| 1/1 [00:00<00:00,  8.87it/s]
2022-07-20 05:06:39,229 - tool.dba - INFO - insert finish
2022-07-20 05:06:39,231 - tool.dba - INFO - Delete data with sql
2022-07-20 05:06:39,231 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-20 05:06:39,415 - tool.dba - INFO - Delete data finish
2022-07-20 05:06:39,515 - tool.dba - INFO - insert data with sql
2022-07-20 05:06:39,538 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.31it/s]100%|██████████| 1/1 [00:00<00:00,  5.30it/s]
2022-07-20 05:06:39,727 - tool.dba - INFO - insert finish
2022-07-20 05:06:39,742 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:39,742 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-20 05:06:52,640 - tool.dba - INFO - finish read total 12132 rows
2022-07-20 05:06:52,846 - tool.dba - INFO - Read data with sql
2022-07-20 05:06:52,846 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-20 05:08:36,624 - tool.dba - INFO - finish read total 5943697 rows
2022-07-20 05:08:48,562 - tool.dba - INFO - Read data with sql
2022-07-20 05:08:48,562 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:08:48,827 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:08:48,828 - tool.dba - INFO - Read data with sql
2022-07-20 05:08:48,828 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-20 05:08:48,844 - tool.dba - INFO - finish read total 2557 rows
2022-07-20 05:10:36,540 - tool.dba - INFO - Read data with sql
2022-07-20 05:10:36,541 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:10:36,807 - tool.dba - INFO - finish read total 8007 rows
2022-07-20 05:10:36,808 - tool.dba - INFO - Delete data with sql
2022-07-20 05:10:36,812 - tool.dba - INFO - Create data with sql
2022-07-20 05:10:36,813 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint P20220720051036_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-20 05:10:36,839 - tool.dba - INFO - Read data with sql
2022-07-20 05:10:36,839 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:10:37,102 - tool.dba - INFO - finish read total 8008 rows
2022-07-20 05:10:37,103 - tool.dba - INFO - create table finish
2022-07-20 05:10:37,103 - tool.dba - INFO - insert data with sql
2022-07-20 05:10:37,111 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 42.07it/s]
2022-07-20 05:10:37,135 - tool.dba - INFO - insert finish
2022-07-20 05:10:37,135 - tool.dba - INFO - Delete data with sql
2022-07-20 05:10:37,135 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-20 05:10:37,167 - tool.dba - INFO - Delete data finish
2022-07-20 05:10:37,207 - tool.dba - INFO - insert data with sql
2022-07-20 05:10:37,218 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 57.79it/s]
2022-07-20 05:10:37,236 - tool.dba - INFO - insert finish
2022-07-20 05:10:37,240 - tool.dba - INFO - Read data with sql
2022-07-20 05:10:37,240 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-20 05:10:38,422 - tool.dba - INFO - finish read total 169035 rows
2022-07-20 05:10:38,422 - tool.dba - INFO - Read data with sql
2022-07-20 05:10:38,422 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-20 05:10:55,910 - tool.dba - INFO - finish read total 97843 rows
2022-07-20 05:10:56,182 - tool.dba - INFO - Read data with sql
2022-07-20 05:10:56,183 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-20 05:11:07,203 - tool.dba - INFO - finish read total 924091 rows
2022-07-20 05:11:07,203 - tool.dba - INFO - Read data with sql
2022-07-20 05:11:07,203 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-20 05:11:15,653 - tool.dba - INFO - finish read total 1074128 rows
2022-07-20 05:11:15,653 - tool.dba - INFO - Read data with sql
2022-07-20 05:11:15,653 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-20 05:11:26,437 - tool.dba - INFO - finish read total 1265048 rows
2022-07-20 05:11:26,437 - tool.dba - INFO - Read data with sql
2022-07-20 05:11:26,437 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-20 05:11:31,804 - tool.dba - INFO - finish read total 872643 rows
2022-07-20 05:11:31,804 - tool.dba - INFO - Read data with sql
2022-07-20 05:11:31,804 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-20 05:11:41,713 - tool.dba - INFO - finish read total 1436368 rows
2022-07-20 05:11:41,713 - tool.dba - INFO - Read data with sql
2022-07-20 05:11:41,713 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-20 05:11:48,332 - tool.dba - INFO - finish read total 1040894 rows
2022-07-20 05:12:17,647 - tool.dba - INFO - Read data with sql
2022-07-20 05:12:17,647 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-20 05:12:17,671 - tool.dba - INFO - finish read total 3249 rows
2022-07-20 05:12:21,061 - tool.dba - INFO - Delete data with sql
2022-07-20 05:12:21,210 - tool.dba - INFO - Create data with sql
2022-07-20 05:12:21,211 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint Q20220720051221_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-20 05:12:21,239 - tool.dba - INFO - Read data with sql
2022-07-20 05:12:21,239 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-20 05:12:21,471 - tool.dba - INFO - finish read total 8008 rows
2022-07-20 05:12:21,472 - tool.dba - INFO - create table finish
2022-07-20 05:12:21,472 - tool.dba - INFO - insert data with sql
2022-07-20 05:12:21,837 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.97it/s]  7%|▋         | 2/29 [00:00<00:03,  6.90it/s] 10%|█         | 3/29 [00:00<00:03,  7.40it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.65it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.57it/s] 21%|██        | 6/29 [00:00<00:03,  7.42it/s] 24%|██▍       | 7/29 [00:00<00:03,  7.13it/s] 28%|██▊       | 8/29 [00:01<00:02,  7.13it/s] 31%|███       | 9/29 [00:01<00:02,  7.13it/s] 34%|███▍      | 10/29 [00:01<00:02,  7.07it/s] 38%|███▊      | 11/29 [00:01<00:02,  7.37it/s] 41%|████▏     | 12/29 [00:01<00:02,  7.52it/s] 45%|████▍     | 13/29 [00:01<00:02,  6.84it/s] 48%|████▊     | 14/29 [00:01<00:02,  7.06it/s] 52%|█████▏    | 15/29 [00:02<00:01,  7.10it/s] 55%|█████▌    | 16/29 [00:02<00:01,  7.10it/s] 59%|█████▊    | 17/29 [00:02<00:01,  7.14it/s] 62%|██████▏   | 18/29 [00:02<00:01,  6.50it/s] 66%|██████▌   | 19/29 [00:02<00:01,  6.62it/s] 69%|██████▉   | 20/29 [00:02<00:01,  6.54it/s] 72%|███████▏  | 21/29 [00:02<00:01,  6.86it/s] 76%|███████▌  | 22/29 [00:03<00:00,  7.22it/s] 79%|███████▉  | 23/29 [00:03<00:00,  6.73it/s] 83%|████████▎ | 24/29 [00:03<00:00,  6.82it/s] 86%|████████▌ | 25/29 [00:03<00:00,  6.99it/s] 90%|████████▉ | 26/29 [00:03<00:00,  7.11it/s] 93%|█████████▎| 27/29 [00:03<00:00,  6.46it/s] 97%|█████████▋| 28/29 [00:04<00:00,  6.64it/s]100%|██████████| 29/29 [00:04<00:00,  6.76it/s]100%|██████████| 29/29 [00:04<00:00,  6.98it/s]
2022-07-20 05:12:25,994 - tool.dba - INFO - insert finish
2022-07-20 05:12:26,006 - tool.dba - INFO - Delete data with sql
2022-07-20 05:12:26,006 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-20 05:12:37,698 - tool.dba - INFO - Delete data finish
2022-07-20 05:12:37,867 - tool.dba - INFO - insert data with sql
2022-07-20 05:12:38,338 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:07,  3.93it/s]  7%|▋         | 2/29 [00:00<00:07,  3.40it/s] 10%|█         | 3/29 [00:00<00:07,  3.58it/s] 14%|█▍        | 4/29 [00:01<00:09,  2.54it/s] 17%|█▋        | 5/29 [00:01<00:08,  2.70it/s] 21%|██        | 6/29 [00:02<00:07,  2.97it/s] 24%|██▍       | 7/29 [00:02<00:07,  3.06it/s] 28%|██▊       | 8/29 [00:02<00:06,  3.21it/s] 31%|███       | 9/29 [00:02<00:06,  3.17it/s] 34%|███▍      | 10/29 [00:03<00:05,  3.43it/s] 38%|███▊      | 11/29 [00:03<00:04,  3.70it/s] 41%|████▏     | 12/29 [00:03<00:04,  3.53it/s] 45%|████▍     | 13/29 [00:03<00:04,  3.63it/s] 48%|████▊     | 14/29 [00:04<00:04,  3.67it/s] 52%|█████▏    | 15/29 [00:04<00:04,  3.44it/s] 55%|█████▌    | 16/29 [00:04<00:03,  3.42it/s] 59%|█████▊    | 17/29 [00:05<00:03,  3.43it/s] 62%|██████▏   | 18/29 [00:05<00:03,  3.30it/s] 66%|██████▌   | 19/29 [00:07<00:08,  1.19it/s] 69%|██████▉   | 20/29 [00:07<00:06,  1.48it/s] 72%|███████▏  | 21/29 [00:08<00:04,  1.75it/s] 76%|███████▌  | 22/29 [00:08<00:03,  2.07it/s] 79%|███████▉  | 23/29 [00:08<00:02,  2.36it/s] 83%|████████▎ | 24/29 [00:09<00:02,  2.44it/s] 86%|████████▌ | 25/29 [00:09<00:01,  2.69it/s] 90%|████████▉ | 26/29 [00:09<00:01,  2.89it/s] 93%|█████████▎| 27/29 [00:09<00:00,  3.04it/s] 97%|█████████▋| 28/29 [00:10<00:00,  2.98it/s]100%|██████████| 29/29 [00:10<00:00,  3.08it/s]100%|██████████| 29/29 [00:10<00:00,  2.73it/s]
2022-07-20 05:12:48,965 - tool.dba - INFO - insert finish
2022-07-20 23:39:32.023 Read data with sql
2022-07-20 23:39:32.023 SELECT * FROM all_tab_comments
2022-07-20 23:39:32.680 finish read total 9372 rows
2022-07-20 23:39:32.712 Read data with sql
2022-07-20 23:39:32.712 SELECT * FROM all_tab_comments
2022-07-20 23:39:33.003 finish read total 8007 rows
2022-07-20 23:39:33.015 Read data with sql
2022-07-20 23:39:33.015 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-20 23:39:38.145 finish read total 119446 rows
/home/zyuser/anaconda3/lib/python3.9/site-packages/xlsxwriter/workbook.py:338: UserWarning: Calling close() on already closed file.
  warn("Calling close() on already closed file.")
/home/zyuser/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py:4150: PerformanceWarning: dropping on a non-lexsorted multi-index without a level parameter may impact performance.
  obj = obj._drop_axis(labels, axis, level=level, errors=errors)
2022-07-20 23:39:42.331 Read data with sql
2022-07-20 23:39:42.331 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-20 23:39:44.311 finish read total 119446 rows
2022-07-20 23:39:48.200 Read data with sql
2022-07-20 23:39:48.200 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-20 23:39:50.221 finish read total 119446 rows
2022-07-21 05:00:00,790 - tool.dba - INFO - Read data with sql
2022-07-21 05:00:00,790 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:00:01,075 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:00:01,076 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-21 05:00:01,076 - tool.dba - INFO - Read data with sql
2022-07-21 05:00:01,076 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-21 05:00:48,247 - tool.dba - INFO - finish read total 6470458 rows
2022-07-21 05:01:03,381 - tool.dba - INFO - Read data with sql
2022-07-21 05:01:03,381 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:01:03,640 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:01:03,640 - tool.dba - INFO - Read data with sql
2022-07-21 05:01:03,640 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-21 05:01:03,659 - tool.dba - INFO - finish read total 2557 rows
2022-07-21 05:03:39,061 - tool.dba - INFO - Read data with sql
2022-07-21 05:03:39,061 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:03:39,309 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:03:39,310 - tool.dba - INFO - Delete data with sql
2022-07-21 05:03:39,374 - tool.dba - INFO - Create data with sql
2022-07-21 05:03:39,374 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint F20220721050339_pk primary key (STORE_ID,DS)
        )
        
2022-07-21 05:03:39,455 - tool.dba - INFO - Read data with sql
2022-07-21 05:03:39,455 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:03:39,693 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 05:03:39,695 - tool.dba - INFO - create table finish
2022-07-21 05:03:39,695 - tool.dba - INFO - insert data with sql
2022-07-21 05:03:39,833 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:05,  7.43it/s]  4%|▍         | 2/45 [00:00<00:05,  7.78it/s]  9%|▉         | 4/45 [00:00<00:04,  9.18it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.94it/s] 18%|█▊        | 8/45 [00:00<00:03,  9.43it/s] 20%|██        | 9/45 [00:00<00:03,  9.47it/s] 22%|██▏       | 10/45 [00:01<00:04,  8.74it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.45it/s] 31%|███       | 14/45 [00:01<00:03,  9.89it/s] 33%|███▎      | 15/45 [00:01<00:03,  9.02it/s] 38%|███▊      | 17/45 [00:01<00:02,  9.45it/s] 40%|████      | 18/45 [00:01<00:02,  9.40it/s] 42%|████▏     | 19/45 [00:02<00:02,  9.53it/s] 44%|████▍     | 20/45 [00:02<00:02,  8.74it/s] 47%|████▋     | 21/45 [00:02<00:02,  8.96it/s] 51%|█████     | 23/45 [00:02<00:02,  9.41it/s] 56%|█████▌    | 25/45 [00:02<00:02,  9.00it/s] 60%|██████    | 27/45 [00:02<00:01,  9.74it/s] 64%|██████▍   | 29/45 [00:03<00:01,  9.00it/s] 67%|██████▋   | 30/45 [00:03<00:01,  9.14it/s] 71%|███████   | 32/45 [00:03<00:01,  9.54it/s] 76%|███████▌  | 34/45 [00:03<00:01,  9.04it/s] 80%|████████  | 36/45 [00:03<00:00,  9.01it/s] 82%|████████▏ | 37/45 [00:04<00:00,  9.17it/s] 84%|████████▍ | 38/45 [00:04<00:00,  9.31it/s] 87%|████████▋ | 39/45 [00:04<00:00,  8.63it/s] 91%|█████████ | 41/45 [00:04<00:00,  9.24it/s] 96%|█████████▌| 43/45 [00:04<00:00,  9.61it/s] 98%|█████████▊| 44/45 [00:04<00:00,  8.66it/s]100%|██████████| 45/45 [00:04<00:00,  9.18it/s]
2022-07-21 05:03:44,738 - tool.dba - INFO - insert finish
2022-07-21 05:03:44,742 - tool.dba - INFO - Delete data with sql
2022-07-21 05:03:44,742 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-21 05:04:03,213 - tool.dba - INFO - Delete data finish
2022-07-21 05:04:03,283 - tool.dba - INFO - insert data with sql
2022-07-21 05:04:03,429 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:04, 10.20it/s]  9%|▉         | 4/45 [00:00<00:04,  8.38it/s] 11%|█         | 5/45 [00:00<00:04,  8.49it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.61it/s] 16%|█▌        | 7/45 [00:00<00:04,  8.74it/s] 18%|█▊        | 8/45 [00:00<00:04,  7.75it/s] 20%|██        | 9/45 [00:01<00:04,  8.08it/s] 22%|██▏       | 10/45 [00:01<00:04,  7.91it/s] 24%|██▍       | 11/45 [00:01<00:04,  8.07it/s] 27%|██▋       | 12/45 [00:01<00:03,  8.32it/s] 29%|██▉       | 13/45 [00:01<00:04,  7.74it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.39it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.47it/s] 38%|███▊      | 17/45 [00:02<00:03,  8.49it/s] 40%|████      | 18/45 [00:02<00:03,  7.66it/s] 42%|████▏     | 19/45 [00:02<00:03,  7.93it/s] 44%|████▍     | 20/45 [00:02<00:03,  8.05it/s] 47%|████▋     | 21/45 [00:02<00:02,  8.23it/s] 49%|████▉     | 22/45 [00:02<00:02,  8.34it/s] 51%|█████     | 23/45 [00:02<00:02,  7.74it/s] 53%|█████▎    | 24/45 [00:02<00:02,  8.27it/s] 56%|█████▌    | 25/45 [00:03<00:02,  8.47it/s] 58%|█████▊    | 26/45 [00:03<00:02,  8.58it/s] 60%|██████    | 27/45 [00:03<00:02,  7.65it/s] 62%|██████▏   | 28/45 [00:03<00:02,  7.89it/s] 64%|██████▍   | 29/45 [00:03<00:02,  7.99it/s] 67%|██████▋   | 30/45 [00:03<00:01,  8.16it/s] 69%|██████▉   | 31/45 [00:05<00:09,  1.51it/s] 71%|███████   | 32/45 [00:05<00:06,  1.95it/s] 73%|███████▎  | 33/45 [00:05<00:04,  2.55it/s] 76%|███████▌  | 34/45 [00:05<00:03,  3.16it/s] 78%|███████▊  | 35/45 [00:06<00:02,  3.92it/s] 80%|████████  | 36/45 [00:06<00:01,  4.70it/s] 82%|████████▏ | 37/45 [00:06<00:01,  5.05it/s] 84%|████████▍ | 38/45 [00:06<00:01,  5.81it/s] 87%|████████▋ | 39/45 [00:06<00:00,  6.49it/s] 89%|████████▉ | 40/45 [00:06<00:00,  7.06it/s] 91%|█████████ | 41/45 [00:06<00:00,  7.48it/s] 93%|█████████▎| 42/45 [00:06<00:00,  7.12it/s] 96%|█████████▌| 43/45 [00:07<00:00,  7.48it/s] 98%|█████████▊| 44/45 [00:07<00:00,  7.79it/s]100%|██████████| 45/45 [00:07<00:00,  6.14it/s]
2022-07-21 05:04:10,753 - tool.dba - INFO - insert finish
2022-07-21 05:04:10,808 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-21 05:04:10,810 - tool.dba - INFO - Read data with sql
2022-07-21 05:04:10,810 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-21 05:04:47,853 - tool.dba - INFO - finish read total 4776447 rows
2022-07-21 05:04:48,734 - tool.dba - INFO - Read data with sql
2022-07-21 05:04:48,734 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-21 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-21 05:05:13,138 - tool.dba - INFO - finish read total 3242713 rows
2022-07-21 05:05:14,025 - tool.dba - INFO - Read data with sql
2022-07-21 05:05:14,025 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-21 05:05:14,051 - tool.dba - INFO - finish read total 824 rows
2022-07-21 05:05:14,051 - tool.dba - INFO - Read data with sql
2022-07-21 05:05:14,051 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-21 05:05:14,079 - tool.dba - INFO - finish read total 5369 rows
2022-07-21 05:06:30,499 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:30,499 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:06:30,787 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:06:30,787 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:30,787 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-21 05:06:30,803 - tool.dba - INFO - finish read total 2557 rows
2022-07-21 05:06:42,770 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:42,770 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-21 05:06:42,808 - tool.dba - INFO - finish read total 5397 rows
2022-07-21 05:06:43,128 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:43,128 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:06:43,473 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:06:43,474 - tool.dba - INFO - Delete data with sql
2022-07-21 05:06:43,482 - tool.dba - INFO - Create data with sql
2022-07-21 05:06:43,483 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint H20220721050643_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-21 05:06:43,513 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:43,513 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:06:43,770 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 05:06:43,771 - tool.dba - INFO - create table finish
2022-07-21 05:06:43,771 - tool.dba - INFO - insert data with sql
2022-07-21 05:06:43,787 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.82it/s]100%|██████████| 1/1 [00:00<00:00,  8.79it/s]
2022-07-21 05:06:43,901 - tool.dba - INFO - insert finish
2022-07-21 05:06:43,903 - tool.dba - INFO - Delete data with sql
2022-07-21 05:06:43,903 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-21 05:06:44,141 - tool.dba - INFO - Delete data finish
2022-07-21 05:06:44,229 - tool.dba - INFO - insert data with sql
2022-07-21 05:06:44,253 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.28it/s]100%|██████████| 1/1 [00:00<00:00,  5.27it/s]
2022-07-21 05:06:44,443 - tool.dba - INFO - insert finish
2022-07-21 05:06:44,458 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:44,458 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-21 05:06:57,166 - tool.dba - INFO - finish read total 12145 rows
2022-07-21 05:06:57,372 - tool.dba - INFO - Read data with sql
2022-07-21 05:06:57,372 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-21 05:08:49,585 - tool.dba - INFO - finish read total 5948728 rows
2022-07-21 05:09:02,020 - tool.dba - INFO - Read data with sql
2022-07-21 05:09:02,021 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:09:02,293 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:09:02,294 - tool.dba - INFO - Read data with sql
2022-07-21 05:09:02,294 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-21 05:09:02,309 - tool.dba - INFO - finish read total 2557 rows
2022-07-21 05:10:51,723 - tool.dba - INFO - Read data with sql
2022-07-21 05:10:51,723 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:10:51,966 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 05:10:51,967 - tool.dba - INFO - Delete data with sql
2022-07-21 05:10:51,972 - tool.dba - INFO - Create data with sql
2022-07-21 05:10:51,973 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint Y20220721051051_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-21 05:10:51,999 - tool.dba - INFO - Read data with sql
2022-07-21 05:10:51,999 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:10:52,240 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 05:10:52,241 - tool.dba - INFO - create table finish
2022-07-21 05:10:52,241 - tool.dba - INFO - insert data with sql
2022-07-21 05:10:52,250 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 43.77it/s]
2022-07-21 05:10:52,274 - tool.dba - INFO - insert finish
2022-07-21 05:10:52,274 - tool.dba - INFO - Delete data with sql
2022-07-21 05:10:52,274 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-21 05:10:52,303 - tool.dba - INFO - Delete data finish
2022-07-21 05:10:52,336 - tool.dba - INFO - insert data with sql
2022-07-21 05:10:52,347 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 54.01it/s]
2022-07-21 05:10:52,366 - tool.dba - INFO - insert finish
2022-07-21 05:10:52,371 - tool.dba - INFO - Read data with sql
2022-07-21 05:10:52,371 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-21 05:10:53,576 - tool.dba - INFO - finish read total 169095 rows
2022-07-21 05:10:53,576 - tool.dba - INFO - Read data with sql
2022-07-21 05:10:53,576 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-21 05:11:11,481 - tool.dba - INFO - finish read total 97820 rows
2022-07-21 05:11:11,758 - tool.dba - INFO - Read data with sql
2022-07-21 05:11:11,759 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-21 05:11:22,703 - tool.dba - INFO - finish read total 930149 rows
2022-07-21 05:11:22,703 - tool.dba - INFO - Read data with sql
2022-07-21 05:11:22,703 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-21 05:11:30,742 - tool.dba - INFO - finish read total 1081599 rows
2022-07-21 05:11:30,742 - tool.dba - INFO - Read data with sql
2022-07-21 05:11:30,742 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-21 05:11:41,726 - tool.dba - INFO - finish read total 1258716 rows
2022-07-21 05:11:41,726 - tool.dba - INFO - Read data with sql
2022-07-21 05:11:41,726 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-21 05:11:49,110 - tool.dba - INFO - finish read total 1050279 rows
2022-07-21 05:11:49,111 - tool.dba - INFO - Read data with sql
2022-07-21 05:11:49,111 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-21 05:11:59,863 - tool.dba - INFO - finish read total 1434759 rows
2022-07-21 05:11:59,863 - tool.dba - INFO - Read data with sql
2022-07-21 05:11:59,863 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-21 05:12:08,215 - tool.dba - INFO - finish read total 1222476 rows
2022-07-21 05:12:37,724 - tool.dba - INFO - Read data with sql
2022-07-21 05:12:37,724 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-21 05:12:37,786 - tool.dba - INFO - finish read total 3249 rows
2022-07-21 05:12:41,141 - tool.dba - INFO - Delete data with sql
2022-07-21 05:12:41,292 - tool.dba - INFO - Create data with sql
2022-07-21 05:12:41,293 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint U20220721051241_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-21 05:12:41,323 - tool.dba - INFO - Read data with sql
2022-07-21 05:12:41,323 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 05:12:41,576 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 05:12:41,578 - tool.dba - INFO - create table finish
2022-07-21 05:12:41,578 - tool.dba - INFO - insert data with sql
2022-07-21 05:12:41,945 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:04,  6.93it/s]  7%|▋         | 2/29 [00:00<00:03,  7.18it/s] 10%|█         | 3/29 [00:00<00:03,  7.35it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.60it/s] 17%|█▋        | 5/29 [00:00<00:03,  7.44it/s] 21%|██        | 6/29 [00:00<00:03,  6.16it/s] 24%|██▍       | 7/29 [00:01<00:03,  6.20it/s] 28%|██▊       | 8/29 [00:01<00:03,  6.32it/s] 31%|███       | 9/29 [00:01<00:03,  6.03it/s] 34%|███▍      | 10/29 [00:01<00:03,  5.33it/s] 38%|███▊      | 11/29 [00:01<00:03,  5.85it/s] 41%|████▏     | 12/29 [00:01<00:02,  6.21it/s] 45%|████▍     | 13/29 [00:02<00:02,  6.59it/s] 48%|████▊     | 14/29 [00:02<00:02,  6.76it/s] 52%|█████▏    | 15/29 [00:02<00:02,  6.20it/s] 55%|█████▌    | 16/29 [00:02<00:02,  6.44it/s] 59%|█████▊    | 17/29 [00:02<00:01,  6.43it/s] 62%|██████▏   | 18/29 [00:02<00:01,  6.42it/s] 66%|██████▌   | 19/29 [00:02<00:01,  6.51it/s] 69%|██████▉   | 20/29 [00:03<00:01,  5.79it/s] 72%|███████▏  | 21/29 [00:03<00:01,  6.08it/s] 76%|███████▌  | 22/29 [00:03<00:01,  6.66it/s] 79%|███████▉  | 23/29 [00:03<00:00,  6.51it/s] 83%|████████▎ | 24/29 [00:03<00:00,  6.67it/s] 86%|████████▌ | 25/29 [00:03<00:00,  5.93it/s] 90%|████████▉ | 26/29 [00:04<00:00,  5.95it/s] 93%|█████████▎| 27/29 [00:04<00:00,  6.05it/s] 97%|█████████▋| 28/29 [00:04<00:00,  6.27it/s]100%|██████████| 29/29 [00:04<00:00,  5.99it/s]100%|██████████| 29/29 [00:04<00:00,  6.29it/s]
2022-07-21 05:12:46,554 - tool.dba - INFO - insert finish
2022-07-21 05:12:46,566 - tool.dba - INFO - Delete data with sql
2022-07-21 05:12:46,566 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-21 05:12:56,367 - tool.dba - INFO - Delete data finish
2022-07-21 05:12:56,534 - tool.dba - INFO - insert data with sql
2022-07-21 05:12:57,009 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:07,  3.87it/s]  7%|▋         | 2/29 [00:00<00:07,  3.75it/s] 10%|█         | 3/29 [00:00<00:06,  3.77it/s] 14%|█▍        | 4/29 [00:01<00:07,  3.35it/s] 17%|█▋        | 5/29 [00:04<00:31,  1.30s/it] 21%|██        | 6/29 [00:04<00:21,  1.05it/s] 24%|██▍       | 7/29 [00:04<00:16,  1.33it/s] 28%|██▊       | 8/29 [00:05<00:12,  1.64it/s] 31%|███       | 9/29 [00:05<00:10,  1.97it/s] 34%|███▍      | 10/29 [00:05<00:08,  2.17it/s] 38%|███▊      | 11/29 [00:06<00:07,  2.50it/s] 41%|████▏     | 12/29 [00:06<00:06,  2.80it/s] 45%|████▍     | 13/29 [00:06<00:05,  2.90it/s] 48%|████▊     | 14/29 [00:06<00:04,  3.11it/s] 52%|█████▏    | 15/29 [00:07<00:04,  3.17it/s] 55%|█████▌    | 16/29 [00:07<00:04,  2.94it/s] 59%|█████▊    | 17/29 [00:07<00:03,  3.10it/s] 62%|██████▏   | 18/29 [00:08<00:03,  3.21it/s] 66%|██████▌   | 19/29 [00:08<00:03,  3.05it/s] 69%|██████▉   | 20/29 [00:08<00:02,  3.20it/s] 72%|███████▏  | 21/29 [00:10<00:05,  1.42it/s] 76%|███████▌  | 22/29 [00:10<00:04,  1.73it/s] 79%|███████▉  | 23/29 [00:11<00:03,  2.00it/s] 83%|████████▎ | 24/29 [00:11<00:02,  2.30it/s] 86%|████████▌ | 25/29 [00:11<00:01,  2.53it/s] 90%|████████▉ | 26/29 [00:11<00:01,  2.63it/s] 93%|█████████▎| 27/29 [00:12<00:00,  2.80it/s] 97%|█████████▋| 28/29 [00:12<00:00,  2.94it/s]100%|██████████| 29/29 [00:12<00:00,  2.94it/s]100%|██████████| 29/29 [00:12<00:00,  2.25it/s]
2022-07-21 05:13:09,900 - tool.dba - INFO - insert finish
  Stopping...
2022-07-21 09:52:32.379 INFO    numexpr.utils: Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2022-07-21 09:52:32.379 INFO    numexpr.utils: NumExpr defaulting to 8 threads.
2022-07-21 09:52:33,545 - tool.dba - INFO - Read data with sql
2022-07-21 09:52:33,545 - tool.dba - INFO - SELECT * FROM CARVIEW
2022-07-21 09:52:33,548 - tool.dba - INFO - finish read total 3 rows
2022-07-21 09:52:33,666 - tool.dba - INFO - Read data with sql
2022-07-21 09:52:33,666 - tool.dba - INFO - SELECT * FROM all_tab_comments

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.10.201.176:8501

2022-07-21 09:52:33,941 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 09:52:33,942 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-21 09:52:33,942 - tool.dba - INFO - Read data with sql
2022-07-21 09:52:33,942 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-21 09:53:32,081 - tool.dba - INFO - finish read total 6470554 rows
2022-07-21 09:53:47,292 - tool.dba - INFO - Read data with sql
2022-07-21 09:53:47,292 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 09:53:47,547 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 09:53:47,547 - tool.dba - INFO - Read data with sql
2022-07-21 09:53:47,547 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-21 09:53:47,563 - tool.dba - INFO - finish read total 2557 rows
2022-07-21 09:56:27,932 - tool.dba - INFO - Read data with sql
2022-07-21 09:56:27,932 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 09:56:28,260 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 09:56:28,262 - tool.dba - INFO - Delete data with sql
2022-07-21 09:56:28,330 - tool.dba - INFO - Create data with sql
2022-07-21 09:56:28,331 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint L20220721095628_pk primary key (STORE_ID,DS)
        )
        
2022-07-21 09:56:28,359 - tool.dba - INFO - Read data with sql
2022-07-21 09:56:28,359 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 09:56:28,610 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 09:56:28,612 - tool.dba - INFO - create table finish
2022-07-21 09:56:28,612 - tool.dba - INFO - insert data with sql
2022-07-21 09:56:28,747 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  2%|▏         | 1/45 [00:00<00:04,  9.76it/s]  4%|▍         | 2/45 [00:00<00:04,  9.50it/s]  7%|▋         | 3/45 [00:00<00:04,  8.96it/s]  9%|▉         | 4/45 [00:00<00:05,  7.73it/s] 13%|█▎        | 6/45 [00:00<00:04,  9.24it/s] 18%|█▊        | 8/45 [00:00<00:03, 10.03it/s] 20%|██        | 9/45 [00:00<00:03,  9.19it/s] 24%|██▍       | 11/45 [00:01<00:03,  9.63it/s] 29%|██▉       | 13/45 [00:01<00:03, 10.10it/s] 31%|███       | 14/45 [00:01<00:03,  9.38it/s] 36%|███▌      | 16/45 [00:01<00:02, 10.00it/s] 38%|███▊      | 17/45 [00:01<00:02,  9.81it/s] 42%|████▏     | 19/45 [00:01<00:02,  9.54it/s] 47%|████▋     | 21/45 [00:02<00:02, 10.39it/s] 51%|█████     | 23/45 [00:02<00:02,  9.62it/s] 56%|█████▌    | 25/45 [00:02<00:01, 10.05it/s] 60%|██████    | 27/45 [00:02<00:01, 10.33it/s] 64%|██████▍   | 29/45 [00:02<00:01,  9.65it/s] 69%|██████▉   | 31/45 [00:03<00:01,  9.96it/s] 73%|███████▎  | 33/45 [00:03<00:01,  9.32it/s] 78%|███████▊  | 35/45 [00:03<00:01,  9.59it/s] 82%|████████▏ | 37/45 [00:03<00:00,  9.89it/s] 87%|████████▋ | 39/45 [00:04<00:00,  9.26it/s] 89%|████████▉ | 40/45 [00:04<00:00,  9.36it/s] 91%|█████████ | 41/45 [00:04<00:00,  9.38it/s] 93%|█████████▎| 42/45 [00:04<00:00,  8.42it/s] 98%|█████████▊| 44/45 [00:04<00:00,  9.17it/s]100%|██████████| 45/45 [00:04<00:00,  9.57it/s]
2022-07-21 09:56:33,448 - tool.dba - INFO - insert finish
2022-07-21 09:56:33,453 - tool.dba - INFO - Delete data with sql
2022-07-21 09:56:33,453 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-21 09:56:52,102 - tool.dba - INFO - Delete data finish
2022-07-21 09:56:52,202 - tool.dba - INFO - insert data with sql
2022-07-21 09:56:52,342 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:05,  8.01it/s]  7%|▋         | 3/45 [00:00<00:05,  8.28it/s]  9%|▉         | 4/45 [00:00<00:04,  8.33it/s] 11%|█         | 5/45 [00:00<00:04,  8.35it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.01it/s] 16%|█▌        | 7/45 [00:00<00:05,  7.26it/s] 18%|█▊        | 8/45 [00:01<00:04,  7.72it/s] 20%|██        | 9/45 [00:01<00:04,  8.03it/s] 22%|██▏       | 10/45 [00:01<00:04,  8.15it/s] 24%|██▍       | 11/45 [00:01<00:04,  8.38it/s] 27%|██▋       | 12/45 [00:01<00:04,  7.48it/s] 29%|██▉       | 13/45 [00:01<00:04,  7.77it/s] 31%|███       | 14/45 [00:01<00:03,  7.89it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.23it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.45it/s] 38%|███▊      | 17/45 [00:02<00:03,  7.76it/s] 40%|████      | 18/45 [00:02<00:03,  8.10it/s] 42%|████▏     | 19/45 [00:02<00:03,  8.31it/s] 44%|████▍     | 20/45 [00:02<00:02,  8.50it/s] 47%|████▋     | 21/45 [00:02<00:03,  7.33it/s] 49%|████▉     | 22/45 [00:02<00:02,  7.73it/s] 51%|█████     | 23/45 [00:02<00:02,  7.98it/s] 53%|█████▎    | 24/45 [00:02<00:02,  8.21it/s] 56%|█████▌    | 25/45 [00:03<00:02,  8.07it/s] 58%|█████▊    | 26/45 [00:03<00:02,  7.39it/s] 60%|██████    | 27/45 [00:03<00:02,  7.79it/s] 62%|██████▏   | 28/45 [00:03<00:02,  8.10it/s] 64%|██████▍   | 29/45 [00:03<00:02,  7.96it/s] 67%|██████▋   | 30/45 [00:03<00:01,  8.08it/s] 69%|██████▉   | 31/45 [00:05<00:09,  1.55it/s] 71%|███████   | 32/45 [00:05<00:06,  2.06it/s] 73%|███████▎  | 33/45 [00:05<00:04,  2.67it/s] 76%|███████▌  | 34/45 [00:05<00:03,  3.37it/s] 78%|███████▊  | 35/45 [00:06<00:02,  4.14it/s] 80%|████████  | 36/45 [00:06<00:01,  4.65it/s] 82%|████████▏ | 37/45 [00:06<00:01,  5.42it/s] 84%|████████▍ | 38/45 [00:06<00:01,  6.12it/s] 87%|████████▋ | 39/45 [00:06<00:00,  6.76it/s] 89%|████████▉ | 40/45 [00:06<00:00,  6.60it/s] 91%|█████████ | 41/45 [00:06<00:00,  7.15it/s] 93%|█████████▎| 42/45 [00:06<00:00,  7.57it/s] 96%|█████████▌| 43/45 [00:07<00:00,  7.88it/s] 98%|█████████▊| 44/45 [00:07<00:00,  8.19it/s]100%|██████████| 45/45 [00:07<00:00,  7.62it/s]100%|██████████| 45/45 [00:07<00:00,  6.13it/s]
2022-07-21 09:56:59,678 - tool.dba - INFO - insert finish
2022-07-21 09:56:59,738 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-21 09:56:59,739 - tool.dba - INFO - Read data with sql
2022-07-21 09:56:59,739 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-21 09:57:43,903 - tool.dba - INFO - finish read total 4776447 rows
2022-07-21 09:57:44,783 - tool.dba - INFO - Read data with sql
2022-07-21 09:57:44,783 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-21 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-21 09:58:14,489 - tool.dba - INFO - finish read total 3407645 rows
2022-07-21 09:58:15,407 - tool.dba - INFO - Read data with sql
2022-07-21 09:58:15,407 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-21 09:58:15,415 - tool.dba - INFO - finish read total 824 rows
2022-07-21 09:58:15,415 - tool.dba - INFO - Read data with sql
2022-07-21 09:58:15,415 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-21 09:58:15,439 - tool.dba - INFO - finish read total 5369 rows
2022-07-21 09:59:31,897 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:31,898 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 09:59:32,210 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 09:59:32,210 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:32,210 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-21 09:59:32,226 - tool.dba - INFO - finish read total 2557 rows
2022-07-21 09:59:44,377 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:44,377 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-21 09:59:44,406 - tool.dba - INFO - finish read total 5397 rows
2022-07-21 09:59:44,720 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:44,720 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 09:59:44,999 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 09:59:45,000 - tool.dba - INFO - Delete data with sql
2022-07-21 09:59:45,009 - tool.dba - INFO - Create data with sql
2022-07-21 09:59:45,009 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint E20220721095945_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-21 09:59:45,040 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:45,040 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 09:59:45,295 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 09:59:45,296 - tool.dba - INFO - create table finish
2022-07-21 09:59:45,296 - tool.dba - INFO - insert data with sql
2022-07-21 09:59:45,312 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 10.02it/s]
2022-07-21 09:59:45,412 - tool.dba - INFO - insert finish
2022-07-21 09:59:45,414 - tool.dba - INFO - Delete data with sql
2022-07-21 09:59:45,414 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-21 09:59:45,653 - tool.dba - INFO - Delete data finish
2022-07-21 09:59:45,720 - tool.dba - INFO - insert data with sql
2022-07-21 09:59:45,745 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.86it/s]100%|██████████| 1/1 [00:00<00:00,  4.85it/s]
2022-07-21 09:59:45,952 - tool.dba - INFO - insert finish
2022-07-21 09:59:45,967 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:45,967 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-21 09:59:59,378 - tool.dba - INFO - finish read total 12149 rows
2022-07-21 09:59:59,581 - tool.dba - INFO - Read data with sql
2022-07-21 09:59:59,581 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-21 10:01:55,608 - tool.dba - INFO - finish read total 5949719 rows
2022-07-21 10:02:07,670 - tool.dba - INFO - Read data with sql
2022-07-21 10:02:07,670 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 10:02:07,932 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 10:02:07,932 - tool.dba - INFO - Read data with sql
2022-07-21 10:02:07,932 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-21 10:02:07,948 - tool.dba - INFO - finish read total 2557 rows
2022-07-21 10:04:08,464 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:08,465 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 10:04:08,734 - tool.dba - INFO - finish read total 8007 rows
2022-07-21 10:04:08,735 - tool.dba - INFO - Delete data with sql
2022-07-21 10:04:08,740 - tool.dba - INFO - Create data with sql
2022-07-21 10:04:08,741 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint J20220721100408_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-21 10:04:08,770 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:08,770 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 10:04:09,039 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 10:04:09,040 - tool.dba - INFO - create table finish
2022-07-21 10:04:09,040 - tool.dba - INFO - insert data with sql
2022-07-21 10:04:09,048 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 40.10it/s]
2022-07-21 10:04:09,074 - tool.dba - INFO - insert finish
2022-07-21 10:04:09,074 - tool.dba - INFO - Delete data with sql
2022-07-21 10:04:09,075 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-21 10:04:09,107 - tool.dba - INFO - Delete data finish
2022-07-21 10:04:09,146 - tool.dba - INFO - insert data with sql
2022-07-21 10:04:09,157 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 48.60it/s]
2022-07-21 10:04:09,178 - tool.dba - INFO - insert finish
2022-07-21 10:04:09,185 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:09,185 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-21 10:04:10,378 - tool.dba - INFO - finish read total 169191 rows
2022-07-21 10:04:10,378 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:10,378 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-21 10:04:20,043 - tool.dba - INFO - finish read total 101575 rows
2022-07-21 10:04:20,317 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:20,317 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-21 10:04:32,067 - tool.dba - INFO - finish read total 933056 rows
2022-07-21 10:04:32,067 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:32,067 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-21 10:04:43,142 - tool.dba - INFO - finish read total 1084506 rows
2022-07-21 10:04:43,142 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:43,142 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-21 10:04:56,397 - tool.dba - INFO - finish read total 1258716 rows
2022-07-21 10:04:56,397 - tool.dba - INFO - Read data with sql
2022-07-21 10:04:56,397 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-21 10:05:06,830 - tool.dba - INFO - finish read total 1250037 rows
2022-07-21 10:05:06,830 - tool.dba - INFO - Read data with sql
2022-07-21 10:05:06,830 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-21 10:05:21,065 - tool.dba - INFO - finish read total 1434759 rows
2022-07-21 10:05:21,065 - tool.dba - INFO - Read data with sql
2022-07-21 10:05:21,065 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-21 10:05:33,889 - tool.dba - INFO - finish read total 1422234 rows
2022-07-21 10:06:04,396 - tool.dba - INFO - Read data with sql
2022-07-21 10:06:04,397 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-21 10:06:04,421 - tool.dba - INFO - finish read total 3249 rows
2022-07-21 10:06:07,905 - tool.dba - INFO - Delete data with sql
2022-07-21 10:06:08,063 - tool.dba - INFO - Create data with sql
2022-07-21 10:06:08,064 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint V20220721100608_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-21 10:06:08,096 - tool.dba - INFO - Read data with sql
2022-07-21 10:06:08,096 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-21 10:06:08,366 - tool.dba - INFO - finish read total 8008 rows
2022-07-21 10:06:08,368 - tool.dba - INFO - create table finish
2022-07-21 10:06:08,368 - tool.dba - INFO - insert data with sql
2022-07-21 10:06:08,755 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:03,  8.31it/s]  6%|▋         | 2/31 [00:00<00:03,  7.83it/s] 10%|▉         | 3/31 [00:00<00:03,  7.56it/s] 13%|█▎        | 4/31 [00:00<00:03,  7.47it/s] 16%|█▌        | 5/31 [00:00<00:03,  6.51it/s] 19%|█▉        | 6/31 [00:00<00:03,  6.66it/s] 23%|██▎       | 7/31 [00:01<00:03,  6.64it/s] 26%|██▌       | 8/31 [00:01<00:03,  6.75it/s] 29%|██▉       | 9/31 [00:01<00:03,  6.78it/s] 32%|███▏      | 10/31 [00:01<00:03,  6.13it/s] 35%|███▌      | 11/31 [00:01<00:03,  6.56it/s] 39%|███▊      | 12/31 [00:01<00:02,  6.87it/s] 45%|████▌     | 14/31 [00:02<00:02,  7.33it/s] 48%|████▊     | 15/31 [00:02<00:02,  6.82it/s] 52%|█████▏    | 16/31 [00:02<00:02,  6.93it/s] 55%|█████▍    | 17/31 [00:02<00:02,  6.94it/s] 58%|█████▊    | 18/31 [00:02<00:01,  6.93it/s] 61%|██████▏   | 19/31 [00:02<00:01,  6.13it/s] 65%|██████▍   | 20/31 [00:02<00:01,  6.20it/s] 68%|██████▊   | 21/31 [00:03<00:01,  6.16it/s] 71%|███████   | 22/31 [00:03<00:01,  6.52it/s] 74%|███████▍  | 23/31 [00:03<00:01,  6.65it/s] 77%|███████▋  | 24/31 [00:03<00:01,  6.20it/s] 81%|████████  | 25/31 [00:03<00:00,  6.56it/s] 84%|████████▍ | 26/31 [00:03<00:00,  6.57it/s] 87%|████████▋ | 27/31 [00:04<00:01,  3.76it/s] 90%|█████████ | 28/31 [00:04<00:00,  4.35it/s] 94%|█████████▎| 29/31 [00:04<00:00,  4.45it/s] 97%|█████████▋| 30/31 [00:04<00:00,  4.92it/s]100%|██████████| 31/31 [00:04<00:00,  6.20it/s]
2022-07-21 10:06:13,754 - tool.dba - INFO - insert finish
2022-07-21 10:06:13,766 - tool.dba - INFO - Delete data with sql
2022-07-21 10:06:13,766 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-21 10:06:30,188 - tool.dba - INFO - Delete data finish
2022-07-21 10:06:30,242 - tool.dba - INFO - insert data with sql
2022-07-21 10:06:30,733 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/31 [00:00<?, ?it/s]  3%|▎         | 1/31 [00:00<00:08,  3.67it/s]  6%|▋         | 2/31 [00:00<00:08,  3.25it/s] 10%|▉         | 3/31 [00:00<00:08,  3.45it/s] 13%|█▎        | 4/31 [00:01<00:07,  3.59it/s] 16%|█▌        | 5/31 [00:01<00:06,  3.81it/s] 19%|█▉        | 6/31 [00:01<00:07,  3.41it/s] 23%|██▎       | 7/31 [00:02<00:07,  3.41it/s] 26%|██▌       | 8/31 [00:02<00:06,  3.43it/s] 29%|██▉       | 9/31 [00:02<00:06,  3.19it/s] 32%|███▏      | 10/31 [00:02<00:06,  3.23it/s] 35%|███▌      | 11/31 [00:03<00:05,  3.37it/s] 39%|███▊      | 12/31 [00:03<00:05,  3.28it/s] 42%|████▏     | 13/31 [00:03<00:05,  3.44it/s] 45%|████▌     | 14/31 [00:05<00:11,  1.48it/s] 48%|████▊     | 15/31 [00:05<00:08,  1.78it/s] 52%|█████▏    | 16/31 [00:05<00:07,  2.09it/s] 55%|█████▍    | 17/31 [00:06<00:05,  2.38it/s] 58%|█████▊    | 18/31 [00:06<00:05,  2.53it/s] 61%|██████▏   | 19/31 [00:06<00:04,  2.76it/s] 65%|██████▍   | 20/31 [00:07<00:03,  2.92it/s] 68%|██████▊   | 21/31 [00:07<00:03,  2.92it/s] 71%|███████   | 22/31 [00:07<00:02,  3.12it/s] 74%|███████▍  | 23/31 [00:08<00:02,  3.33it/s] 77%|███████▋  | 24/31 [00:08<00:02,  3.43it/s] 81%|████████  | 25/31 [00:08<00:01,  3.34it/s] 84%|████████▍ | 26/31 [00:08<00:01,  3.43it/s] 87%|████████▋ | 27/31 [00:09<00:01,  3.50it/s] 90%|█████████ | 28/31 [00:09<00:00,  3.30it/s] 94%|█████████▎| 29/31 [00:11<00:01,  1.24it/s] 97%|█████████▋| 30/31 [00:11<00:00,  1.53it/s]100%|██████████| 31/31 [00:11<00:00,  2.03it/s]100%|██████████| 31/31 [00:11<00:00,  2.60it/s]
2022-07-21 10:06:42,643 - tool.dba - INFO - insert finish
2022-07-21 18:56:55.999 Read data with sql
2022-07-21 18:56:56.000 SELECT * FROM all_tab_comments
2022-07-21 18:56:56.591 finish read total 9372 rows
2022-07-21 18:56:56.629 Read data with sql
2022-07-21 18:56:56.629 SELECT * FROM all_tab_comments
2022-07-21 18:56:56.918 finish read total 8007 rows
2022-07-21 18:56:56.929 Read data with sql
2022-07-21 18:56:56.930 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 18:57:00.710 finish read total 96001 rows
/home/zyuser/anaconda3/lib/python3.9/site-packages/xlsxwriter/workbook.py:338: UserWarning: Calling close() on already closed file.
  warn("Calling close() on already closed file.")
/home/zyuser/anaconda3/lib/python3.9/site-packages/pandas/core/generic.py:4150: PerformanceWarning: dropping on a non-lexsorted multi-index without a level parameter may impact performance.
  obj = obj._drop_axis(labels, axis, level=level, errors=errors)
2022-07-21 18:57:04.095 Read data with sql
2022-07-21 18:57:04.095 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 18:57:05.390 finish read total 96005 rows
2022-07-21 18:57:05.883 Read data with sql
2022-07-21 18:57:05.883 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 18:57:07.153 finish read total 96233 rows
2022-07-21 18:57:07.983 InMemoryFileManager: Missing file ea206d3251226bbe85f885452627e292f29c3583940cacb23c90b1eb.bin
2022-07-21 18:58:42.168 Read data with sql
2022-07-21 18:58:42.168 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 18:58:43.439 finish read total 97105 rows
2022-07-21 18:58:45.851 Read data with sql
2022-07-21 18:58:45.851 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 18:58:47.294 finish read total 97105 rows
2022-07-21 18:58:47.508 Read data with sql
2022-07-21 18:58:47.509 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 18:58:48.768 finish read total 97387 rows
2022-07-21 18:58:49.243 InMemoryFileManager: Missing file b60b752781985fcdb49ab945e6067bdae5af286727447e80b28dac2b.bin
2022-07-21 19:00:38.522 Read data with sql
2022-07-21 19:00:38.522 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:00:40.001 finish read total 98027 rows
2022-07-21 19:00:42.196 Read data with sql
2022-07-21 19:00:42.196 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:00:43.674 finish read total 98027 rows
2022-07-21 19:00:43.891 Read data with sql
2022-07-21 19:00:43.891 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:00:45.332 finish read total 98027 rows
2022-07-21 19:00:46.747 Read data with sql
2022-07-21 19:00:46.747 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:00:48.260 finish read total 98027 rows
2022-07-21 19:02:44.843 Read data with sql
2022-07-21 19:02:44.843 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:02:46.118 finish read total 98543 rows
2022-07-21 19:02:47.626 Read data with sql
2022-07-21 19:02:47.626 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:02:49.056 finish read total 98543 rows
2022-07-21 19:02:49.269 Read data with sql
2022-07-21 19:02:49.269 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:02:50.697 finish read total 98543 rows
2022-07-21 19:02:52.614 Read data with sql
2022-07-21 19:02:52.615 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:02:53.887 finish read total 98603 rows
2022-07-21 19:03:18.041 Read data with sql
2022-07-21 19:03:18.041 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:03:19.311 finish read total 98603 rows
2022-07-21 19:03:19.524 Read data with sql
2022-07-21 19:03:19.525 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:03:20.792 finish read total 98603 rows
2022-07-21 19:03:21.008 Read data with sql
2022-07-21 19:03:21.008 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:03:22.331 finish read total 98603 rows
2022-07-21 19:03:23.910 Read data with sql
2022-07-21 19:03:23.910 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:03:25.354 finish read total 98603 rows
2022-07-21 19:04:35.411 Read data with sql
2022-07-21 19:04:35.411 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:04:36.722 finish read total 98701 rows
2022-07-21 19:04:38.382 Read data with sql
2022-07-21 19:04:38.382 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:04:39.700 finish read total 98701 rows
2022-07-21 19:10:45.294 Read data with sql
2022-07-21 19:10:45.295 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:10:46.602 finish read total 99686 rows
2022-07-21 19:10:46.822 Read data with sql
2022-07-21 19:10:46.822 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:10:48.100 finish read total 99686 rows
2022-07-21 19:10:51.541 Read data with sql
2022-07-21 19:10:51.542 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 19:10:52.813 finish read total 99686 rows
2022-07-21 20:06:11.052 Read data with sql
2022-07-21 20:06:11.052 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 20:06:12.721 finish read total 113618 rows
2022-07-21 20:06:18.790 Read data with sql
2022-07-21 20:06:18.790 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 20:06:20.578 finish read total 113720 rows
2022-07-21 23:46:49.964 Read data with sql
2022-07-21 23:46:49.964 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:46:54.550 finish read total 121996 rows
2022-07-21 23:46:54.657 Read data with sql
2022-07-21 23:46:54.657 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:46:56.947 finish read total 121996 rows
2022-07-21 23:46:59.216 Read data with sql
2022-07-21 23:46:59.216 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:47:01.049 finish read total 121996 rows
2022-07-21 23:47:05.718 Read data with sql
2022-07-21 23:47:05.719 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:47:07.572 finish read total 121996 rows
2022-07-21 23:50:30.820 Read data with sql
2022-07-21 23:50:30.820 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:50:32.444 finish read total 121996 rows
2022-07-21 23:50:39.004 Read data with sql
2022-07-21 23:50:39.004 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:50:40.838 finish read total 121996 rows
2022-07-21 23:50:41.309 Read data with sql
2022-07-21 23:50:41.309 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:50:43.085 finish read total 121996 rows
2022-07-21 23:51:04.354 Read data with sql
2022-07-21 23:51:04.354 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:51:06.029 finish read total 121996 rows
2022-07-21 23:51:12.651 Read data with sql
2022-07-21 23:51:12.652 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:51:14.496 finish read total 121996 rows
2022-07-21 23:51:17.201 Read data with sql
2022-07-21 23:51:17.201 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-21 23:51:19.043 finish read total 121996 rows
2022-07-22 05:00:00,567 - tool.dba - INFO - Read data with sql
2022-07-22 05:00:00,567 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:00:00,922 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:00:00,923 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-22 05:00:00,923 - tool.dba - INFO - Read data with sql
2022-07-22 05:00:00,924 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-22 05:01:00,141 - tool.dba - INFO - finish read total 6475642 rows
2022-07-22 05:01:15,144 - tool.dba - INFO - Read data with sql
2022-07-22 05:01:15,145 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:01:15,427 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:01:15,427 - tool.dba - INFO - Read data with sql
2022-07-22 05:01:15,427 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-22 05:01:15,443 - tool.dba - INFO - finish read total 2557 rows
2022-07-22 05:03:54,075 - tool.dba - INFO - Read data with sql
2022-07-22 05:03:54,075 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:03:54,328 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:03:54,329 - tool.dba - INFO - Delete data with sql
2022-07-22 05:03:54,387 - tool.dba - INFO - Create data with sql
2022-07-22 05:03:54,387 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint D20220722050354_pk primary key (STORE_ID,DS)
        )
        
2022-07-22 05:03:54,415 - tool.dba - INFO - Read data with sql
2022-07-22 05:03:54,415 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:03:54,650 - tool.dba - INFO - finish read total 8008 rows
2022-07-22 05:03:54,651 - tool.dba - INFO - create table finish
2022-07-22 05:03:54,652 - tool.dba - INFO - insert data with sql
2022-07-22 05:03:54,783 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:04, 10.55it/s]  9%|▉         | 4/45 [00:00<00:04,  8.89it/s] 13%|█▎        | 6/45 [00:00<00:04,  9.56it/s] 18%|█▊        | 8/45 [00:00<00:03, 10.23it/s] 22%|██▏       | 10/45 [00:01<00:03,  9.50it/s] 27%|██▋       | 12/45 [00:01<00:03,  9.84it/s] 29%|██▉       | 13/45 [00:01<00:03,  9.80it/s] 31%|███       | 14/45 [00:01<00:03,  8.92it/s] 36%|███▌      | 16/45 [00:01<00:03,  9.44it/s] 40%|████      | 18/45 [00:01<00:02,  9.78it/s] 42%|████▏     | 19/45 [00:02<00:02,  9.02it/s] 47%|████▋     | 21/45 [00:02<00:02,  9.64it/s] 51%|█████     | 23/45 [00:02<00:02,  9.15it/s] 56%|█████▌    | 25/45 [00:02<00:02,  9.53it/s] 60%|██████    | 27/45 [00:02<00:01,  9.70it/s] 62%|██████▏   | 28/45 [00:02<00:01,  8.95it/s] 67%|██████▋   | 30/45 [00:03<00:01,  9.42it/s] 71%|███████   | 32/45 [00:03<00:01,  9.72it/s] 73%|███████▎  | 33/45 [00:03<00:01,  8.99it/s] 76%|███████▌  | 34/45 [00:03<00:01,  9.15it/s] 80%|████████  | 36/45 [00:03<00:00,  9.59it/s] 84%|████████▍ | 38/45 [00:04<00:00,  9.04it/s] 87%|████████▋ | 39/45 [00:04<00:00,  8.86it/s] 89%|████████▉ | 40/45 [00:04<00:00,  8.93it/s] 93%|█████████▎| 42/45 [00:04<00:00,  8.68it/s] 98%|█████████▊| 44/45 [00:04<00:00,  9.27it/s]100%|██████████| 45/45 [00:04<00:00,  9.39it/s]
2022-07-22 05:03:59,575 - tool.dba - INFO - insert finish
2022-07-22 05:03:59,580 - tool.dba - INFO - Delete data with sql
2022-07-22 05:03:59,580 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-22 05:04:19,564 - tool.dba - INFO - Delete data finish
2022-07-22 05:04:19,614 - tool.dba - INFO - insert data with sql
2022-07-22 05:04:19,757 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/45 [00:00<?, ?it/s]  4%|▍         | 2/45 [00:00<00:05,  7.93it/s]  7%|▋         | 3/45 [00:00<00:05,  8.32it/s]  9%|▉         | 4/45 [00:00<00:04,  8.20it/s] 11%|█         | 5/45 [00:00<00:04,  8.34it/s] 13%|█▎        | 6/45 [00:00<00:04,  8.18it/s] 16%|█▌        | 7/45 [00:00<00:05,  6.86it/s] 18%|█▊        | 8/45 [00:01<00:05,  7.18it/s] 20%|██        | 9/45 [00:01<00:04,  7.58it/s] 22%|██▏       | 10/45 [00:01<00:04,  7.93it/s] 24%|██▍       | 11/45 [00:01<00:04,  8.28it/s] 27%|██▋       | 12/45 [00:01<00:04,  7.51it/s] 29%|██▉       | 13/45 [00:01<00:04,  7.90it/s] 31%|███       | 14/45 [00:01<00:03,  8.22it/s] 33%|███▎      | 15/45 [00:01<00:03,  8.42it/s] 36%|███▌      | 16/45 [00:01<00:03,  8.57it/s] 38%|███▊      | 17/45 [00:02<00:03,  7.79it/s] 40%|████      | 18/45 [00:02<00:03,  8.07it/s] 42%|████▏     | 19/45 [00:02<00:03,  8.28it/s] 44%|████▍     | 20/45 [00:02<00:02,  8.44it/s] 47%|████▋     | 21/45 [00:02<00:03,  7.54it/s] 49%|████▉     | 22/45 [00:02<00:02,  7.94it/s] 51%|█████     | 23/45 [00:02<00:02,  8.25it/s] 53%|█████▎    | 24/45 [00:02<00:02,  8.49it/s] 56%|█████▌    | 25/45 [00:03<00:02,  8.62it/s] 58%|█████▊    | 26/45 [00:03<00:02,  8.04it/s] 60%|██████    | 27/45 [00:03<00:02,  8.34it/s] 62%|██████▏   | 28/45 [00:03<00:02,  8.45it/s] 64%|██████▍   | 29/45 [00:03<00:01,  8.50it/s] 67%|██████▋   | 30/45 [00:03<00:01,  8.63it/s] 69%|██████▉   | 31/45 [00:05<00:08,  1.56it/s] 71%|███████   | 32/45 [00:05<00:06,  2.07it/s] 73%|███████▎  | 33/45 [00:05<00:04,  2.68it/s] 76%|███████▌  | 34/45 [00:05<00:03,  3.37it/s] 78%|███████▊  | 35/45 [00:06<00:02,  4.12it/s] 80%|████████  | 36/45 [00:06<00:01,  4.61it/s] 82%|████████▏ | 37/45 [00:06<00:01,  5.41it/s] 84%|████████▍ | 38/45 [00:06<00:01,  6.12it/s] 87%|████████▋ | 39/45 [00:06<00:00,  6.68it/s] 89%|████████▉ | 40/45 [00:06<00:00,  6.40it/s] 91%|█████████ | 41/45 [00:06<00:00,  6.98it/s] 93%|█████████▎| 42/45 [00:06<00:00,  7.39it/s] 96%|█████████▌| 43/45 [00:07<00:00,  7.76it/s] 98%|█████████▊| 44/45 [00:07<00:00,  7.96it/s]100%|██████████| 45/45 [00:07<00:00,  7.32it/s]100%|██████████| 45/45 [00:07<00:00,  6.14it/s]
2022-07-22 05:04:27,081 - tool.dba - INFO - insert finish
2022-07-22 05:04:27,134 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-22 05:04:27,136 - tool.dba - INFO - Read data with sql
2022-07-22 05:04:27,136 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-22 05:05:13,353 - tool.dba - INFO - finish read total 4776447 rows
2022-07-22 05:05:14,220 - tool.dba - INFO - Read data with sql
2022-07-22 05:05:14,220 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-22 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-22 05:05:46,168 - tool.dba - INFO - finish read total 3407645 rows
2022-07-22 05:05:47,090 - tool.dba - INFO - Read data with sql
2022-07-22 05:05:47,090 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-22 05:05:47,099 - tool.dba - INFO - finish read total 824 rows
2022-07-22 05:05:47,099 - tool.dba - INFO - Read data with sql
2022-07-22 05:05:47,099 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-22 05:05:47,121 - tool.dba - INFO - finish read total 5374 rows
2022-07-22 05:07:01,310 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:01,310 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:07:01,574 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:07:01,574 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:01,574 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-22 05:07:01,591 - tool.dba - INFO - finish read total 2557 rows
2022-07-22 05:07:13,443 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:13,443 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-22 05:07:13,483 - tool.dba - INFO - finish read total 5416 rows
2022-07-22 05:07:13,794 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:13,795 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:07:14,055 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:07:14,056 - tool.dba - INFO - Delete data with sql
2022-07-22 05:07:14,064 - tool.dba - INFO - Create data with sql
2022-07-22 05:07:14,064 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint H20220722050714_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-22 05:07:14,091 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:14,091 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:07:14,322 - tool.dba - INFO - finish read total 8008 rows
2022-07-22 05:07:14,323 - tool.dba - INFO - create table finish
2022-07-22 05:07:14,323 - tool.dba - INFO - insert data with sql
2022-07-22 05:07:14,340 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 10.79it/s]
2022-07-22 05:07:14,433 - tool.dba - INFO - insert finish
2022-07-22 05:07:14,435 - tool.dba - INFO - Delete data with sql
2022-07-22 05:07:14,435 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-22 05:07:14,647 - tool.dba - INFO - Delete data finish
2022-07-22 05:07:14,721 - tool.dba - INFO - insert data with sql
2022-07-22 05:07:14,746 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.66it/s]100%|██████████| 1/1 [00:00<00:00,  5.64it/s]
2022-07-22 05:07:14,924 - tool.dba - INFO - insert finish
2022-07-22 05:07:14,938 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:14,939 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-22 05:07:27,742 - tool.dba - INFO - finish read total 12158 rows
2022-07-22 05:07:27,944 - tool.dba - INFO - Read data with sql
2022-07-22 05:07:27,944 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-22 05:09:21,279 - tool.dba - INFO - finish read total 5953783 rows
2022-07-22 05:09:33,268 - tool.dba - INFO - Read data with sql
2022-07-22 05:09:33,268 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:09:33,541 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:09:33,541 - tool.dba - INFO - Read data with sql
2022-07-22 05:09:33,541 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-22 05:09:33,556 - tool.dba - INFO - finish read total 2557 rows
2022-07-22 05:11:21,272 - tool.dba - INFO - Read data with sql
2022-07-22 05:11:21,272 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:11:21,533 - tool.dba - INFO - finish read total 8007 rows
2022-07-22 05:11:21,534 - tool.dba - INFO - Delete data with sql
2022-07-22 05:11:21,539 - tool.dba - INFO - Create data with sql
2022-07-22 05:11:21,540 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint V20220722051121_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-22 05:11:21,578 - tool.dba - INFO - Read data with sql
2022-07-22 05:11:21,578 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:11:21,803 - tool.dba - INFO - finish read total 8008 rows
2022-07-22 05:11:21,804 - tool.dba - INFO - create table finish
2022-07-22 05:11:21,805 - tool.dba - INFO - insert data with sql
2022-07-22 05:11:21,813 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 47.78it/s]
2022-07-22 05:11:21,835 - tool.dba - INFO - insert finish
2022-07-22 05:11:21,835 - tool.dba - INFO - Delete data with sql
2022-07-22 05:11:21,835 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-22 05:11:21,863 - tool.dba - INFO - Delete data finish
2022-07-22 05:11:21,895 - tool.dba - INFO - insert data with sql
2022-07-22 05:11:21,906 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 67.41it/s]
2022-07-22 05:11:21,922 - tool.dba - INFO - insert finish
2022-07-22 05:11:21,926 - tool.dba - INFO - Read data with sql
2022-07-22 05:11:21,926 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-22 05:11:23,054 - tool.dba - INFO - finish read total 169180 rows
2022-07-22 05:11:23,055 - tool.dba - INFO - Read data with sql
2022-07-22 05:11:23,055 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-22 05:11:39,846 - tool.dba - INFO - finish read total 97894 rows
2022-07-22 05:11:40,117 - tool.dba - INFO - Read data with sql
2022-07-22 05:11:40,117 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-22 05:11:52,585 - tool.dba - INFO - finish read total 935055 rows
2022-07-22 05:11:52,585 - tool.dba - INFO - Read data with sql
2022-07-22 05:11:52,585 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-22 05:12:03,435 - tool.dba - INFO - finish read total 1088927 rows
2022-07-22 05:12:03,435 - tool.dba - INFO - Read data with sql
2022-07-22 05:12:03,435 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-22 05:12:16,492 - tool.dba - INFO - finish read total 1252369 rows
2022-07-22 05:12:16,492 - tool.dba - INFO - Read data with sql
2022-07-22 05:12:16,492 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-22 05:12:25,823 - tool.dba - INFO - finish read total 1035773 rows
2022-07-22 05:12:25,823 - tool.dba - INFO - Read data with sql
2022-07-22 05:12:25,823 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-22 05:12:39,711 - tool.dba - INFO - finish read total 1436627 rows
2022-07-22 05:12:39,711 - tool.dba - INFO - Read data with sql
2022-07-22 05:12:39,711 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-22 05:12:50,156 - tool.dba - INFO - finish read total 1216323 rows
2022-07-22 05:13:19,856 - tool.dba - INFO - Read data with sql
2022-07-22 05:13:19,856 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-22 05:13:19,880 - tool.dba - INFO - finish read total 3249 rows
2022-07-22 05:13:23,346 - tool.dba - INFO - Delete data with sql
2022-07-22 05:13:23,504 - tool.dba - INFO - Create data with sql
2022-07-22 05:13:23,504 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint F20220722051323_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-22 05:13:23,532 - tool.dba - INFO - Read data with sql
2022-07-22 05:13:23,533 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-22 05:13:23,762 - tool.dba - INFO - finish read total 8008 rows
2022-07-22 05:13:23,763 - tool.dba - INFO - create table finish
2022-07-22 05:13:23,763 - tool.dba - INFO - insert data with sql
2022-07-22 05:13:24,135 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.94it/s]  7%|▋         | 2/30 [00:00<00:03,  7.72it/s] 10%|█         | 3/30 [00:00<00:03,  7.61it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.67it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.54it/s] 20%|██        | 6/30 [00:00<00:03,  6.43it/s] 23%|██▎       | 7/30 [00:01<00:03,  6.60it/s] 27%|██▋       | 8/30 [00:01<00:03,  6.65it/s] 30%|███       | 9/30 [00:01<00:03,  6.66it/s] 33%|███▎      | 10/30 [00:01<00:03,  6.03it/s] 37%|███▋      | 11/30 [00:01<00:02,  6.50it/s] 40%|████      | 12/30 [00:01<00:02,  6.88it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.07it/s] 47%|████▋     | 14/30 [00:02<00:02,  7.26it/s] 50%|█████     | 15/30 [00:02<00:02,  6.57it/s] 53%|█████▎    | 16/30 [00:02<00:02,  6.75it/s] 57%|█████▋    | 17/30 [00:02<00:01,  6.72it/s] 60%|██████    | 18/30 [00:02<00:01,  6.90it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.68it/s] 67%|██████▋   | 20/30 [00:02<00:01,  6.41it/s] 70%|███████   | 21/30 [00:03<00:01,  7.12it/s] 73%|███████▎  | 22/30 [00:03<00:01,  7.31it/s] 77%|███████▋  | 23/30 [00:03<00:00,  7.50it/s] 80%|████████  | 24/30 [00:03<00:00,  7.42it/s] 83%|████████▎ | 25/30 [00:03<00:00,  6.55it/s] 87%|████████▋ | 26/30 [00:03<00:00,  6.34it/s] 90%|█████████ | 27/30 [00:03<00:00,  6.50it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.19it/s] 97%|█████████▋| 29/30 [00:04<00:00,  5.71it/s]100%|██████████| 30/30 [00:04<00:00,  6.88it/s]
2022-07-22 05:13:28,498 - tool.dba - INFO - insert finish
2022-07-22 05:13:28,509 - tool.dba - INFO - Delete data with sql
2022-07-22 05:13:28,509 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-22 05:13:42,163 - tool.dba - INFO - Delete data finish
2022-07-22 05:13:42,213 - tool.dba - INFO - insert data with sql
2022-07-22 05:13:42,687 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  3.93it/s]  7%|▋         | 2/30 [00:00<00:07,  3.71it/s] 10%|█         | 3/30 [00:00<00:07,  3.75it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.48it/s] 17%|█▋        | 5/30 [00:01<00:07,  3.57it/s] 20%|██        | 6/30 [00:01<00:06,  3.62it/s] 23%|██▎       | 7/30 [00:01<00:06,  3.41it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.49it/s] 30%|███       | 9/30 [00:02<00:05,  3.53it/s] 33%|███▎      | 10/30 [00:02<00:06,  3.28it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.41it/s] 40%|████      | 12/30 [00:03<00:05,  3.50it/s] 43%|████▎     | 13/30 [00:03<00:05,  3.38it/s] 47%|████▋     | 14/30 [00:05<00:10,  1.55it/s] 50%|█████     | 15/30 [00:05<00:08,  1.87it/s] 53%|█████▎    | 16/30 [00:05<00:06,  2.15it/s] 57%|█████▋    | 17/30 [00:06<00:05,  2.50it/s] 60%|██████    | 18/30 [00:06<00:04,  2.73it/s] 63%|██████▎   | 19/30 [00:06<00:04,  2.73it/s] 67%|██████▋   | 20/30 [00:06<00:03,  2.93it/s] 70%|███████   | 21/30 [00:07<00:02,  3.12it/s] 73%|███████▎  | 22/30 [00:07<00:02,  3.13it/s] 77%|███████▋  | 23/30 [00:07<00:02,  3.07it/s] 80%|████████  | 24/30 [00:08<00:01,  3.24it/s] 83%|████████▎ | 25/30 [00:08<00:01,  3.30it/s] 87%|████████▋ | 26/30 [00:08<00:01,  3.19it/s] 90%|█████████ | 27/30 [00:09<00:00,  3.25it/s] 93%|█████████▎| 28/30 [00:09<00:00,  3.32it/s] 97%|█████████▋| 29/30 [00:09<00:00,  3.17it/s]100%|██████████| 30/30 [00:09<00:00,  3.08it/s]
2022-07-22 05:13:52,435 - tool.dba - INFO - insert finish
2022-07-22 05:57:24.564 Read data with sql
2022-07-22 05:57:24.565 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-22 05:57:26.256 finish read total 28881 rows
2022-07-22 05:57:28.511 Read data with sql
2022-07-22 05:57:28.511 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-22 05:57:28.901 finish read total 28881 rows
2022-07-22 05:57:31.045 Read data with sql
2022-07-22 05:57:31.046 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-22 05:57:31.437 finish read total 28881 rows
2022-07-22 20:33:27.961 Read data with sql
2022-07-22 20:33:27.961 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-22 20:33:32.014 finish read total 131789 rows
2022-07-22 20:33:47.555 Read data with sql
2022-07-22 20:33:47.555 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-22 20:33:49.321 finish read total 131789 rows
2022-07-23 05:00:00,293 - tool.dba - INFO - Read data with sql
2022-07-23 05:00:00,293 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:00:00,596 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:00:00,597 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-23 05:00:00,597 - tool.dba - INFO - Read data with sql
2022-07-23 05:00:00,597 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-23 05:00:59,785 - tool.dba - INFO - finish read total 6480776 rows
2022-07-23 05:01:14,868 - tool.dba - INFO - Read data with sql
2022-07-23 05:01:14,868 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:01:15,101 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:01:15,101 - tool.dba - INFO - Read data with sql
2022-07-23 05:01:15,101 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-23 05:01:15,117 - tool.dba - INFO - finish read total 2557 rows
2022-07-23 05:03:54,279 - tool.dba - INFO - Read data with sql
2022-07-23 05:03:54,279 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:03:54,537 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:03:54,538 - tool.dba - INFO - Delete data with sql
2022-07-23 05:03:54,599 - tool.dba - INFO - Create data with sql
2022-07-23 05:03:54,600 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint M20220723050354_pk primary key (STORE_ID,DS)
        )
        
2022-07-23 05:03:54,635 - tool.dba - INFO - Read data with sql
2022-07-23 05:03:54,635 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:03:54,879 - tool.dba - INFO - finish read total 8008 rows
2022-07-23 05:03:54,881 - tool.dba - INFO - create table finish
2022-07-23 05:03:54,881 - tool.dba - INFO - insert data with sql
2022-07-23 05:03:55,015 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04, 10.23it/s]  9%|▊         | 4/46 [00:00<00:04,  8.53it/s] 11%|█         | 5/46 [00:00<00:04,  8.76it/s] 13%|█▎        | 6/46 [00:00<00:04,  9.06it/s] 15%|█▌        | 7/46 [00:00<00:04,  9.27it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.45it/s] 24%|██▍       | 11/46 [00:01<00:03,  9.21it/s] 28%|██▊       | 13/46 [00:01<00:03,  8.88it/s] 33%|███▎      | 15/46 [00:01<00:03,  9.36it/s] 35%|███▍      | 16/46 [00:01<00:03,  9.33it/s] 37%|███▋      | 17/46 [00:01<00:03,  9.45it/s] 39%|███▉      | 18/46 [00:02<00:03,  8.51it/s] 41%|████▏     | 19/46 [00:02<00:03,  8.79it/s] 46%|████▌     | 21/46 [00:02<00:02,  9.44it/s] 50%|█████     | 23/46 [00:02<00:02,  8.48it/s] 54%|█████▍    | 25/46 [00:02<00:02,  8.97it/s] 57%|█████▋    | 26/46 [00:02<00:02,  9.16it/s] 61%|██████    | 28/46 [00:03<00:02,  8.92it/s] 65%|██████▌   | 30/46 [00:03<00:01,  9.37it/s] 70%|██████▉   | 32/46 [00:03<00:01,  9.05it/s] 74%|███████▍  | 34/46 [00:03<00:01,  9.27it/s] 78%|███████▊  | 36/46 [00:03<00:01,  9.49it/s] 80%|████████  | 37/46 [00:04<00:01,  8.94it/s] 85%|████████▍ | 39/46 [00:04<00:00,  9.42it/s] 89%|████████▉ | 41/46 [00:04<00:00,  9.86it/s] 91%|█████████▏| 42/46 [00:04<00:00,  9.20it/s] 96%|█████████▌| 44/46 [00:05<00:00,  4.73it/s] 98%|█████████▊| 45/46 [00:05<00:00,  5.29it/s]100%|██████████| 46/46 [00:05<00:00,  8.34it/s]
2022-07-23 05:04:00,528 - tool.dba - INFO - insert finish
2022-07-23 05:04:00,531 - tool.dba - INFO - Delete data with sql
2022-07-23 05:04:00,531 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-23 05:04:20,024 - tool.dba - INFO - Delete data finish
2022-07-23 05:04:20,065 - tool.dba - INFO - insert data with sql
2022-07-23 05:04:20,209 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:05,  7.85it/s]  7%|▋         | 3/46 [00:00<00:05,  7.99it/s]  9%|▊         | 4/46 [00:00<00:05,  7.81it/s] 11%|█         | 5/46 [00:00<00:05,  8.16it/s] 13%|█▎        | 6/46 [00:00<00:05,  7.37it/s] 15%|█▌        | 7/46 [00:00<00:04,  7.84it/s] 17%|█▋        | 8/46 [00:01<00:04,  8.20it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.40it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.50it/s] 24%|██▍       | 11/46 [00:01<00:04,  7.47it/s] 26%|██▌       | 12/46 [00:01<00:04,  7.77it/s] 28%|██▊       | 13/46 [00:01<00:04,  7.92it/s] 30%|███       | 14/46 [00:01<00:04,  7.84it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.03it/s] 35%|███▍      | 16/46 [00:02<00:04,  7.21it/s] 37%|███▋      | 17/46 [00:02<00:03,  7.52it/s] 39%|███▉      | 18/46 [00:02<00:03,  7.75it/s] 41%|████▏     | 19/46 [00:02<00:03,  7.94it/s] 43%|████▎     | 20/46 [00:02<00:03,  8.07it/s] 46%|████▌     | 21/46 [00:02<00:03,  7.24it/s] 48%|████▊     | 22/46 [00:02<00:03,  7.58it/s] 50%|█████     | 23/46 [00:02<00:02,  7.93it/s] 52%|█████▏    | 24/46 [00:03<00:02,  8.19it/s] 54%|█████▍    | 25/46 [00:03<00:02,  7.38it/s] 57%|█████▋    | 26/46 [00:03<00:02,  7.66it/s] 59%|█████▊    | 27/46 [00:03<00:02,  7.97it/s] 61%|██████    | 28/46 [00:03<00:02,  8.19it/s] 63%|██████▎   | 29/46 [00:03<00:02,  8.29it/s] 65%|██████▌   | 30/46 [00:03<00:02,  7.45it/s] 67%|██████▋   | 31/46 [00:03<00:01,  7.74it/s] 70%|██████▉   | 32/46 [00:04<00:01,  8.00it/s] 72%|███████▏  | 33/46 [00:04<00:01,  8.18it/s] 74%|███████▍  | 34/46 [00:04<00:01,  8.38it/s] 76%|███████▌  | 35/46 [00:04<00:01,  7.48it/s] 78%|███████▊  | 36/46 [00:05<00:05,  1.97it/s] 80%|████████  | 37/46 [00:05<00:03,  2.57it/s] 83%|████████▎ | 38/46 [00:06<00:02,  3.26it/s] 85%|████████▍ | 39/46 [00:06<00:01,  4.01it/s] 87%|████████▋ | 40/46 [00:06<00:01,  4.49it/s] 89%|████████▉ | 41/46 [00:06<00:00,  5.27it/s] 91%|█████████▏| 42/46 [00:06<00:00,  5.82it/s] 93%|█████████▎| 43/46 [00:06<00:00,  6.41it/s] 96%|█████████▌| 44/46 [00:06<00:00,  6.28it/s] 98%|█████████▊| 45/46 [00:07<00:00,  6.82it/s]100%|██████████| 46/46 [00:07<00:00,  6.55it/s]
2022-07-23 05:04:27,233 - tool.dba - INFO - insert finish
2022-07-23 05:04:27,287 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-23 05:04:27,288 - tool.dba - INFO - Read data with sql
2022-07-23 05:04:27,288 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-23 05:05:10,914 - tool.dba - INFO - finish read total 4776447 rows
2022-07-23 05:05:11,787 - tool.dba - INFO - Read data with sql
2022-07-23 05:05:11,787 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-23 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-23 05:05:44,636 - tool.dba - INFO - finish read total 3573052 rows
2022-07-23 05:05:45,599 - tool.dba - INFO - Read data with sql
2022-07-23 05:05:45,599 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-23 05:05:45,630 - tool.dba - INFO - finish read total 824 rows
2022-07-23 05:05:45,630 - tool.dba - INFO - Read data with sql
2022-07-23 05:05:45,630 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-23 05:05:45,656 - tool.dba - INFO - finish read total 5379 rows
2022-07-23 05:07:00,282 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:00,282 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:07:00,523 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:07:00,524 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:00,524 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-23 05:07:00,539 - tool.dba - INFO - finish read total 2557 rows
2022-07-23 05:07:12,655 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:12,655 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-23 05:07:12,693 - tool.dba - INFO - finish read total 5436 rows
2022-07-23 05:07:13,018 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:13,018 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:07:13,307 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:07:13,308 - tool.dba - INFO - Delete data with sql
2022-07-23 05:07:13,317 - tool.dba - INFO - Create data with sql
2022-07-23 05:07:13,317 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint T20220723050713_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-23 05:07:13,346 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:13,346 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:07:13,587 - tool.dba - INFO - finish read total 8008 rows
2022-07-23 05:07:13,588 - tool.dba - INFO - create table finish
2022-07-23 05:07:13,588 - tool.dba - INFO - insert data with sql
2022-07-23 05:07:13,604 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  8.49it/s]100%|██████████| 1/1 [00:00<00:00,  8.46it/s]
2022-07-23 05:07:13,723 - tool.dba - INFO - insert finish
2022-07-23 05:07:13,725 - tool.dba - INFO - Delete data with sql
2022-07-23 05:07:13,725 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-23 05:07:13,914 - tool.dba - INFO - Delete data finish
2022-07-23 05:07:13,992 - tool.dba - INFO - insert data with sql
2022-07-23 05:07:14,015 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.44it/s]100%|██████████| 1/1 [00:00<00:00,  4.43it/s]
2022-07-23 05:07:14,241 - tool.dba - INFO - insert finish
2022-07-23 05:07:14,255 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:14,256 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-23 05:07:26,803 - tool.dba - INFO - finish read total 12168 rows
2022-07-23 05:07:27,007 - tool.dba - INFO - Read data with sql
2022-07-23 05:07:27,007 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-23 05:09:21,249 - tool.dba - INFO - finish read total 5958831 rows
2022-07-23 05:09:33,163 - tool.dba - INFO - Read data with sql
2022-07-23 05:09:33,163 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:09:33,422 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:09:33,423 - tool.dba - INFO - Read data with sql
2022-07-23 05:09:33,423 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-23 05:09:33,439 - tool.dba - INFO - finish read total 2557 rows
2022-07-23 05:11:20,917 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:20,917 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:11:21,177 - tool.dba - INFO - finish read total 8007 rows
2022-07-23 05:11:21,178 - tool.dba - INFO - Delete data with sql
2022-07-23 05:11:21,182 - tool.dba - INFO - Create data with sql
2022-07-23 05:11:21,183 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint D20220723051121_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-23 05:11:21,208 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:21,209 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:11:21,444 - tool.dba - INFO - finish read total 8008 rows
2022-07-23 05:11:21,445 - tool.dba - INFO - create table finish
2022-07-23 05:11:21,445 - tool.dba - INFO - insert data with sql
2022-07-23 05:11:21,453 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 45.51it/s]
2022-07-23 05:11:21,476 - tool.dba - INFO - insert finish
2022-07-23 05:11:21,477 - tool.dba - INFO - Delete data with sql
2022-07-23 05:11:21,477 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-23 05:11:21,504 - tool.dba - INFO - Delete data finish
2022-07-23 05:11:21,534 - tool.dba - INFO - insert data with sql
2022-07-23 05:11:21,544 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 59.07it/s]
2022-07-23 05:11:21,562 - tool.dba - INFO - insert finish
2022-07-23 05:11:21,566 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:21,566 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-23 05:11:22,718 - tool.dba - INFO - finish read total 169210 rows
2022-07-23 05:11:22,718 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:22,718 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-23 05:11:33,618 - tool.dba - INFO - finish read total 98147 rows
2022-07-23 05:11:33,885 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:33,885 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-23 05:11:47,380 - tool.dba - INFO - finish read total 936596 rows
2022-07-23 05:11:47,380 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:47,380 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-23 05:11:57,199 - tool.dba - INFO - finish read total 1090935 rows
2022-07-23 05:11:57,200 - tool.dba - INFO - Read data with sql
2022-07-23 05:11:57,200 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-23 05:12:10,080 - tool.dba - INFO - finish read total 1242413 rows
2022-07-23 05:12:10,080 - tool.dba - INFO - Read data with sql
2022-07-23 05:12:10,080 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-23 05:12:19,135 - tool.dba - INFO - finish read total 1016886 rows
2022-07-23 05:12:19,135 - tool.dba - INFO - Read data with sql
2022-07-23 05:12:19,135 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-23 05:12:32,791 - tool.dba - INFO - finish read total 1427219 rows
2022-07-23 05:12:32,791 - tool.dba - INFO - Read data with sql
2022-07-23 05:12:32,791 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-23 05:12:42,676 - tool.dba - INFO - finish read total 1199170 rows
2022-07-23 05:13:12,155 - tool.dba - INFO - Read data with sql
2022-07-23 05:13:12,155 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-23 05:13:12,208 - tool.dba - INFO - finish read total 3249 rows
2022-07-23 05:13:15,646 - tool.dba - INFO - Delete data with sql
2022-07-23 05:13:15,801 - tool.dba - INFO - Create data with sql
2022-07-23 05:13:15,801 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint T20220723051315_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-23 05:13:15,830 - tool.dba - INFO - Read data with sql
2022-07-23 05:13:15,830 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-23 05:13:16,067 - tool.dba - INFO - finish read total 8008 rows
2022-07-23 05:13:16,068 - tool.dba - INFO - create table finish
2022-07-23 05:13:16,069 - tool.dba - INFO - insert data with sql
2022-07-23 05:13:16,436 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  8.36it/s]  7%|▋         | 2/30 [00:00<00:03,  8.14it/s] 10%|█         | 3/30 [00:00<00:03,  7.87it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.91it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.90it/s] 20%|██        | 6/30 [00:00<00:03,  7.53it/s] 23%|██▎       | 7/30 [00:00<00:03,  7.38it/s] 27%|██▋       | 8/30 [00:01<00:03,  7.04it/s] 30%|███       | 9/30 [00:01<00:02,  7.02it/s] 33%|███▎      | 10/30 [00:01<00:02,  7.05it/s] 37%|███▋      | 11/30 [00:01<00:02,  7.32it/s] 40%|████      | 12/30 [00:01<00:02,  7.49it/s] 43%|████▎     | 13/30 [00:01<00:02,  6.75it/s] 47%|████▋     | 14/30 [00:01<00:02,  7.02it/s] 50%|█████     | 15/30 [00:02<00:02,  7.03it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.15it/s] 57%|█████▋    | 17/30 [00:02<00:01,  7.05it/s] 60%|██████    | 18/30 [00:02<00:01,  6.39it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.57it/s] 67%|██████▋   | 20/30 [00:02<00:01,  6.82it/s] 70%|███████   | 21/30 [00:02<00:01,  7.05it/s] 73%|███████▎  | 22/30 [00:03<00:01,  6.59it/s] 77%|███████▋  | 23/30 [00:03<00:01,  6.92it/s] 80%|████████  | 24/30 [00:03<00:00,  7.16it/s] 83%|████████▎ | 25/30 [00:03<00:00,  7.20it/s] 87%|████████▋ | 26/30 [00:03<00:00,  7.19it/s] 90%|█████████ | 27/30 [00:03<00:00,  6.20it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.21it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.04it/s]100%|██████████| 30/30 [00:04<00:00,  7.11it/s]
2022-07-23 05:13:20,654 - tool.dba - INFO - insert finish
2022-07-23 05:13:20,664 - tool.dba - INFO - Delete data with sql
2022-07-23 05:13:20,664 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-23 05:13:31,440 - tool.dba - INFO - Delete data finish
2022-07-23 05:13:31,582 - tool.dba - INFO - insert data with sql
2022-07-23 05:13:32,059 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  4.00it/s]  7%|▋         | 2/30 [00:00<00:08,  3.40it/s] 10%|█         | 3/30 [00:00<00:07,  3.50it/s] 13%|█▎        | 4/30 [00:04<00:38,  1.50s/it] 17%|█▋        | 5/30 [00:04<00:26,  1.08s/it] 20%|██        | 6/30 [00:04<00:19,  1.25it/s] 23%|██▎       | 7/30 [00:05<00:14,  1.59it/s] 27%|██▋       | 8/30 [00:05<00:11,  1.86it/s] 30%|███       | 9/30 [00:05<00:09,  2.19it/s] 33%|███▎      | 10/30 [00:05<00:08,  2.47it/s] 37%|███▋      | 11/30 [00:06<00:06,  2.78it/s] 40%|████      | 12/30 [00:06<00:06,  2.88it/s] 43%|████▎     | 13/30 [00:06<00:05,  3.10it/s] 47%|████▋     | 14/30 [00:07<00:04,  3.27it/s] 50%|█████     | 15/30 [00:07<00:04,  3.20it/s] 53%|█████▎    | 16/30 [00:07<00:04,  3.35it/s] 57%|█████▋    | 17/30 [00:07<00:03,  3.41it/s] 60%|██████    | 18/30 [00:08<00:03,  3.34it/s] 63%|██████▎   | 19/30 [00:10<00:09,  1.17it/s] 67%|██████▋   | 20/30 [00:10<00:06,  1.47it/s] 70%|███████   | 21/30 [00:11<00:05,  1.75it/s] 73%|███████▎  | 22/30 [00:11<00:03,  2.08it/s] 77%|███████▋  | 23/30 [00:11<00:02,  2.43it/s] 80%|████████  | 24/30 [00:11<00:02,  2.58it/s] 83%|████████▎ | 25/30 [00:12<00:01,  2.79it/s] 87%|████████▋ | 26/30 [00:12<00:01,  2.98it/s] 90%|█████████ | 27/30 [00:12<00:01,  2.93it/s] 93%|█████████▎| 28/30 [00:13<00:00,  3.06it/s] 97%|█████████▋| 29/30 [00:13<00:00,  3.13it/s]100%|██████████| 30/30 [00:13<00:00,  2.23it/s]
2022-07-23 05:13:45,498 - tool.dba - INFO - insert finish
2022-07-23 21:34:50.310 Read data with sql
2022-07-23 21:34:50.310 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-23 21:34:51.987 finish read total 129433 rows
2022-07-23 21:34:56.568 Read data with sql
2022-07-23 21:34:56.568 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-23 21:34:58.215 finish read total 129433 rows
2022-07-24 05:00:00,219 - tool.dba - INFO - Read data with sql
2022-07-24 05:00:00,219 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:00:00,606 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:00:00,607 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-24 05:00:00,607 - tool.dba - INFO - Read data with sql
2022-07-24 05:00:00,607 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-24 05:01:01,239 - tool.dba - INFO - finish read total 6485982 rows
2022-07-24 05:01:16,362 - tool.dba - INFO - Read data with sql
2022-07-24 05:01:16,362 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:01:16,637 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:01:16,637 - tool.dba - INFO - Read data with sql
2022-07-24 05:01:16,637 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-24 05:01:16,653 - tool.dba - INFO - finish read total 2557 rows
2022-07-24 05:03:55,677 - tool.dba - INFO - Read data with sql
2022-07-24 05:03:55,677 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:03:55,942 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:03:55,943 - tool.dba - INFO - Delete data with sql
2022-07-24 05:03:56,006 - tool.dba - INFO - Create data with sql
2022-07-24 05:03:56,006 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint F20220724050356_pk primary key (STORE_ID,DS)
        )
        
2022-07-24 05:03:56,085 - tool.dba - INFO - Read data with sql
2022-07-24 05:03:56,086 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:03:56,320 - tool.dba - INFO - finish read total 8008 rows
2022-07-24 05:03:56,322 - tool.dba - INFO - create table finish
2022-07-24 05:03:56,322 - tool.dba - INFO - insert data with sql
2022-07-24 05:03:56,454 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04, 10.08it/s]  9%|▊         | 4/46 [00:00<00:04,  8.61it/s] 13%|█▎        | 6/46 [00:00<00:04,  9.53it/s] 17%|█▋        | 8/46 [00:00<00:03, 10.05it/s] 22%|██▏       | 10/46 [00:01<00:03,  9.42it/s] 26%|██▌       | 12/46 [00:01<00:03,  9.88it/s] 30%|███       | 14/46 [00:01<00:03,  9.33it/s] 35%|███▍      | 16/46 [00:01<00:03,  9.67it/s] 39%|███▉      | 18/46 [00:01<00:02, 10.01it/s] 43%|████▎     | 20/46 [00:02<00:02,  9.54it/s] 48%|████▊     | 22/46 [00:02<00:02,  9.75it/s] 50%|█████     | 23/46 [00:02<00:02,  9.04it/s] 54%|█████▍    | 25/46 [00:02<00:02,  9.41it/s] 57%|█████▋    | 26/46 [00:02<00:02,  9.49it/s] 61%|██████    | 28/46 [00:02<00:01,  9.05it/s] 63%|██████▎   | 29/46 [00:03<00:01,  9.17it/s] 67%|██████▋   | 31/46 [00:03<00:01,  9.67it/s] 72%|███████▏  | 33/46 [00:03<00:01,  9.21it/s] 76%|███████▌  | 35/46 [00:03<00:01,  9.57it/s] 80%|████████  | 37/46 [00:03<00:00,  9.80it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.11it/s] 87%|████████▋ | 40/46 [00:04<00:00,  9.29it/s] 91%|█████████▏| 42/46 [00:04<00:00,  8.83it/s] 96%|█████████▌| 44/46 [00:04<00:00,  9.34it/s]100%|██████████| 46/46 [00:04<00:00, 10.79it/s]100%|██████████| 46/46 [00:04<00:00,  9.61it/s]
2022-07-24 05:04:01,243 - tool.dba - INFO - insert finish
2022-07-24 05:04:01,247 - tool.dba - INFO - Delete data with sql
2022-07-24 05:04:01,247 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-24 05:04:21,710 - tool.dba - INFO - Delete data finish
2022-07-24 05:04:21,790 - tool.dba - INFO - insert data with sql
2022-07-24 05:04:21,935 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:04,  9.83it/s]  4%|▍         | 2/46 [00:00<00:06,  7.24it/s]  7%|▋         | 3/46 [00:00<00:05,  7.78it/s]  9%|▊         | 4/46 [00:00<00:05,  7.98it/s] 11%|█         | 5/46 [00:00<00:04,  8.27it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.41it/s] 15%|█▌        | 7/46 [00:00<00:05,  7.44it/s] 17%|█▋        | 8/46 [00:01<00:05,  7.41it/s] 20%|█▉        | 9/46 [00:01<00:04,  7.73it/s] 22%|██▏       | 10/46 [00:01<00:04,  7.97it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.22it/s] 26%|██▌       | 12/46 [00:01<00:04,  7.53it/s] 28%|██▊       | 13/46 [00:01<00:04,  7.91it/s] 30%|███       | 14/46 [00:01<00:03,  8.20it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.36it/s] 35%|███▍      | 16/46 [00:02<00:04,  7.48it/s] 37%|███▋      | 17/46 [00:02<00:03,  7.84it/s] 39%|███▉      | 18/46 [00:02<00:03,  8.03it/s] 41%|████▏     | 19/46 [00:02<00:03,  8.27it/s] 43%|████▎     | 20/46 [00:02<00:03,  8.39it/s] 46%|████▌     | 21/46 [00:02<00:03,  7.48it/s] 48%|████▊     | 22/46 [00:02<00:03,  7.81it/s] 50%|█████     | 23/46 [00:02<00:02,  7.99it/s] 52%|█████▏    | 24/46 [00:03<00:02,  8.35it/s] 54%|█████▍    | 25/46 [00:03<00:02,  8.71it/s] 57%|█████▋    | 26/46 [00:03<00:02,  7.84it/s] 59%|█████▊    | 27/46 [00:03<00:02,  8.03it/s] 61%|██████    | 28/46 [00:03<00:02,  8.13it/s] 63%|██████▎   | 29/46 [00:03<00:02,  8.24it/s] 65%|██████▌   | 30/46 [00:03<00:01,  8.34it/s] 67%|██████▋   | 31/46 [00:03<00:01,  7.67it/s] 70%|██████▉   | 32/46 [00:04<00:01,  7.95it/s] 72%|███████▏  | 33/46 [00:05<00:07,  1.77it/s] 74%|███████▍  | 34/46 [00:05<00:05,  2.33it/s] 76%|███████▌  | 35/46 [00:05<00:03,  2.84it/s] 78%|███████▊  | 36/46 [00:06<00:02,  3.54it/s] 80%|████████  | 37/46 [00:06<00:02,  4.25it/s] 83%|████████▎ | 38/46 [00:06<00:01,  4.99it/s] 85%|████████▍ | 39/46 [00:06<00:01,  5.67it/s] 87%|████████▋ | 40/46 [00:06<00:01,  5.76it/s] 89%|████████▉ | 41/46 [00:06<00:00,  6.41it/s] 91%|█████████▏| 42/46 [00:06<00:00,  6.99it/s] 93%|█████████▎| 43/46 [00:06<00:00,  7.46it/s] 96%|█████████▌| 44/46 [00:06<00:00,  7.77it/s] 98%|█████████▊| 45/46 [00:07<00:00,  7.10it/s]100%|██████████| 46/46 [00:07<00:00,  6.40it/s]
2022-07-24 05:04:29,127 - tool.dba - INFO - insert finish
2022-07-24 05:04:29,182 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-24 05:04:29,183 - tool.dba - INFO - Read data with sql
2022-07-24 05:04:29,183 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-24 05:05:14,735 - tool.dba - INFO - finish read total 4776447 rows
2022-07-24 05:05:15,601 - tool.dba - INFO - Read data with sql
2022-07-24 05:05:15,601 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-24 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-24 05:05:50,582 - tool.dba - INFO - finish read total 3745752 rows
2022-07-24 05:05:51,575 - tool.dba - INFO - Read data with sql
2022-07-24 05:05:51,576 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-24 05:05:51,597 - tool.dba - INFO - finish read total 824 rows
2022-07-24 05:05:51,598 - tool.dba - INFO - Read data with sql
2022-07-24 05:05:51,598 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-24 05:05:51,618 - tool.dba - INFO - finish read total 5375 rows
2022-07-24 05:07:05,932 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:05,933 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:07:06,156 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:07:06,156 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:06,156 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-24 05:07:06,172 - tool.dba - INFO - finish read total 2557 rows
2022-07-24 05:07:18,021 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:18,021 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-24 05:07:18,064 - tool.dba - INFO - finish read total 5437 rows
2022-07-24 05:07:18,376 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:18,376 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:07:18,635 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:07:18,636 - tool.dba - INFO - Delete data with sql
2022-07-24 05:07:18,644 - tool.dba - INFO - Create data with sql
2022-07-24 05:07:18,645 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint F20220724050718_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-24 05:07:18,673 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:18,673 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:07:18,906 - tool.dba - INFO - finish read total 8008 rows
2022-07-24 05:07:18,907 - tool.dba - INFO - create table finish
2022-07-24 05:07:18,907 - tool.dba - INFO - insert data with sql
2022-07-24 05:07:18,923 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 12.88it/s]
2022-07-24 05:07:19,001 - tool.dba - INFO - insert finish
2022-07-24 05:07:19,003 - tool.dba - INFO - Delete data with sql
2022-07-24 05:07:19,003 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-24 05:07:19,180 - tool.dba - INFO - Delete data finish
2022-07-24 05:07:19,260 - tool.dba - INFO - insert data with sql
2022-07-24 05:07:19,285 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.42it/s]100%|██████████| 1/1 [00:00<00:00,  4.41it/s]
2022-07-24 05:07:19,512 - tool.dba - INFO - insert finish
2022-07-24 05:07:19,526 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:19,527 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-24 05:07:32,592 - tool.dba - INFO - finish read total 12179 rows
2022-07-24 05:07:32,797 - tool.dba - INFO - Read data with sql
2022-07-24 05:07:32,797 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-24 05:09:27,745 - tool.dba - INFO - finish read total 5963892 rows
2022-07-24 05:09:39,606 - tool.dba - INFO - Read data with sql
2022-07-24 05:09:39,606 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:09:39,876 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:09:39,876 - tool.dba - INFO - Read data with sql
2022-07-24 05:09:39,876 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-24 05:09:39,892 - tool.dba - INFO - finish read total 2557 rows
2022-07-24 05:11:27,790 - tool.dba - INFO - Read data with sql
2022-07-24 05:11:27,790 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:11:28,182 - tool.dba - INFO - finish read total 8007 rows
2022-07-24 05:11:28,183 - tool.dba - INFO - Delete data with sql
2022-07-24 05:11:28,188 - tool.dba - INFO - Create data with sql
2022-07-24 05:11:28,189 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint F20220724051128_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-24 05:11:28,216 - tool.dba - INFO - Read data with sql
2022-07-24 05:11:28,216 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:11:28,449 - tool.dba - INFO - finish read total 8008 rows
2022-07-24 05:11:28,451 - tool.dba - INFO - create table finish
2022-07-24 05:11:28,451 - tool.dba - INFO - insert data with sql
2022-07-24 05:11:28,459 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 54.30it/s]
2022-07-24 05:11:28,478 - tool.dba - INFO - insert finish
2022-07-24 05:11:28,478 - tool.dba - INFO - Delete data with sql
2022-07-24 05:11:28,479 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-24 05:11:28,501 - tool.dba - INFO - Delete data finish
2022-07-24 05:11:28,524 - tool.dba - INFO - insert data with sql
2022-07-24 05:11:28,534 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 61.24it/s]
2022-07-24 05:11:28,551 - tool.dba - INFO - insert finish
2022-07-24 05:11:28,555 - tool.dba - INFO - Read data with sql
2022-07-24 05:11:28,555 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-24 05:11:29,655 - tool.dba - INFO - finish read total 169334 rows
2022-07-24 05:11:29,655 - tool.dba - INFO - Read data with sql
2022-07-24 05:11:29,655 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-24 05:11:48,420 - tool.dba - INFO - finish read total 98611 rows
2022-07-24 05:11:48,688 - tool.dba - INFO - Read data with sql
2022-07-24 05:11:48,688 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-24 05:12:01,483 - tool.dba - INFO - finish read total 939173 rows
2022-07-24 05:12:01,483 - tool.dba - INFO - Read data with sql
2022-07-24 05:12:01,483 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-24 05:12:11,569 - tool.dba - INFO - finish read total 1092349 rows
2022-07-24 05:12:11,569 - tool.dba - INFO - Read data with sql
2022-07-24 05:12:11,569 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-24 05:12:23,992 - tool.dba - INFO - finish read total 1238489 rows
2022-07-24 05:12:23,992 - tool.dba - INFO - Read data with sql
2022-07-24 05:12:23,992 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-24 05:12:33,031 - tool.dba - INFO - finish read total 1020328 rows
2022-07-24 05:12:33,031 - tool.dba - INFO - Read data with sql
2022-07-24 05:12:33,031 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-24 05:12:45,810 - tool.dba - INFO - finish read total 1413803 rows
2022-07-24 05:12:45,810 - tool.dba - INFO - Read data with sql
2022-07-24 05:12:45,810 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-24 05:12:55,692 - tool.dba - INFO - finish read total 1191004 rows
2022-07-24 05:13:25,280 - tool.dba - INFO - Read data with sql
2022-07-24 05:13:25,280 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-24 05:13:25,330 - tool.dba - INFO - finish read total 3251 rows
2022-07-24 05:13:28,788 - tool.dba - INFO - Delete data with sql
2022-07-24 05:13:28,940 - tool.dba - INFO - Create data with sql
2022-07-24 05:13:28,941 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint B20220724051328_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-24 05:13:28,968 - tool.dba - INFO - Read data with sql
2022-07-24 05:13:28,968 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-24 05:13:29,220 - tool.dba - INFO - finish read total 8008 rows
2022-07-24 05:13:29,221 - tool.dba - INFO - create table finish
2022-07-24 05:13:29,222 - tool.dba - INFO - insert data with sql
2022-07-24 05:13:29,590 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.82it/s]  7%|▋         | 2/30 [00:00<00:03,  7.64it/s] 10%|█         | 3/30 [00:00<00:03,  7.54it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.75it/s] 17%|█▋        | 5/30 [00:00<00:03,  6.74it/s] 20%|██        | 6/30 [00:00<00:03,  6.08it/s] 23%|██▎       | 7/30 [00:01<00:03,  5.82it/s] 27%|██▋       | 8/30 [00:01<00:03,  6.17it/s] 30%|███       | 9/30 [00:01<00:03,  6.46it/s] 33%|███▎      | 10/30 [00:01<00:03,  5.58it/s] 37%|███▋      | 11/30 [00:01<00:03,  5.90it/s] 40%|████      | 12/30 [00:01<00:02,  6.43it/s] 43%|████▎     | 13/30 [00:01<00:02,  6.78it/s] 47%|████▋     | 14/30 [00:02<00:02,  6.35it/s] 50%|█████     | 15/30 [00:02<00:02,  6.68it/s] 53%|█████▎    | 16/30 [00:02<00:02,  6.81it/s] 57%|█████▋    | 17/30 [00:02<00:01,  6.92it/s] 60%|██████    | 18/30 [00:02<00:01,  6.74it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.11it/s] 67%|██████▋   | 20/30 [00:03<00:01,  6.25it/s] 70%|███████   | 21/30 [00:03<00:01,  6.68it/s] 73%|███████▎  | 22/30 [00:03<00:01,  6.91it/s] 77%|███████▋  | 23/30 [00:03<00:00,  7.14it/s] 80%|████████  | 24/30 [00:03<00:00,  6.40it/s] 83%|████████▎ | 25/30 [00:03<00:00,  6.92it/s] 87%|████████▋ | 26/30 [00:03<00:00,  6.93it/s] 90%|█████████ | 27/30 [00:04<00:00,  7.00it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.99it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.18it/s]100%|██████████| 30/30 [00:04<00:00,  6.70it/s]
2022-07-24 05:13:34,067 - tool.dba - INFO - insert finish
2022-07-24 05:13:34,077 - tool.dba - INFO - Delete data with sql
2022-07-24 05:13:34,077 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-24 05:13:45,161 - tool.dba - INFO - Delete data finish
2022-07-24 05:13:45,291 - tool.dba - INFO - insert data with sql
2022-07-24 05:13:45,776 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:06,  4.14it/s]  7%|▋         | 2/30 [00:00<00:07,  3.94it/s] 10%|█         | 3/30 [00:00<00:07,  3.63it/s] 13%|█▎        | 4/30 [00:01<00:06,  3.74it/s] 17%|█▋        | 5/30 [00:01<00:06,  3.64it/s] 20%|██        | 6/30 [00:01<00:07,  3.36it/s] 23%|██▎       | 7/30 [00:01<00:06,  3.46it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.50it/s] 30%|███       | 9/30 [00:02<00:06,  3.29it/s] 33%|███▎      | 10/30 [00:02<00:05,  3.34it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.47it/s] 40%|████      | 12/30 [00:03<00:05,  3.31it/s] 43%|████▎     | 13/30 [00:03<00:05,  3.37it/s] 47%|████▋     | 14/30 [00:04<00:04,  3.51it/s] 50%|█████     | 15/30 [00:04<00:04,  3.56it/s] 53%|█████▎    | 16/30 [00:04<00:04,  3.26it/s] 57%|█████▋    | 17/30 [00:04<00:04,  3.24it/s] 60%|██████    | 18/30 [00:05<00:03,  3.33it/s] 63%|██████▎   | 19/30 [00:05<00:03,  3.24it/s] 67%|██████▋   | 20/30 [00:05<00:03,  3.30it/s] 70%|███████   | 21/30 [00:07<00:06,  1.31it/s] 73%|███████▎  | 22/30 [00:08<00:05,  1.58it/s] 77%|███████▋  | 23/30 [00:08<00:03,  1.89it/s] 80%|████████  | 24/30 [00:08<00:02,  2.26it/s] 83%|████████▎ | 25/30 [00:08<00:02,  2.42it/s] 87%|████████▋ | 26/30 [00:09<00:01,  2.61it/s] 90%|█████████ | 27/30 [00:09<00:01,  2.81it/s] 93%|█████████▎| 28/30 [00:09<00:00,  2.83it/s] 97%|█████████▋| 29/30 [00:10<00:00,  2.86it/s]100%|██████████| 30/30 [00:10<00:00,  2.92it/s]
2022-07-24 05:13:56,058 - tool.dba - INFO - insert finish
2022-07-25 05:00:00,565 - tool.dba - INFO - Read data with sql
2022-07-25 05:00:00,565 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:00:00,930 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:00:00,931 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-25 05:00:00,931 - tool.dba - INFO - Read data with sql
2022-07-25 05:00:00,931 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-25 05:01:00,786 - tool.dba - INFO - finish read total 6491146 rows
2022-07-25 05:01:15,957 - tool.dba - INFO - Read data with sql
2022-07-25 05:01:15,957 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:01:16,215 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:01:16,216 - tool.dba - INFO - Read data with sql
2022-07-25 05:01:16,216 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-25 05:01:16,232 - tool.dba - INFO - finish read total 2557 rows
2022-07-25 05:03:55,155 - tool.dba - INFO - Read data with sql
2022-07-25 05:03:55,156 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:03:55,404 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:03:55,405 - tool.dba - INFO - Delete data with sql
2022-07-25 05:03:55,467 - tool.dba - INFO - Create data with sql
2022-07-25 05:03:55,468 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint Q20220725050355_pk primary key (STORE_ID,DS)
        )
        
2022-07-25 05:03:55,496 - tool.dba - INFO - Read data with sql
2022-07-25 05:03:55,497 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:03:55,744 - tool.dba - INFO - finish read total 8008 rows
2022-07-25 05:03:55,746 - tool.dba - INFO - create table finish
2022-07-25 05:03:55,746 - tool.dba - INFO - insert data with sql
2022-07-25 05:03:55,881 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04, 10.04it/s]  9%|▊         | 4/46 [00:00<00:04,  8.42it/s] 11%|█         | 5/46 [00:00<00:04,  8.63it/s] 15%|█▌        | 7/46 [00:00<00:04,  9.50it/s] 17%|█▋        | 8/46 [00:00<00:04,  8.67it/s] 22%|██▏       | 10/46 [00:01<00:03,  9.28it/s] 26%|██▌       | 12/46 [00:01<00:03,  9.78it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.19it/s] 33%|███▎      | 15/46 [00:01<00:03,  9.93it/s] 37%|███▋      | 17/46 [00:01<00:03,  9.27it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.49it/s] 46%|████▌     | 21/46 [00:02<00:02,  9.77it/s] 48%|████▊     | 22/46 [00:02<00:02,  9.17it/s] 52%|█████▏    | 24/46 [00:02<00:02,  9.68it/s] 57%|█████▋    | 26/46 [00:02<00:02,  9.87it/s] 59%|█████▊    | 27/46 [00:02<00:02,  9.21it/s] 63%|██████▎   | 29/46 [00:03<00:01,  9.63it/s] 67%|██████▋   | 31/46 [00:03<00:01,  9.95it/s] 70%|██████▉   | 32/46 [00:03<00:01,  9.26it/s] 74%|███████▍  | 34/46 [00:03<00:01,  9.72it/s] 78%|███████▊  | 36/46 [00:03<00:01,  9.26it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.68it/s] 87%|████████▋ | 40/46 [00:04<00:00, 10.10it/s] 91%|█████████▏| 42/46 [00:04<00:00,  9.58it/s] 96%|█████████▌| 44/46 [00:04<00:00,  9.91it/s]100%|██████████| 46/46 [00:04<00:00, 11.18it/s]100%|██████████| 46/46 [00:04<00:00,  9.71it/s]
2022-07-25 05:04:00,619 - tool.dba - INFO - insert finish
2022-07-25 05:04:00,623 - tool.dba - INFO - Delete data with sql
2022-07-25 05:04:00,623 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-25 05:04:21,062 - tool.dba - INFO - Delete data finish
2022-07-25 05:04:21,101 - tool.dba - INFO - insert data with sql
2022-07-25 05:04:21,241 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  7.12it/s]  4%|▍         | 2/46 [00:00<00:05,  7.97it/s]  7%|▋         | 3/46 [00:00<00:05,  8.33it/s]  9%|▊         | 4/46 [00:00<00:04,  8.51it/s] 11%|█         | 5/46 [00:00<00:05,  7.40it/s] 13%|█▎        | 6/46 [00:00<00:05,  7.81it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.13it/s] 17%|█▋        | 8/46 [00:00<00:04,  8.26it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.46it/s] 22%|██▏       | 10/46 [00:01<00:04,  7.58it/s] 24%|██▍       | 11/46 [00:01<00:04,  7.90it/s] 26%|██▌       | 12/46 [00:01<00:04,  8.11it/s] 28%|██▊       | 13/46 [00:01<00:03,  8.27it/s] 30%|███       | 14/46 [00:01<00:03,  8.28it/s] 33%|███▎      | 15/46 [00:01<00:04,  7.41it/s] 35%|███▍      | 16/46 [00:02<00:03,  7.78it/s] 37%|███▋      | 17/46 [00:02<00:03,  7.96it/s] 39%|███▉      | 18/46 [00:02<00:03,  8.14it/s] 41%|████▏     | 19/46 [00:02<00:03,  8.39it/s] 43%|████▎     | 20/46 [00:02<00:03,  7.61it/s] 46%|████▌     | 21/46 [00:02<00:03,  7.90it/s] 48%|████▊     | 22/46 [00:02<00:03,  7.94it/s] 50%|█████     | 23/46 [00:02<00:02,  8.15it/s] 52%|█████▏    | 24/46 [00:03<00:02,  7.43it/s] 54%|█████▍    | 25/46 [00:03<00:02,  7.78it/s] 57%|█████▋    | 26/46 [00:03<00:02,  8.07it/s] 59%|█████▊    | 27/46 [00:03<00:02,  8.27it/s] 61%|██████    | 28/46 [00:03<00:02,  8.40it/s] 63%|██████▎   | 29/46 [00:03<00:02,  7.53it/s] 65%|██████▌   | 30/46 [00:03<00:02,  7.90it/s] 67%|██████▋   | 31/46 [00:03<00:01,  8.23it/s] 70%|██████▉   | 32/46 [00:03<00:01,  8.41it/s] 72%|███████▏  | 33/46 [00:04<00:01,  8.49it/s] 74%|███████▍  | 34/46 [00:04<00:01,  7.49it/s] 76%|███████▌  | 35/46 [00:04<00:01,  7.82it/s] 78%|███████▊  | 36/46 [00:04<00:01,  8.05it/s] 80%|████████  | 37/46 [00:05<00:04,  2.06it/s] 83%|████████▎ | 38/46 [00:05<00:02,  2.68it/s] 85%|████████▍ | 39/46 [00:06<00:02,  3.22it/s] 87%|████████▋ | 40/46 [00:06<00:01,  3.96it/s] 89%|████████▉ | 41/46 [00:06<00:01,  4.73it/s] 91%|█████████▏| 42/46 [00:06<00:00,  5.52it/s] 93%|█████████▎| 43/46 [00:06<00:00,  5.70it/s] 96%|█████████▌| 44/46 [00:06<00:00,  6.37it/s] 98%|█████████▊| 45/46 [00:06<00:00,  6.82it/s]100%|██████████| 46/46 [00:06<00:00,  6.67it/s]
2022-07-25 05:04:28,142 - tool.dba - INFO - insert finish
2022-07-25 05:04:28,197 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-25 05:04:28,199 - tool.dba - INFO - Read data with sql
2022-07-25 05:04:28,199 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-25 05:05:13,940 - tool.dba - INFO - finish read total 4776447 rows
2022-07-25 05:05:14,807 - tool.dba - INFO - Read data with sql
2022-07-25 05:05:14,807 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-25 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-25 05:05:52,015 - tool.dba - INFO - finish read total 3917512 rows
2022-07-25 05:05:53,047 - tool.dba - INFO - Read data with sql
2022-07-25 05:05:53,047 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-25 05:05:53,075 - tool.dba - INFO - finish read total 824 rows
2022-07-25 05:05:53,075 - tool.dba - INFO - Read data with sql
2022-07-25 05:05:53,075 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-25 05:05:53,104 - tool.dba - INFO - finish read total 5379 rows
2022-07-25 05:07:06,962 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:06,963 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:07:07,438 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:07:07,438 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:07,439 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-25 05:07:07,455 - tool.dba - INFO - finish read total 2557 rows
2022-07-25 05:07:19,275 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:19,275 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-25 05:07:19,314 - tool.dba - INFO - finish read total 5437 rows
2022-07-25 05:07:19,630 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:19,631 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:07:19,965 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:07:19,966 - tool.dba - INFO - Delete data with sql
2022-07-25 05:07:19,974 - tool.dba - INFO - Create data with sql
2022-07-25 05:07:19,975 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint M20220725050719_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-25 05:07:20,004 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:20,004 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:07:20,247 - tool.dba - INFO - finish read total 8008 rows
2022-07-25 05:07:20,249 - tool.dba - INFO - create table finish
2022-07-25 05:07:20,249 - tool.dba - INFO - insert data with sql
2022-07-25 05:07:20,264 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 10.76it/s]
2022-07-25 05:07:20,358 - tool.dba - INFO - insert finish
2022-07-25 05:07:20,360 - tool.dba - INFO - Delete data with sql
2022-07-25 05:07:20,360 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-25 05:07:20,592 - tool.dba - INFO - Delete data finish
2022-07-25 05:07:20,664 - tool.dba - INFO - insert data with sql
2022-07-25 05:07:20,689 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.31it/s]100%|██████████| 1/1 [00:00<00:00,  5.30it/s]
2022-07-25 05:07:20,878 - tool.dba - INFO - insert finish
2022-07-25 05:07:20,893 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:20,893 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-25 05:07:28,625 - tool.dba - INFO - finish read total 12181 rows
2022-07-25 05:07:28,829 - tool.dba - INFO - Read data with sql
2022-07-25 05:07:28,829 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-25 05:09:22,525 - tool.dba - INFO - finish read total 5968939 rows
2022-07-25 05:09:34,429 - tool.dba - INFO - Read data with sql
2022-07-25 05:09:34,430 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:09:34,691 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:09:34,691 - tool.dba - INFO - Read data with sql
2022-07-25 05:09:34,691 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-25 05:09:34,707 - tool.dba - INFO - finish read total 2557 rows
2022-07-25 05:11:23,525 - tool.dba - INFO - Read data with sql
2022-07-25 05:11:23,525 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:11:23,793 - tool.dba - INFO - finish read total 8007 rows
2022-07-25 05:11:23,794 - tool.dba - INFO - Delete data with sql
2022-07-25 05:11:23,799 - tool.dba - INFO - Create data with sql
2022-07-25 05:11:23,799 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint A20220725051123_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-25 05:11:23,826 - tool.dba - INFO - Read data with sql
2022-07-25 05:11:23,826 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:11:24,062 - tool.dba - INFO - finish read total 8008 rows
2022-07-25 05:11:24,063 - tool.dba - INFO - create table finish
2022-07-25 05:11:24,063 - tool.dba - INFO - insert data with sql
2022-07-25 05:11:24,071 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 54.39it/s]
2022-07-25 05:11:24,090 - tool.dba - INFO - insert finish
2022-07-25 05:11:24,090 - tool.dba - INFO - Delete data with sql
2022-07-25 05:11:24,090 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-25 05:11:24,112 - tool.dba - INFO - Delete data finish
2022-07-25 05:11:24,136 - tool.dba - INFO - insert data with sql
2022-07-25 05:11:24,146 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 59.30it/s]
2022-07-25 05:11:24,164 - tool.dba - INFO - insert finish
2022-07-25 05:11:24,169 - tool.dba - INFO - Read data with sql
2022-07-25 05:11:24,169 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-25 05:11:25,304 - tool.dba - INFO - finish read total 169400 rows
2022-07-25 05:11:25,304 - tool.dba - INFO - Read data with sql
2022-07-25 05:11:25,304 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-25 05:11:43,795 - tool.dba - INFO - finish read total 98774 rows
2022-07-25 05:11:44,065 - tool.dba - INFO - Read data with sql
2022-07-25 05:11:44,065 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-25 05:11:56,648 - tool.dba - INFO - finish read total 936842 rows
2022-07-25 05:11:56,648 - tool.dba - INFO - Read data with sql
2022-07-25 05:11:56,648 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-25 05:12:07,055 - tool.dba - INFO - finish read total 1093169 rows
2022-07-25 05:12:07,055 - tool.dba - INFO - Read data with sql
2022-07-25 05:12:07,055 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-25 05:12:19,732 - tool.dba - INFO - finish read total 1235298 rows
2022-07-25 05:12:19,732 - tool.dba - INFO - Read data with sql
2022-07-25 05:12:19,732 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-25 05:12:28,693 - tool.dba - INFO - finish read total 1023325 rows
2022-07-25 05:12:28,694 - tool.dba - INFO - Read data with sql
2022-07-25 05:12:28,694 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-25 05:12:41,749 - tool.dba - INFO - finish read total 1405026 rows
2022-07-25 05:12:41,749 - tool.dba - INFO - Read data with sql
2022-07-25 05:12:41,749 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-25 05:12:51,863 - tool.dba - INFO - finish read total 1190261 rows
2022-07-25 05:13:21,518 - tool.dba - INFO - Read data with sql
2022-07-25 05:13:21,518 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-25 05:13:21,554 - tool.dba - INFO - finish read total 3251 rows
2022-07-25 05:13:24,947 - tool.dba - INFO - Delete data with sql
2022-07-25 05:13:25,100 - tool.dba - INFO - Create data with sql
2022-07-25 05:13:25,101 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint O20220725051325_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-25 05:13:25,131 - tool.dba - INFO - Read data with sql
2022-07-25 05:13:25,131 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-25 05:13:25,381 - tool.dba - INFO - finish read total 8008 rows
2022-07-25 05:13:25,382 - tool.dba - INFO - create table finish
2022-07-25 05:13:25,382 - tool.dba - INFO - insert data with sql
2022-07-25 05:13:25,753 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.69it/s]  7%|▋         | 2/30 [00:00<00:03,  7.37it/s] 10%|█         | 3/30 [00:00<00:03,  7.20it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.40it/s] 17%|█▋        | 5/30 [00:00<00:03,  6.44it/s] 20%|██        | 6/30 [00:00<00:03,  6.36it/s] 23%|██▎       | 7/30 [00:01<00:03,  6.42it/s] 27%|██▋       | 8/30 [00:01<00:03,  6.48it/s] 30%|███       | 9/30 [00:01<00:03,  6.11it/s] 33%|███▎      | 10/30 [00:01<00:03,  6.62it/s] 37%|███▋      | 11/30 [00:01<00:02,  6.82it/s] 40%|████      | 12/30 [00:01<00:02,  7.10it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.11it/s] 47%|████▋     | 14/30 [00:02<00:02,  6.40it/s] 50%|█████     | 15/30 [00:02<00:02,  6.47it/s] 53%|█████▎    | 16/30 [00:02<00:02,  6.78it/s] 57%|█████▋    | 17/30 [00:02<00:01,  6.87it/s] 60%|██████    | 18/30 [00:02<00:01,  6.88it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.13it/s] 67%|██████▋   | 20/30 [00:03<00:01,  6.34it/s] 70%|███████   | 21/30 [00:03<00:01,  6.69it/s] 73%|███████▎  | 22/30 [00:03<00:01,  6.71it/s] 77%|███████▋  | 23/30 [00:03<00:00,  7.02it/s] 80%|████████  | 24/30 [00:03<00:00,  6.55it/s] 83%|████████▎ | 25/30 [00:03<00:00,  6.73it/s] 87%|████████▋ | 26/30 [00:03<00:00,  6.87it/s] 90%|█████████ | 27/30 [00:03<00:00,  7.34it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.55it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.43it/s]100%|██████████| 30/30 [00:04<00:00,  6.81it/s]
2022-07-25 05:13:30,160 - tool.dba - INFO - insert finish
2022-07-25 05:13:30,171 - tool.dba - INFO - Delete data with sql
2022-07-25 05:13:30,171 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-25 05:13:44,184 - tool.dba - INFO - Delete data finish
2022-07-25 05:13:44,234 - tool.dba - INFO - insert data with sql
2022-07-25 05:13:44,706 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  4.09it/s]  7%|▋         | 2/30 [00:00<00:07,  3.87it/s] 10%|█         | 3/30 [00:00<00:07,  3.51it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.62it/s] 17%|█▋        | 5/30 [00:01<00:06,  3.61it/s] 20%|██        | 6/30 [00:01<00:07,  3.38it/s] 23%|██▎       | 7/30 [00:01<00:06,  3.44it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.41it/s] 30%|███       | 9/30 [00:02<00:06,  3.28it/s] 33%|███▎      | 10/30 [00:02<00:05,  3.34it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.48it/s] 40%|████      | 12/30 [00:03<00:05,  3.36it/s] 43%|████▎     | 13/30 [00:03<00:04,  3.47it/s] 47%|████▋     | 14/30 [00:05<00:10,  1.52it/s] 50%|█████     | 15/30 [00:05<00:08,  1.79it/s] 53%|█████▎    | 16/30 [00:05<00:06,  2.11it/s] 57%|█████▋    | 17/30 [00:06<00:05,  2.40it/s] 60%|██████    | 18/30 [00:06<00:04,  2.67it/s] 63%|██████▎   | 19/30 [00:06<00:04,  2.69it/s] 67%|██████▋   | 20/30 [00:07<00:03,  2.89it/s] 70%|███████   | 21/30 [00:07<00:02,  3.04it/s] 73%|███████▎  | 22/30 [00:07<00:02,  3.04it/s] 77%|███████▋  | 23/30 [00:07<00:02,  3.19it/s] 80%|████████  | 24/30 [00:08<00:01,  3.26it/s] 83%|████████▎ | 25/30 [00:08<00:01,  3.17it/s] 87%|████████▋ | 26/30 [00:11<00:04,  1.07s/it] 90%|█████████ | 27/30 [00:11<00:02,  1.18it/s] 93%|█████████▎| 28/30 [00:12<00:01,  1.44it/s] 97%|█████████▋| 29/30 [00:12<00:00,  1.73it/s]100%|██████████| 30/30 [00:12<00:00,  2.29it/s]100%|██████████| 30/30 [00:12<00:00,  2.40it/s]
2022-07-25 05:13:57,208 - tool.dba - INFO - insert finish
2022-07-26 05:00:01,016 - tool.dba - INFO - Read data with sql
2022-07-26 05:00:01,017 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:00:01,313 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:00:01,314 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-26 05:00:01,314 - tool.dba - INFO - Read data with sql
2022-07-26 05:00:01,314 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-26 05:01:02,533 - tool.dba - INFO - finish read total 6496315 rows
2022-07-26 05:01:17,844 - tool.dba - INFO - Read data with sql
2022-07-26 05:01:17,844 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:01:18,116 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:01:18,116 - tool.dba - INFO - Read data with sql
2022-07-26 05:01:18,116 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-26 05:01:18,133 - tool.dba - INFO - finish read total 2557 rows
2022-07-26 05:03:57,463 - tool.dba - INFO - Read data with sql
2022-07-26 05:03:57,463 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:03:57,661 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:03:57,663 - tool.dba - INFO - Delete data with sql
2022-07-26 05:03:57,724 - tool.dba - INFO - Create data with sql
2022-07-26 05:03:57,725 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint D20220726050357_pk primary key (STORE_ID,DS)
        )
        
2022-07-26 05:03:57,802 - tool.dba - INFO - Read data with sql
2022-07-26 05:03:57,803 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:03:58,041 - tool.dba - INFO - finish read total 8008 rows
2022-07-26 05:03:58,042 - tool.dba - INFO - create table finish
2022-07-26 05:03:58,042 - tool.dba - INFO - insert data with sql
2022-07-26 05:03:58,176 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:05,  8.45it/s]  9%|▊         | 4/46 [00:00<00:04,  9.33it/s] 13%|█▎        | 6/46 [00:00<00:04,  9.90it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.90it/s] 20%|█▉        | 9/46 [00:00<00:03,  9.54it/s] 24%|██▍       | 11/46 [00:01<00:03,  9.90it/s] 26%|██▌       | 12/46 [00:01<00:03,  9.20it/s] 30%|███       | 14/46 [00:01<00:03,  9.58it/s] 35%|███▍      | 16/46 [00:01<00:02, 10.02it/s] 37%|███▋      | 17/46 [00:01<00:03,  9.30it/s] 41%|████▏     | 19/46 [00:01<00:02,  9.82it/s] 46%|████▌     | 21/46 [00:02<00:02,  9.39it/s] 50%|█████     | 23/46 [00:02<00:02,  9.78it/s] 54%|█████▍    | 25/46 [00:02<00:02, 10.00it/s] 57%|█████▋    | 26/46 [00:02<00:02,  9.19it/s] 59%|█████▊    | 27/46 [00:02<00:02,  9.32it/s] 63%|██████▎   | 29/46 [00:03<00:01,  9.73it/s] 67%|██████▋   | 31/46 [00:03<00:01,  9.21it/s] 72%|███████▏  | 33/46 [00:03<00:01,  9.58it/s] 74%|███████▍  | 34/46 [00:03<00:01,  9.51it/s] 78%|███████▊  | 36/46 [00:03<00:01,  9.06it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.45it/s] 87%|████████▋ | 40/46 [00:04<00:00,  9.00it/s] 91%|█████████▏| 42/46 [00:04<00:00,  9.35it/s] 96%|█████████▌| 44/46 [00:04<00:00,  9.62it/s] 98%|█████████▊| 45/46 [00:04<00:00,  9.01it/s]100%|██████████| 46/46 [00:04<00:00,  9.53it/s]
2022-07-26 05:04:03,003 - tool.dba - INFO - insert finish
2022-07-26 05:04:03,007 - tool.dba - INFO - Delete data with sql
2022-07-26 05:04:03,007 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-26 05:04:21,360 - tool.dba - INFO - Delete data finish
2022-07-26 05:04:21,539 - tool.dba - INFO - insert data with sql
2022-07-26 05:04:21,681 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04,  9.25it/s]  7%|▋         | 3/46 [00:00<00:04,  9.07it/s]  9%|▊         | 4/46 [00:00<00:04,  8.87it/s] 11%|█         | 5/46 [00:00<00:05,  7.71it/s] 13%|█▎        | 6/46 [00:00<00:05,  7.92it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.12it/s] 17%|█▋        | 8/46 [00:00<00:04,  8.23it/s] 20%|█▉        | 9/46 [00:01<00:04,  7.49it/s] 22%|██▏       | 10/46 [00:01<00:04,  7.76it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.00it/s] 26%|██▌       | 12/46 [00:01<00:04,  8.14it/s] 28%|██▊       | 13/46 [00:01<00:03,  8.31it/s] 30%|███       | 14/46 [00:01<00:04,  7.34it/s] 33%|███▎      | 15/46 [00:01<00:04,  7.52it/s] 35%|███▍      | 16/46 [00:02<00:03,  7.84it/s] 37%|███▋      | 17/46 [00:02<00:03,  7.77it/s] 39%|███▉      | 18/46 [00:02<00:03,  7.83it/s] 41%|████▏     | 19/46 [00:02<00:03,  7.15it/s] 43%|████▎     | 20/46 [00:02<00:03,  7.49it/s] 46%|████▌     | 21/46 [00:02<00:03,  7.75it/s] 48%|████▊     | 22/46 [00:02<00:03,  7.94it/s] 50%|█████     | 23/46 [00:02<00:02,  8.13it/s] 52%|█████▏    | 24/46 [00:03<00:03,  7.33it/s] 54%|█████▍    | 25/46 [00:03<00:02,  7.66it/s] 57%|█████▋    | 26/46 [00:03<00:02,  7.88it/s] 59%|█████▊    | 27/46 [00:03<00:02,  8.02it/s] 61%|██████    | 28/46 [00:03<00:02,  7.28it/s] 63%|██████▎   | 29/46 [00:03<00:02,  7.63it/s] 65%|██████▌   | 30/46 [00:03<00:01,  8.05it/s] 67%|██████▋   | 31/46 [00:03<00:01,  8.40it/s] 70%|██████▉   | 32/46 [00:04<00:01,  8.51it/s] 72%|███████▏  | 33/46 [00:04<00:01,  7.45it/s] 74%|███████▍  | 34/46 [00:04<00:01,  7.72it/s] 76%|███████▌  | 35/46 [00:04<00:01,  7.87it/s] 78%|███████▊  | 36/46 [00:04<00:01,  8.03it/s] 80%|████████  | 37/46 [00:04<00:01,  8.23it/s] 83%|████████▎ | 38/46 [00:04<00:01,  7.40it/s] 85%|████████▍ | 39/46 [00:04<00:00,  7.77it/s] 87%|████████▋ | 40/46 [00:05<00:00,  8.04it/s] 89%|████████▉ | 41/46 [00:05<00:00,  8.21it/s] 91%|█████████▏| 42/46 [00:05<00:00,  8.31it/s] 93%|█████████▎| 43/46 [00:05<00:00,  7.53it/s] 96%|█████████▌| 44/46 [00:05<00:00,  7.87it/s] 98%|█████████▊| 45/46 [00:05<00:00,  8.07it/s]100%|██████████| 46/46 [00:05<00:00,  7.99it/s]
2022-07-26 05:04:27,436 - tool.dba - INFO - insert finish
2022-07-26 05:04:27,493 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-26 05:04:27,494 - tool.dba - INFO - Read data with sql
2022-07-26 05:04:27,494 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-26 05:05:12,291 - tool.dba - INFO - finish read total 4776447 rows
2022-07-26 05:05:13,139 - tool.dba - INFO - Read data with sql
2022-07-26 05:05:13,139 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-26 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-26 05:05:49,799 - tool.dba - INFO - finish read total 4088030 rows
2022-07-26 05:05:50,842 - tool.dba - INFO - Read data with sql
2022-07-26 05:05:50,842 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-26 05:05:50,863 - tool.dba - INFO - finish read total 824 rows
2022-07-26 05:05:50,863 - tool.dba - INFO - Read data with sql
2022-07-26 05:05:50,863 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-26 05:05:50,889 - tool.dba - INFO - finish read total 5374 rows
2022-07-26 05:07:04,818 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:04,818 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:07:05,063 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:07:05,064 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:05,064 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-26 05:07:05,079 - tool.dba - INFO - finish read total 2557 rows
2022-07-26 05:07:16,719 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:16,719 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-26 05:07:16,762 - tool.dba - INFO - finish read total 5447 rows
2022-07-26 05:07:17,068 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:17,069 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:07:17,318 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:07:17,320 - tool.dba - INFO - Delete data with sql
2022-07-26 05:07:17,328 - tool.dba - INFO - Create data with sql
2022-07-26 05:07:17,328 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint K20220726050717_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-26 05:07:17,355 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:17,355 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:07:17,582 - tool.dba - INFO - finish read total 8008 rows
2022-07-26 05:07:17,583 - tool.dba - INFO - create table finish
2022-07-26 05:07:17,583 - tool.dba - INFO - insert data with sql
2022-07-26 05:07:17,599 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 13.28it/s]
2022-07-26 05:07:17,675 - tool.dba - INFO - insert finish
2022-07-26 05:07:17,676 - tool.dba - INFO - Delete data with sql
2022-07-26 05:07:17,676 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-26 05:07:17,841 - tool.dba - INFO - Delete data finish
2022-07-26 05:07:17,872 - tool.dba - INFO - insert data with sql
2022-07-26 05:07:17,895 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.93it/s]100%|██████████| 1/1 [00:00<00:00,  5.91it/s]
2022-07-26 05:07:18,065 - tool.dba - INFO - insert finish
2022-07-26 05:07:18,078 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:18,079 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-26 05:07:30,558 - tool.dba - INFO - finish read total 12192 rows
2022-07-26 05:07:30,760 - tool.dba - INFO - Read data with sql
2022-07-26 05:07:30,760 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-26 05:09:25,374 - tool.dba - INFO - finish read total 5973995 rows
2022-07-26 05:09:37,466 - tool.dba - INFO - Read data with sql
2022-07-26 05:09:37,467 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:09:37,718 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:09:37,718 - tool.dba - INFO - Read data with sql
2022-07-26 05:09:37,718 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-26 05:09:37,733 - tool.dba - INFO - finish read total 2557 rows
2022-07-26 05:11:26,520 - tool.dba - INFO - Read data with sql
2022-07-26 05:11:26,520 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:11:26,788 - tool.dba - INFO - finish read total 8007 rows
2022-07-26 05:11:26,789 - tool.dba - INFO - Delete data with sql
2022-07-26 05:11:26,793 - tool.dba - INFO - Create data with sql
2022-07-26 05:11:26,794 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint K20220726051126_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-26 05:11:26,823 - tool.dba - INFO - Read data with sql
2022-07-26 05:11:26,823 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:11:27,067 - tool.dba - INFO - finish read total 8008 rows
2022-07-26 05:11:27,068 - tool.dba - INFO - create table finish
2022-07-26 05:11:27,068 - tool.dba - INFO - insert data with sql
2022-07-26 05:11:27,076 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 42.84it/s]
2022-07-26 05:11:27,100 - tool.dba - INFO - insert finish
2022-07-26 05:11:27,100 - tool.dba - INFO - Delete data with sql
2022-07-26 05:11:27,100 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-26 05:11:27,128 - tool.dba - INFO - Delete data finish
2022-07-26 05:11:27,156 - tool.dba - INFO - insert data with sql
2022-07-26 05:11:27,166 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 58.57it/s]
2022-07-26 05:11:27,184 - tool.dba - INFO - insert finish
2022-07-26 05:11:27,188 - tool.dba - INFO - Read data with sql
2022-07-26 05:11:27,189 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-26 05:11:28,305 - tool.dba - INFO - finish read total 169472 rows
2022-07-26 05:11:28,305 - tool.dba - INFO - Read data with sql
2022-07-26 05:11:28,305 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-26 05:11:46,432 - tool.dba - INFO - finish read total 98768 rows
2022-07-26 05:11:46,699 - tool.dba - INFO - Read data with sql
2022-07-26 05:11:46,699 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-26 05:11:59,291 - tool.dba - INFO - finish read total 936594 rows
2022-07-26 05:11:59,291 - tool.dba - INFO - Read data with sql
2022-07-26 05:11:59,291 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-26 05:12:09,676 - tool.dba - INFO - finish read total 1094058 rows
2022-07-26 05:12:09,676 - tool.dba - INFO - Read data with sql
2022-07-26 05:12:09,676 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-26 05:12:22,606 - tool.dba - INFO - finish read total 1235363 rows
2022-07-26 05:12:22,606 - tool.dba - INFO - Read data with sql
2022-07-26 05:12:22,606 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-26 05:12:30,949 - tool.dba - INFO - finish read total 1029915 rows
2022-07-26 05:12:30,949 - tool.dba - INFO - Read data with sql
2022-07-26 05:12:30,949 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-26 05:12:43,381 - tool.dba - INFO - finish read total 1402919 rows
2022-07-26 05:12:43,382 - tool.dba - INFO - Read data with sql
2022-07-26 05:12:43,382 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-26 05:12:52,079 - tool.dba - INFO - finish read total 1194447 rows
2022-07-26 05:13:21,514 - tool.dba - INFO - Read data with sql
2022-07-26 05:13:21,514 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-26 05:13:21,559 - tool.dba - INFO - finish read total 3251 rows
2022-07-26 05:13:24,929 - tool.dba - INFO - Delete data with sql
2022-07-26 05:13:25,084 - tool.dba - INFO - Create data with sql
2022-07-26 05:13:25,084 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint H20220726051325_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-26 05:13:25,112 - tool.dba - INFO - Read data with sql
2022-07-26 05:13:25,112 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-26 05:13:25,350 - tool.dba - INFO - finish read total 8008 rows
2022-07-26 05:13:25,351 - tool.dba - INFO - create table finish
2022-07-26 05:13:25,351 - tool.dba - INFO - insert data with sql
2022-07-26 05:13:25,724 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.93it/s]  7%|▋         | 2/30 [00:00<00:03,  7.69it/s] 10%|█         | 3/30 [00:00<00:03,  7.66it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.83it/s] 17%|█▋        | 5/30 [00:00<00:03,  6.87it/s] 20%|██        | 6/30 [00:00<00:03,  6.94it/s] 23%|██▎       | 7/30 [00:00<00:03,  7.06it/s] 27%|██▋       | 8/30 [00:01<00:03,  7.11it/s] 30%|███       | 9/30 [00:01<00:02,  7.13it/s] 33%|███▎      | 10/30 [00:01<00:03,  6.45it/s] 37%|███▋      | 11/30 [00:01<00:02,  6.72it/s] 40%|████      | 12/30 [00:01<00:02,  7.16it/s] 43%|████▎     | 13/30 [00:01<00:02,  7.40it/s] 47%|████▋     | 14/30 [00:01<00:02,  6.76it/s] 50%|█████     | 15/30 [00:02<00:02,  7.06it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.16it/s] 57%|█████▋    | 17/30 [00:02<00:01,  7.28it/s] 60%|██████    | 18/30 [00:02<00:01,  7.38it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.54it/s] 67%|██████▋   | 20/30 [00:02<00:01,  6.69it/s] 70%|███████   | 21/30 [00:02<00:01,  7.01it/s] 73%|███████▎  | 22/30 [00:03<00:01,  7.26it/s] 77%|███████▋  | 23/30 [00:03<00:00,  7.48it/s] 80%|████████  | 24/30 [00:03<00:00,  6.85it/s] 83%|████████▎ | 25/30 [00:03<00:00,  6.99it/s] 87%|████████▋ | 26/30 [00:03<00:00,  7.09it/s] 90%|█████████ | 27/30 [00:03<00:00,  7.16it/s] 93%|█████████▎| 28/30 [00:03<00:00,  7.20it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.49it/s]100%|██████████| 30/30 [00:04<00:00,  7.15it/s]
2022-07-26 05:13:29,920 - tool.dba - INFO - insert finish
2022-07-26 05:13:29,930 - tool.dba - INFO - Delete data with sql
2022-07-26 05:13:29,930 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-26 05:13:41,128 - tool.dba - INFO - Delete data finish
2022-07-26 05:13:41,410 - tool.dba - INFO - insert data with sql
2022-07-26 05:13:41,885 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  3.93it/s]  7%|▋         | 2/30 [00:00<00:07,  3.96it/s] 10%|█         | 3/30 [00:00<00:07,  3.49it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.65it/s] 17%|█▋        | 5/30 [00:01<00:06,  3.78it/s] 20%|██        | 6/30 [00:01<00:07,  3.21it/s] 23%|██▎       | 7/30 [00:02<00:06,  3.35it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.41it/s] 30%|███       | 9/30 [00:02<00:06,  3.23it/s] 33%|███▎      | 10/30 [00:02<00:06,  3.29it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.41it/s] 40%|████      | 12/30 [00:03<00:05,  3.25it/s] 43%|████▎     | 13/30 [00:03<00:05,  3.37it/s] 47%|████▋     | 14/30 [00:04<00:04,  3.39it/s] 50%|█████     | 15/30 [00:04<00:04,  3.42it/s] 53%|█████▎    | 16/30 [00:04<00:04,  3.28it/s] 57%|█████▋    | 17/30 [00:04<00:03,  3.37it/s] 60%|██████    | 18/30 [00:05<00:03,  3.34it/s] 63%|██████▎   | 19/30 [00:05<00:03,  3.18it/s] 67%|██████▋   | 20/30 [00:05<00:03,  3.27it/s] 70%|███████   | 21/30 [00:07<00:05,  1.50it/s] 73%|███████▎  | 22/30 [00:07<00:04,  1.80it/s] 77%|███████▋  | 23/30 [00:08<00:03,  2.11it/s] 80%|████████  | 24/30 [00:08<00:02,  2.41it/s] 83%|████████▎ | 25/30 [00:08<00:01,  2.52it/s] 87%|████████▋ | 26/30 [00:08<00:01,  2.72it/s] 90%|█████████ | 27/30 [00:09<00:01,  2.87it/s] 93%|█████████▎| 28/30 [00:09<00:00,  2.84it/s] 97%|█████████▋| 29/30 [00:09<00:00,  2.90it/s]100%|██████████| 30/30 [00:10<00:00,  3.68it/s]100%|██████████| 30/30 [00:10<00:00,  2.98it/s]
2022-07-26 05:13:51,940 - tool.dba - INFO - insert finish
2022-07-26 22:49:41.830 Read data with sql
2022-07-26 22:49:41.830 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 22:49:45.888 finish read total 131357 rows
2022-07-26 22:49:49.057 Read data with sql
2022-07-26 22:49:49.057 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 22:49:50.733 finish read total 131357 rows
2022-07-26 22:49:50.995 Read data with sql
2022-07-26 22:49:50.995 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 22:49:52.664 finish read total 131357 rows
2022-07-26 22:49:54.945 Read data with sql
2022-07-26 22:49:54.946 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 22:49:56.618 finish read total 131357 rows
2022-07-26 23:25:38.478 Read data with sql
2022-07-26 23:25:38.478 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:25:40.702 finish read total 131357 rows
2022-07-26 23:25:43.529 Read data with sql
2022-07-26 23:25:43.529 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:25:45.222 finish read total 131357 rows
2022-07-26 23:25:46.775 Read data with sql
2022-07-26 23:25:46.775 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:25:48.467 finish read total 131357 rows
2022-07-26 23:27:48.545 Read data with sql
2022-07-26 23:27:48.545 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:27:50.234 finish read total 131357 rows
2022-07-26 23:30:30.187 Read data with sql
2022-07-26 23:30:30.187 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:30:31.882 finish read total 131357 rows
2022-07-26 23:30:34.476 Read data with sql
2022-07-26 23:30:34.476 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:30:36.155 finish read total 131357 rows
2022-07-26 23:30:36.418 Read data with sql
2022-07-26 23:30:36.418 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:30:38.096 finish read total 131357 rows
2022-07-26 23:30:39.598 Read data with sql
2022-07-26 23:30:39.598 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:30:41.291 finish read total 131357 rows
2022-07-26 23:32:03.965 Read data with sql
2022-07-26 23:32:03.965 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:32:05.665 finish read total 131357 rows
2022-07-26 23:34:06.064 Read data with sql
2022-07-26 23:34:06.064 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:34:07.730 finish read total 131357 rows
2022-07-26 23:34:10.232 Read data with sql
2022-07-26 23:34:10.232 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:34:11.922 finish read total 131357 rows
2022-07-26 23:34:12.184 Read data with sql
2022-07-26 23:34:12.184 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:34:13.885 finish read total 131357 rows
2022-07-26 23:41:29.952 Read data with sql
2022-07-26 23:41:29.952 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:41:31.656 finish read total 131357 rows
2022-07-26 23:41:39.816 Read data with sql
2022-07-26 23:41:39.816 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:41:41.512 finish read total 131357 rows
2022-07-26 23:41:41.773 Read data with sql
2022-07-26 23:41:41.773 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:41:43.465 finish read total 131357 rows
2022-07-26 23:41:45.531 Read data with sql
2022-07-26 23:41:45.531 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-26 23:41:47.225 finish read total 131357 rows
2022-07-27 05:00:00,680 - tool.dba - INFO - Read data with sql
2022-07-27 05:00:00,680 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:00:00,971 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:00:00,972 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-27 05:00:00,972 - tool.dba - INFO - Read data with sql
2022-07-27 05:00:00,972 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-27 05:01:03,619 - tool.dba - INFO - finish read total 6501491 rows
2022-07-27 05:01:18,865 - tool.dba - INFO - Read data with sql
2022-07-27 05:01:18,866 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:01:19,150 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:01:19,151 - tool.dba - INFO - Read data with sql
2022-07-27 05:01:19,151 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-27 05:01:19,167 - tool.dba - INFO - finish read total 2557 rows
2022-07-27 05:03:58,291 - tool.dba - INFO - Read data with sql
2022-07-27 05:03:58,292 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:03:58,543 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:03:58,544 - tool.dba - INFO - Delete data with sql
2022-07-27 05:03:58,605 - tool.dba - INFO - Create data with sql
2022-07-27 05:03:58,606 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint X20220727050358_pk primary key (STORE_ID,DS)
        )
        
2022-07-27 05:03:58,633 - tool.dba - INFO - Read data with sql
2022-07-27 05:03:58,633 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:03:58,863 - tool.dba - INFO - finish read total 8008 rows
2022-07-27 05:03:58,865 - tool.dba - INFO - create table finish
2022-07-27 05:03:58,865 - tool.dba - INFO - insert data with sql
2022-07-27 05:03:59,005 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:05,  8.04it/s]  7%|▋         | 3/46 [00:00<00:04,  8.69it/s]  9%|▊         | 4/46 [00:00<00:04,  9.02it/s] 13%|█▎        | 6/46 [00:00<00:04,  9.68it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.71it/s] 20%|█▉        | 9/46 [00:00<00:03,  9.28it/s] 24%|██▍       | 11/46 [00:01<00:03,  9.65it/s] 26%|██▌       | 12/46 [00:01<00:03,  8.88it/s] 30%|███       | 14/46 [00:01<00:03,  9.40it/s] 35%|███▍      | 16/46 [00:01<00:03,  9.34it/s] 37%|███▋      | 17/46 [00:01<00:03,  8.66it/s] 39%|███▉      | 18/46 [00:02<00:03,  8.64it/s] 43%|████▎     | 20/46 [00:02<00:02,  9.28it/s] 46%|████▌     | 21/46 [00:02<00:02,  8.54it/s] 50%|█████     | 23/46 [00:02<00:02,  9.08it/s] 54%|█████▍    | 25/46 [00:02<00:02,  9.91it/s] 57%|█████▋    | 26/46 [00:02<00:02,  9.08it/s] 59%|█████▊    | 27/46 [00:02<00:02,  9.16it/s] 61%|██████    | 28/46 [00:03<00:01,  9.33it/s] 63%|██████▎   | 29/46 [00:03<00:01,  9.02it/s] 65%|██████▌   | 30/46 [00:03<00:01,  8.65it/s] 67%|██████▋   | 31/46 [00:03<00:01,  8.05it/s] 72%|███████▏  | 33/46 [00:03<00:01,  8.94it/s] 76%|███████▌  | 35/46 [00:03<00:01,  9.44it/s] 78%|███████▊  | 36/46 [00:03<00:01,  8.87it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.36it/s] 87%|████████▋ | 40/46 [00:04<00:00,  8.79it/s] 91%|█████████▏| 42/46 [00:04<00:00,  9.49it/s] 96%|█████████▌| 44/46 [00:04<00:00,  9.68it/s] 98%|█████████▊| 45/46 [00:04<00:00,  8.96it/s]100%|██████████| 46/46 [00:05<00:00,  9.18it/s]
2022-07-27 05:04:04,017 - tool.dba - INFO - insert finish
2022-07-27 05:04:04,021 - tool.dba - INFO - Delete data with sql
2022-07-27 05:04:04,021 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-27 05:04:20,571 - tool.dba - INFO - Delete data finish
2022-07-27 05:04:20,730 - tool.dba - INFO - insert data with sql
2022-07-27 05:04:20,872 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04,  9.62it/s]  7%|▋         | 3/46 [00:00<00:04,  9.28it/s]  9%|▊         | 4/46 [00:00<00:04,  8.99it/s] 11%|█         | 5/46 [00:00<00:05,  7.85it/s] 13%|█▎        | 6/46 [00:01<00:15,  2.61it/s] 15%|█▌        | 7/46 [00:01<00:11,  3.37it/s] 17%|█▋        | 8/46 [00:01<00:09,  4.17it/s] 20%|█▉        | 9/46 [00:01<00:08,  4.61it/s] 22%|██▏       | 10/46 [00:02<00:06,  5.41it/s] 24%|██▍       | 11/46 [00:02<00:05,  6.06it/s] 26%|██▌       | 12/46 [00:02<00:05,  6.67it/s] 28%|██▊       | 13/46 [00:02<00:04,  7.22it/s] 30%|███       | 14/46 [00:02<00:04,  6.85it/s] 33%|███▎      | 15/46 [00:02<00:04,  7.32it/s] 35%|███▍      | 16/46 [00:02<00:03,  7.71it/s] 37%|███▋      | 17/46 [00:02<00:03,  8.02it/s] 39%|███▉      | 18/46 [00:02<00:03,  8.24it/s] 41%|████▏     | 19/46 [00:03<00:03,  7.42it/s] 43%|████▎     | 20/46 [00:03<00:03,  7.80it/s] 46%|████▌     | 21/46 [00:03<00:03,  8.09it/s] 48%|████▊     | 22/46 [00:03<00:02,  8.25it/s] 50%|█████     | 23/46 [00:03<00:02,  8.32it/s] 52%|█████▏    | 24/46 [00:03<00:02,  7.61it/s] 54%|█████▍    | 25/46 [00:03<00:02,  7.64it/s] 59%|█████▊    | 27/46 [00:04<00:02,  8.60it/s] 61%|██████    | 28/46 [00:04<00:02,  7.78it/s] 63%|██████▎   | 29/46 [00:04<00:02,  8.02it/s] 65%|██████▌   | 30/46 [00:04<00:01,  8.23it/s] 67%|██████▋   | 31/46 [00:04<00:01,  8.46it/s] 70%|██████▉   | 32/46 [00:04<00:01,  8.52it/s] 72%|███████▏  | 33/46 [00:04<00:01,  7.62it/s] 74%|███████▍  | 34/46 [00:04<00:01,  7.92it/s] 76%|███████▌  | 35/46 [00:05<00:01,  8.21it/s] 78%|███████▊  | 36/46 [00:05<00:01,  8.39it/s] 80%|████████  | 37/46 [00:05<00:01,  8.38it/s] 83%|████████▎ | 38/46 [00:05<00:01,  7.62it/s] 85%|████████▍ | 39/46 [00:05<00:00,  7.93it/s] 87%|████████▋ | 40/46 [00:05<00:00,  8.19it/s] 89%|████████▉ | 41/46 [00:05<00:00,  8.33it/s] 91%|█████████▏| 42/46 [00:05<00:00,  8.47it/s] 93%|█████████▎| 43/46 [00:06<00:00,  7.68it/s] 96%|█████████▌| 44/46 [00:06<00:00,  8.04it/s] 98%|█████████▊| 45/46 [00:06<00:00,  8.31it/s]100%|██████████| 46/46 [00:06<00:00,  7.21it/s]
2022-07-27 05:04:27,249 - tool.dba - INFO - insert finish
2022-07-27 05:04:27,303 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-27 05:04:27,305 - tool.dba - INFO - Read data with sql
2022-07-27 05:04:27,305 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-27 05:05:13,657 - tool.dba - INFO - finish read total 4776447 rows
2022-07-27 05:05:14,512 - tool.dba - INFO - Read data with sql
2022-07-27 05:05:14,513 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-27 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-27 05:05:54,727 - tool.dba - INFO - finish read total 4251319 rows
2022-07-27 05:05:55,810 - tool.dba - INFO - Read data with sql
2022-07-27 05:05:55,810 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-27 05:05:55,831 - tool.dba - INFO - finish read total 824 rows
2022-07-27 05:05:55,831 - tool.dba - INFO - Read data with sql
2022-07-27 05:05:55,831 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-27 05:05:55,854 - tool.dba - INFO - finish read total 5371 rows
2022-07-27 05:07:11,047 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:11,048 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:07:11,285 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:07:11,285 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:11,286 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-27 05:07:11,301 - tool.dba - INFO - finish read total 2557 rows
2022-07-27 05:07:23,177 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:23,177 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-27 05:07:23,218 - tool.dba - INFO - finish read total 5450 rows
2022-07-27 05:07:23,528 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:23,528 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:07:23,722 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:07:23,723 - tool.dba - INFO - Delete data with sql
2022-07-27 05:07:23,732 - tool.dba - INFO - Create data with sql
2022-07-27 05:07:23,732 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint J20220727050723_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-27 05:07:23,754 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:23,754 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:07:23,921 - tool.dba - INFO - finish read total 8008 rows
2022-07-27 05:07:23,922 - tool.dba - INFO - create table finish
2022-07-27 05:07:23,922 - tool.dba - INFO - insert data with sql
2022-07-27 05:07:23,938 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 11.10it/s]
2022-07-27 05:07:24,029 - tool.dba - INFO - insert finish
2022-07-27 05:07:24,030 - tool.dba - INFO - Delete data with sql
2022-07-27 05:07:24,031 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-27 05:07:24,241 - tool.dba - INFO - Delete data finish
2022-07-27 05:07:24,277 - tool.dba - INFO - insert data with sql
2022-07-27 05:07:24,300 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.51it/s]100%|██████████| 1/1 [00:00<00:00,  5.49it/s]
2022-07-27 05:07:24,483 - tool.dba - INFO - insert finish
2022-07-27 05:07:24,498 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:24,498 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-27 05:07:37,728 - tool.dba - INFO - finish read total 12208 rows
2022-07-27 05:07:37,932 - tool.dba - INFO - Read data with sql
2022-07-27 05:07:37,932 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-27 05:09:32,106 - tool.dba - INFO - finish read total 5979059 rows
2022-07-27 05:09:44,080 - tool.dba - INFO - Read data with sql
2022-07-27 05:09:44,080 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:09:44,339 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:09:44,339 - tool.dba - INFO - Read data with sql
2022-07-27 05:09:44,339 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-27 05:09:44,356 - tool.dba - INFO - finish read total 2557 rows
2022-07-27 05:11:31,962 - tool.dba - INFO - Read data with sql
2022-07-27 05:11:31,963 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:11:32,238 - tool.dba - INFO - finish read total 8007 rows
2022-07-27 05:11:32,239 - tool.dba - INFO - Delete data with sql
2022-07-27 05:11:32,244 - tool.dba - INFO - Create data with sql
2022-07-27 05:11:32,245 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint N20220727051132_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-27 05:11:32,270 - tool.dba - INFO - Read data with sql
2022-07-27 05:11:32,271 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:11:32,508 - tool.dba - INFO - finish read total 8008 rows
2022-07-27 05:11:32,509 - tool.dba - INFO - create table finish
2022-07-27 05:11:32,509 - tool.dba - INFO - insert data with sql
2022-07-27 05:11:32,518 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 42.10it/s]
2022-07-27 05:11:32,542 - tool.dba - INFO - insert finish
2022-07-27 05:11:32,543 - tool.dba - INFO - Delete data with sql
2022-07-27 05:11:32,543 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-27 05:11:32,573 - tool.dba - INFO - Delete data finish
2022-07-27 05:11:32,608 - tool.dba - INFO - insert data with sql
2022-07-27 05:11:32,619 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 54.82it/s]
2022-07-27 05:11:32,638 - tool.dba - INFO - insert finish
2022-07-27 05:11:32,643 - tool.dba - INFO - Read data with sql
2022-07-27 05:11:32,643 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-27 05:11:33,797 - tool.dba - INFO - finish read total 169542 rows
2022-07-27 05:11:33,797 - tool.dba - INFO - Read data with sql
2022-07-27 05:11:33,797 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-27 05:11:53,624 - tool.dba - INFO - finish read total 98416 rows
2022-07-27 05:11:53,895 - tool.dba - INFO - Read data with sql
2022-07-27 05:11:53,895 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-27 05:12:06,686 - tool.dba - INFO - finish read total 935846 rows
2022-07-27 05:12:06,686 - tool.dba - INFO - Read data with sql
2022-07-27 05:12:06,686 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-27 05:12:16,761 - tool.dba - INFO - finish read total 1093901 rows
2022-07-27 05:12:16,761 - tool.dba - INFO - Read data with sql
2022-07-27 05:12:16,761 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-27 05:12:29,240 - tool.dba - INFO - finish read total 1235015 rows
2022-07-27 05:12:29,241 - tool.dba - INFO - Read data with sql
2022-07-27 05:12:29,241 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-27 05:12:38,391 - tool.dba - INFO - finish read total 1028122 rows
2022-07-27 05:12:38,392 - tool.dba - INFO - Read data with sql
2022-07-27 05:12:38,392 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-27 05:12:50,720 - tool.dba - INFO - finish read total 1402450 rows
2022-07-27 05:12:50,720 - tool.dba - INFO - Read data with sql
2022-07-27 05:12:50,720 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-27 05:13:00,847 - tool.dba - INFO - finish read total 1193054 rows
2022-07-27 05:13:30,018 - tool.dba - INFO - Read data with sql
2022-07-27 05:13:30,019 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-27 05:13:30,052 - tool.dba - INFO - finish read total 3252 rows
2022-07-27 05:13:33,458 - tool.dba - INFO - Delete data with sql
2022-07-27 05:13:33,609 - tool.dba - INFO - Create data with sql
2022-07-27 05:13:33,610 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint V20220727051333_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-27 05:13:33,640 - tool.dba - INFO - Read data with sql
2022-07-27 05:13:33,640 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-27 05:13:33,886 - tool.dba - INFO - finish read total 8008 rows
2022-07-27 05:13:33,887 - tool.dba - INFO - create table finish
2022-07-27 05:13:33,888 - tool.dba - INFO - insert data with sql
2022-07-27 05:13:34,255 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.84it/s]  7%|▋         | 2/30 [00:00<00:03,  7.56it/s] 10%|█         | 3/30 [00:00<00:03,  7.41it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.58it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.45it/s] 20%|██        | 6/30 [00:00<00:03,  6.43it/s] 23%|██▎       | 7/30 [00:01<00:03,  6.54it/s] 27%|██▋       | 8/30 [00:01<00:03,  6.62it/s] 30%|███       | 9/30 [00:01<00:03,  6.53it/s] 33%|███▎      | 10/30 [00:01<00:03,  6.58it/s] 37%|███▋      | 11/30 [00:01<00:03,  6.23it/s] 40%|████      | 12/30 [00:01<00:02,  6.66it/s] 43%|████▎     | 13/30 [00:01<00:02,  6.95it/s] 47%|████▋     | 14/30 [00:02<00:02,  6.62it/s] 50%|█████     | 15/30 [00:02<00:02,  6.69it/s] 53%|█████▎    | 16/30 [00:02<00:02,  6.12it/s] 57%|█████▋    | 17/30 [00:02<00:02,  6.14it/s] 60%|██████    | 18/30 [00:02<00:01,  6.08it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.24it/s] 67%|██████▋   | 20/30 [00:03<00:01,  5.85it/s] 70%|███████   | 21/30 [00:03<00:01,  6.33it/s] 73%|███████▎  | 22/30 [00:03<00:01,  6.70it/s] 77%|███████▋  | 23/30 [00:03<00:01,  6.78it/s] 80%|████████  | 24/30 [00:03<00:00,  7.00it/s] 83%|████████▎ | 25/30 [00:03<00:00,  6.30it/s] 87%|████████▋ | 26/30 [00:03<00:00,  6.46it/s] 90%|█████████ | 27/30 [00:04<00:00,  6.51it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.44it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.42it/s]100%|██████████| 30/30 [00:04<00:00,  6.73it/s]
2022-07-27 05:13:38,716 - tool.dba - INFO - insert finish
2022-07-27 05:13:38,726 - tool.dba - INFO - Delete data with sql
2022-07-27 05:13:38,726 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-27 05:13:48,442 - tool.dba - INFO - Delete data finish
2022-07-27 05:13:48,595 - tool.dba - INFO - insert data with sql
2022-07-27 05:13:49,069 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:08,  3.45it/s]  7%|▋         | 2/30 [00:00<00:07,  3.59it/s] 10%|█         | 3/30 [00:00<00:07,  3.75it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.46it/s] 17%|█▋        | 5/30 [00:01<00:07,  3.54it/s] 20%|██        | 6/30 [00:01<00:06,  3.54it/s] 23%|██▎       | 7/30 [00:02<00:06,  3.38it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.46it/s] 30%|███       | 9/30 [00:02<00:06,  3.47it/s] 33%|███▎      | 10/30 [00:02<00:06,  3.28it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.47it/s] 40%|████      | 12/30 [00:03<00:05,  3.54it/s] 43%|████▎     | 13/30 [00:03<00:05,  3.38it/s] 47%|████▋     | 14/30 [00:04<00:04,  3.49it/s] 50%|█████     | 15/30 [00:04<00:04,  3.51it/s] 53%|█████▎    | 16/30 [00:04<00:04,  3.35it/s] 57%|█████▋    | 17/30 [00:04<00:03,  3.49it/s] 60%|██████    | 18/30 [00:05<00:03,  3.56it/s] 63%|██████▎   | 19/30 [00:05<00:03,  3.57it/s] 67%|██████▋   | 20/30 [00:05<00:02,  3.47it/s] 70%|███████   | 21/30 [00:06<00:02,  3.51it/s] 73%|███████▎  | 22/30 [00:06<00:02,  3.54it/s] 77%|███████▋  | 23/30 [00:06<00:02,  3.37it/s] 80%|████████  | 24/30 [00:06<00:01,  3.46it/s] 83%|████████▎ | 25/30 [00:07<00:02,  1.95it/s] 87%|████████▋ | 26/30 [00:08<00:01,  2.16it/s] 90%|█████████ | 27/30 [00:08<00:01,  2.44it/s] 93%|█████████▎| 28/30 [00:08<00:00,  2.67it/s] 97%|█████████▋| 29/30 [00:09<00:00,  2.72it/s]100%|██████████| 30/30 [00:09<00:00,  3.23it/s]
2022-07-27 05:13:58,346 - tool.dba - INFO - insert finish
2022-07-27 19:03:51.613 Read data with sql
2022-07-27 19:03:51.613 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:03:55.166 finish read total 112514 rows
2022-07-27 19:04:01.983 Read data with sql
2022-07-27 19:04:01.983 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:04:03.619 finish read total 112514 rows
2022-07-27 19:04:41.810 Read data with sql
2022-07-27 19:04:41.811 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:04:43.544 finish read total 112522 rows
2022-07-27 19:04:46.247 Read data with sql
2022-07-27 19:04:46.247 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:04:47.945 finish read total 112522 rows
2022-07-27 19:04:48.457 Read data with sql
2022-07-27 19:04:48.457 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:04:50.205 finish read total 112522 rows
2022-07-27 19:05:43.330 Read data with sql
2022-07-27 19:05:43.330 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:05:44.777 finish read total 112575 rows
2022-07-27 19:05:47.879 Read data with sql
2022-07-27 19:05:47.879 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:05:49.331 finish read total 112575 rows
2022-07-27 19:05:51.323 Read data with sql
2022-07-27 19:05:51.324 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:05:52.760 finish read total 112575 rows
2022-07-27 19:07:33.277 Read data with sql
2022-07-27 19:07:33.278 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:07:34.746 finish read total 112968 rows
2022-07-27 19:07:37.489 Read data with sql
2022-07-27 19:07:37.489 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:07:38.949 finish read total 112974 rows
2022-07-27 19:07:39.181 Read data with sql
2022-07-27 19:07:39.181 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:07:40.614 finish read total 112974 rows
2022-07-27 19:09:54.823 Read data with sql
2022-07-27 19:09:54.824 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:09:56.296 finish read total 113385 rows
2022-07-27 19:09:59.009 Read data with sql
2022-07-27 19:09:59.010 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:10:00.478 finish read total 113385 rows
2022-07-27 19:10:00.710 Read data with sql
2022-07-27 19:10:00.710 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:10:02.158 finish read total 113385 rows
2022-07-27 19:10:05.822 Read data with sql
2022-07-27 19:10:05.822 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:10:07.278 finish read total 113487 rows
2022-07-27 19:11:36.836 Read data with sql
2022-07-27 19:11:36.836 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:11:38.286 finish read total 113601 rows
2022-07-27 19:11:42.146 Read data with sql
2022-07-27 19:11:42.146 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:11:43.805 finish read total 113601 rows
2022-07-27 19:11:44.042 Read data with sql
2022-07-27 19:11:44.042 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:11:45.479 finish read total 113601 rows
2022-07-27 19:11:47.818 Read data with sql
2022-07-27 19:11:47.818 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:11:49.286 finish read total 113601 rows
2022-07-27 19:28:54.910 Read data with sql
2022-07-27 19:28:54.910 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:28:56.432 finish read total 117492 rows
2022-07-27 19:28:59.976 Read data with sql
2022-07-27 19:28:59.976 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 19:29:01.468 finish read total 117492 rows
2022-07-27 23:24:23.588 Read data with sql
2022-07-27 23:24:23.588 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 23:24:27.912 finish read total 136516 rows
2022-07-27 23:24:33.875 Read data with sql
2022-07-27 23:24:33.876 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 23:24:35.606 finish read total 136516 rows
2022-07-27 23:24:35.873 Read data with sql
2022-07-27 23:24:35.873 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 23:24:37.638 finish read total 136516 rows
2022-07-27 23:24:41.647 Read data with sql
2022-07-27 23:24:41.647 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-27 23:24:43.414 finish read total 136516 rows
2022-07-28 05:00:00,063 - tool.dba - INFO - Read data with sql
2022-07-28 05:00:00,064 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:00:00,383 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:00:00,384 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-28 05:00:00,384 - tool.dba - INFO - Read data with sql
2022-07-28 05:00:00,384 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-28 05:01:00,964 - tool.dba - INFO - finish read total 6506676 rows
2022-07-28 05:01:16,216 - tool.dba - INFO - Read data with sql
2022-07-28 05:01:16,217 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:01:16,497 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:01:16,497 - tool.dba - INFO - Read data with sql
2022-07-28 05:01:16,497 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-28 05:01:16,513 - tool.dba - INFO - finish read total 2557 rows
2022-07-28 05:03:56,013 - tool.dba - INFO - Read data with sql
2022-07-28 05:03:56,013 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:03:56,269 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:03:56,270 - tool.dba - INFO - Delete data with sql
2022-07-28 05:03:56,328 - tool.dba - INFO - Create data with sql
2022-07-28 05:03:56,329 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint Z20220728050356_pk primary key (STORE_ID,DS)
        )
        
2022-07-28 05:03:56,357 - tool.dba - INFO - Read data with sql
2022-07-28 05:03:56,357 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:03:56,595 - tool.dba - INFO - finish read total 8008 rows
2022-07-28 05:03:56,596 - tool.dba - INFO - create table finish
2022-07-28 05:03:56,596 - tool.dba - INFO - insert data with sql
2022-07-28 05:03:56,736 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:06,  7.08it/s]  4%|▍         | 2/46 [00:00<00:05,  8.54it/s]  9%|▊         | 4/46 [00:00<00:04,  9.41it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.88it/s] 17%|█▋        | 8/46 [00:00<00:03,  9.51it/s] 22%|██▏       | 10/46 [00:01<00:03,  9.81it/s] 24%|██▍       | 11/46 [00:01<00:03,  9.06it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.54it/s] 30%|███       | 14/46 [00:01<00:03,  9.47it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.63it/s] 37%|███▋      | 17/46 [00:01<00:03,  9.26it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.61it/s] 43%|████▎     | 20/46 [00:02<00:03,  8.60it/s] 48%|████▊     | 22/46 [00:02<00:02,  9.20it/s] 52%|█████▏    | 24/46 [00:02<00:02,  9.57it/s] 54%|█████▍    | 25/46 [00:02<00:02,  8.87it/s] 59%|█████▊    | 27/46 [00:02<00:02,  9.28it/s] 63%|██████▎   | 29/46 [00:03<00:01,  9.63it/s] 65%|██████▌   | 30/46 [00:03<00:01,  8.92it/s] 70%|██████▉   | 32/46 [00:03<00:01,  9.34it/s] 74%|███████▍  | 34/46 [00:03<00:01,  8.92it/s] 78%|███████▊  | 36/46 [00:03<00:01,  9.41it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.68it/s] 85%|████████▍ | 39/46 [00:04<00:00,  9.03it/s] 89%|████████▉ | 41/46 [00:04<00:00,  9.24it/s] 93%|█████████▎| 43/46 [00:04<00:00,  9.57it/s] 96%|█████████▌| 44/46 [00:04<00:00,  8.98it/s]100%|██████████| 46/46 [00:04<00:00, 10.07it/s]100%|██████████| 46/46 [00:04<00:00,  9.33it/s]
2022-07-28 05:04:01,669 - tool.dba - INFO - insert finish
2022-07-28 05:04:01,673 - tool.dba - INFO - Delete data with sql
2022-07-28 05:04:01,674 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-28 05:04:21,913 - tool.dba - INFO - Delete data finish
2022-07-28 05:04:21,987 - tool.dba - INFO - insert data with sql
2022-07-28 05:04:22,132 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04,  9.88it/s]  7%|▋         | 3/46 [00:00<00:05,  7.86it/s]  9%|▊         | 4/46 [00:00<00:05,  8.19it/s] 11%|█         | 5/46 [00:00<00:04,  8.48it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.59it/s] 15%|█▌        | 7/46 [00:00<00:04,  8.74it/s] 17%|█▋        | 8/46 [00:00<00:04,  7.72it/s] 20%|█▉        | 9/46 [00:01<00:04,  8.02it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.22it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.39it/s] 26%|██▌       | 12/46 [00:01<00:04,  8.48it/s] 28%|██▊       | 13/46 [00:01<00:04,  7.65it/s] 30%|███       | 14/46 [00:01<00:04,  7.90it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.07it/s] 35%|███▍      | 16/46 [00:01<00:03,  8.22it/s] 37%|███▋      | 17/46 [00:02<00:03,  7.37it/s] 39%|███▉      | 18/46 [00:02<00:03,  7.74it/s] 41%|████▏     | 19/46 [00:02<00:03,  8.00it/s] 43%|████▎     | 20/46 [00:02<00:03,  8.23it/s] 46%|████▌     | 21/46 [00:02<00:02,  8.36it/s] 48%|████▊     | 22/46 [00:02<00:03,  7.52it/s] 50%|█████     | 23/46 [00:02<00:02,  7.87it/s] 52%|█████▏    | 24/46 [00:02<00:02,  8.07it/s] 54%|█████▍    | 25/46 [00:03<00:02,  8.30it/s] 57%|█████▋    | 26/46 [00:03<00:02,  8.35it/s] 59%|█████▊    | 27/46 [00:03<00:02,  7.26it/s] 61%|██████    | 28/46 [00:03<00:02,  7.47it/s] 63%|██████▎   | 29/46 [00:03<00:02,  7.65it/s] 65%|██████▌   | 30/46 [00:03<00:02,  7.91it/s] 67%|██████▋   | 31/46 [00:03<00:01,  8.15it/s] 70%|██████▉   | 32/46 [00:04<00:01,  7.43it/s] 72%|███████▏  | 33/46 [00:04<00:01,  7.43it/s] 74%|███████▍  | 34/46 [00:04<00:01,  7.80it/s] 76%|███████▌  | 35/46 [00:04<00:01,  8.01it/s] 78%|███████▊  | 36/46 [00:04<00:01,  7.23it/s] 80%|████████  | 37/46 [00:04<00:01,  7.54it/s] 83%|████████▎ | 38/46 [00:04<00:01,  7.82it/s] 85%|████████▍ | 39/46 [00:04<00:00,  8.10it/s] 87%|████████▋ | 40/46 [00:05<00:00,  8.26it/s] 89%|████████▉ | 41/46 [00:05<00:00,  7.47it/s] 91%|█████████▏| 42/46 [00:05<00:00,  7.87it/s] 93%|█████████▎| 43/46 [00:05<00:00,  8.14it/s] 96%|█████████▌| 44/46 [00:05<00:00,  8.32it/s] 98%|█████████▊| 45/46 [00:05<00:00,  8.43it/s]100%|██████████| 46/46 [00:05<00:00,  8.41it/s]100%|██████████| 46/46 [00:05<00:00,  8.00it/s]
2022-07-28 05:04:27,885 - tool.dba - INFO - insert finish
2022-07-28 05:04:27,940 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-28 05:04:27,941 - tool.dba - INFO - Read data with sql
2022-07-28 05:04:27,941 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-28 05:05:13,206 - tool.dba - INFO - finish read total 4776447 rows
2022-07-28 05:05:14,041 - tool.dba - INFO - Read data with sql
2022-07-28 05:05:14,041 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-28 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-28 05:05:54,150 - tool.dba - INFO - finish read total 4414409 rows
2022-07-28 05:05:55,287 - tool.dba - INFO - Read data with sql
2022-07-28 05:05:55,287 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-28 05:05:55,314 - tool.dba - INFO - finish read total 825 rows
2022-07-28 05:05:55,314 - tool.dba - INFO - Read data with sql
2022-07-28 05:05:55,314 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-28 05:05:55,340 - tool.dba - INFO - finish read total 5157 rows
2022-07-28 05:06:58,132 - tool.dba - INFO - Read data with sql
2022-07-28 05:06:58,132 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:06:58,383 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:06:58,383 - tool.dba - INFO - Read data with sql
2022-07-28 05:06:58,383 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-28 05:06:58,399 - tool.dba - INFO - finish read total 2557 rows
2022-07-28 05:07:10,382 - tool.dba - INFO - Read data with sql
2022-07-28 05:07:10,382 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-28 05:07:10,421 - tool.dba - INFO - finish read total 5451 rows
2022-07-28 05:07:10,725 - tool.dba - INFO - Read data with sql
2022-07-28 05:07:10,725 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:07:10,975 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:07:10,976 - tool.dba - INFO - Delete data with sql
2022-07-28 05:07:10,984 - tool.dba - INFO - Create data with sql
2022-07-28 05:07:10,985 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint I20220728050710_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-28 05:07:11,012 - tool.dba - INFO - Read data with sql
2022-07-28 05:07:11,012 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:07:11,238 - tool.dba - INFO - finish read total 8008 rows
2022-07-28 05:07:11,240 - tool.dba - INFO - create table finish
2022-07-28 05:07:11,240 - tool.dba - INFO - insert data with sql
2022-07-28 05:07:11,255 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 13.22it/s]
2022-07-28 05:07:11,331 - tool.dba - INFO - insert finish
2022-07-28 05:07:11,333 - tool.dba - INFO - Delete data with sql
2022-07-28 05:07:11,333 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-28 05:07:11,492 - tool.dba - INFO - Delete data finish
2022-07-28 05:07:11,562 - tool.dba - INFO - insert data with sql
2022-07-28 05:07:11,587 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  6.22it/s]100%|██████████| 1/1 [00:00<00:00,  6.20it/s]
2022-07-28 05:07:11,749 - tool.dba - INFO - insert finish
2022-07-28 05:07:11,762 - tool.dba - INFO - Read data with sql
2022-07-28 05:07:11,763 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-28 05:07:25,813 - tool.dba - INFO - finish read total 12224 rows
2022-07-28 05:07:26,018 - tool.dba - INFO - Read data with sql
2022-07-28 05:07:26,018 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-28 05:09:27,250 - tool.dba - INFO - finish read total 5984139 rows
2022-07-28 05:09:39,243 - tool.dba - INFO - Read data with sql
2022-07-28 05:09:39,243 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:09:39,496 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:09:39,496 - tool.dba - INFO - Read data with sql
2022-07-28 05:09:39,497 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-28 05:09:39,512 - tool.dba - INFO - finish read total 2557 rows
2022-07-28 05:11:27,905 - tool.dba - INFO - Read data with sql
2022-07-28 05:11:27,905 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:11:28,181 - tool.dba - INFO - finish read total 8007 rows
2022-07-28 05:11:28,183 - tool.dba - INFO - Delete data with sql
2022-07-28 05:11:28,187 - tool.dba - INFO - Create data with sql
2022-07-28 05:11:28,188 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint T20220728051128_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-28 05:11:28,215 - tool.dba - INFO - Read data with sql
2022-07-28 05:11:28,215 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:11:28,455 - tool.dba - INFO - finish read total 8008 rows
2022-07-28 05:11:28,456 - tool.dba - INFO - create table finish
2022-07-28 05:11:28,456 - tool.dba - INFO - insert data with sql
2022-07-28 05:11:28,464 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 44.44it/s]
2022-07-28 05:11:28,487 - tool.dba - INFO - insert finish
2022-07-28 05:11:28,488 - tool.dba - INFO - Delete data with sql
2022-07-28 05:11:28,488 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-28 05:11:28,515 - tool.dba - INFO - Delete data finish
2022-07-28 05:11:28,547 - tool.dba - INFO - insert data with sql
2022-07-28 05:11:28,557 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 56.40it/s]
2022-07-28 05:11:28,576 - tool.dba - INFO - insert finish
2022-07-28 05:11:28,581 - tool.dba - INFO - Read data with sql
2022-07-28 05:11:28,581 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-28 05:11:29,701 - tool.dba - INFO - finish read total 169606 rows
2022-07-28 05:11:29,701 - tool.dba - INFO - Read data with sql
2022-07-28 05:11:29,701 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-28 05:11:41,599 - tool.dba - INFO - finish read total 98230 rows
2022-07-28 05:11:41,867 - tool.dba - INFO - Read data with sql
2022-07-28 05:11:41,867 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-28 05:11:53,995 - tool.dba - INFO - finish read total 934713 rows
2022-07-28 05:11:53,995 - tool.dba - INFO - Read data with sql
2022-07-28 05:11:53,995 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-28 05:12:04,642 - tool.dba - INFO - finish read total 1092847 rows
2022-07-28 05:12:04,642 - tool.dba - INFO - Read data with sql
2022-07-28 05:12:04,642 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-28 05:12:17,221 - tool.dba - INFO - finish read total 1239571 rows
2022-07-28 05:12:17,221 - tool.dba - INFO - Read data with sql
2022-07-28 05:12:17,221 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-28 05:12:25,359 - tool.dba - INFO - finish read total 1025968 rows
2022-07-28 05:12:25,359 - tool.dba - INFO - Read data with sql
2022-07-28 05:12:25,359 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-28 05:12:38,567 - tool.dba - INFO - finish read total 1407608 rows
2022-07-28 05:12:38,567 - tool.dba - INFO - Read data with sql
2022-07-28 05:12:38,567 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-28 05:12:48,327 - tool.dba - INFO - finish read total 1191375 rows
2022-07-28 05:13:17,770 - tool.dba - INFO - Read data with sql
2022-07-28 05:13:17,770 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-28 05:13:17,806 - tool.dba - INFO - finish read total 3253 rows
2022-07-28 05:13:21,186 - tool.dba - INFO - Delete data with sql
2022-07-28 05:13:21,341 - tool.dba - INFO - Create data with sql
2022-07-28 05:13:21,341 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint E20220728051321_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-28 05:13:21,368 - tool.dba - INFO - Read data with sql
2022-07-28 05:13:21,368 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-28 05:13:21,599 - tool.dba - INFO - finish read total 8008 rows
2022-07-28 05:13:21,600 - tool.dba - INFO - create table finish
2022-07-28 05:13:21,600 - tool.dba - INFO - insert data with sql
2022-07-28 05:13:21,971 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.88it/s]  7%|▋         | 2/30 [00:00<00:03,  7.31it/s] 10%|█         | 3/30 [00:00<00:04,  6.73it/s] 13%|█▎        | 4/30 [00:00<00:03,  6.67it/s] 17%|█▋        | 5/30 [00:00<00:03,  6.86it/s] 20%|██        | 6/30 [00:00<00:03,  6.74it/s] 23%|██▎       | 7/30 [00:01<00:03,  6.75it/s] 27%|██▋       | 8/30 [00:01<00:03,  6.04it/s] 30%|███       | 9/30 [00:01<00:03,  6.19it/s] 33%|███▎      | 10/30 [00:01<00:03,  6.40it/s] 37%|███▋      | 11/30 [00:01<00:02,  6.74it/s] 40%|████      | 12/30 [00:01<00:02,  6.34it/s] 43%|████▎     | 13/30 [00:01<00:02,  6.72it/s] 47%|████▋     | 14/30 [00:02<00:02,  6.83it/s] 50%|█████     | 15/30 [00:02<00:02,  7.04it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.08it/s] 57%|█████▋    | 17/30 [00:02<00:02,  6.39it/s] 60%|██████    | 18/30 [00:02<00:01,  6.60it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.72it/s] 67%|██████▋   | 20/30 [00:02<00:01,  6.92it/s] 70%|███████   | 21/30 [00:03<00:01,  7.22it/s] 73%|███████▎  | 22/30 [00:03<00:01,  6.58it/s] 77%|███████▋  | 23/30 [00:03<00:01,  6.90it/s] 80%|████████  | 24/30 [00:03<00:00,  7.09it/s] 83%|████████▎ | 25/30 [00:03<00:00,  7.10it/s] 87%|████████▋ | 26/30 [00:03<00:00,  7.08it/s] 90%|█████████ | 27/30 [00:04<00:00,  6.34it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.50it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.60it/s]100%|██████████| 30/30 [00:04<00:00,  6.92it/s]
2022-07-28 05:13:26,308 - tool.dba - INFO - insert finish
2022-07-28 05:13:26,318 - tool.dba - INFO - Delete data with sql
2022-07-28 05:13:26,318 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-28 05:13:38,785 - tool.dba - INFO - Delete data finish
2022-07-28 05:13:38,856 - tool.dba - INFO - insert data with sql
2022-07-28 05:13:39,329 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  4.05it/s]  7%|▋         | 2/30 [00:00<00:08,  3.44it/s] 10%|█         | 3/30 [00:00<00:07,  3.61it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.70it/s] 17%|█▋        | 5/30 [00:01<00:07,  3.46it/s] 20%|██        | 6/30 [00:01<00:06,  3.57it/s] 23%|██▎       | 7/30 [00:01<00:06,  3.60it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.42it/s] 30%|███       | 9/30 [00:02<00:06,  3.47it/s] 33%|███▎      | 10/30 [00:02<00:05,  3.49it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.38it/s] 40%|████      | 12/30 [00:03<00:05,  3.52it/s] 43%|████▎     | 13/30 [00:03<00:04,  3.61it/s] 47%|████▋     | 14/30 [00:04<00:09,  1.75it/s] 50%|█████     | 15/30 [00:05<00:07,  2.08it/s] 53%|█████▎    | 16/30 [00:05<00:05,  2.40it/s] 57%|█████▋    | 17/30 [00:05<00:04,  2.69it/s] 60%|██████    | 18/30 [00:06<00:04,  2.81it/s] 63%|██████▎   | 19/30 [00:06<00:03,  3.00it/s] 67%|██████▋   | 20/30 [00:06<00:03,  3.15it/s] 70%|███████   | 21/30 [00:06<00:02,  3.13it/s] 73%|███████▎  | 22/30 [00:07<00:02,  3.28it/s] 77%|███████▋  | 23/30 [00:07<00:02,  3.36it/s] 80%|████████  | 24/30 [00:07<00:01,  3.28it/s] 83%|████████▎ | 25/30 [00:08<00:01,  3.34it/s] 87%|████████▋ | 26/30 [00:08<00:01,  3.38it/s] 90%|█████████ | 27/30 [00:11<00:03,  1.04s/it] 93%|█████████▎| 28/30 [00:11<00:01,  1.23it/s] 97%|█████████▋| 29/30 [00:11<00:00,  1.52it/s]100%|██████████| 30/30 [00:11<00:00,  2.55it/s]
2022-07-28 05:13:51,099 - tool.dba - INFO - insert finish
2022-07-28 11:57:43.741 Read data with sql
2022-07-28 11:57:43.741 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-28 11:57:43.802 Read data with sql
2022-07-28 11:57:43.803 
        SELECT TRUNC(DOC_DATE)        AS 要货日期,
               TRUNC(RS.POSTING_DATE) AS 业务日期,
               DPH.DESCRIPTION        AS 窗口名称,
               RSI.PRODUCT_ID         AS 产品编号,
               PLU.PRODUCT_NAME       AS 产品名称,
               DPI.SEQUENCE_NUM       AS 编号,
               RS.PRODUCT_STORE_ID    AS 门店编号,
               ORG.STORE_NAME         AS 门店名称,
               RSI.QUANTITY      AS 要货数量
        FROM REPLENISHMENT RS 
                 INNER JOIN REPLENISHMENT_ITEM RSI
                            ON RS.DOC_ID = RSI.DOC_ID AND RS.POSTING_DATE >= TRUNC(SYSDATE + 1) 
                            AND DOC_DATE >= TRUNC(SYSDATE - 2) AND RS.POSTING_DATE <= TRUNC(SYSDATE + 2) 
                 LEFT JOIN PRODUCT_STORE ORG ON ORG.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN PRODUCT PLU ON RSI.PRODUCT_ID = PLU.PRODUCT_ID
                 LEFT JOIN DELIVERY_PLAN_ITEM DPI ON DPI.PRODUCT_STORE_ID = RS.PRODUCT_STORE_ID
                 LEFT JOIN DELIVERY_PLAN_HEADER DPH ON DPH.DOC_ID = DPI.DOC_ID
        WHERE 1 = 1
          AND RS.DOC_STATUS NOT IN ('4', '6')
           AND REPLENISH_STORE_ID = '7201' 
           AND DPH.DESCRIPTION is not null
           AND TRUNC(DOC_DATE) != TRUNC(RS.POSTING_DATE)
                 
2022-07-29 05:00:00,820 - tool.dba - INFO - Read data with sql
2022-07-29 05:00:00,820 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:00:01,145 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:00:01,146 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-29 05:00:01,146 - tool.dba - INFO - Read data with sql
2022-07-29 05:00:01,146 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-29 05:01:00,242 - tool.dba - INFO - finish read total 6511853 rows
2022-07-29 05:01:15,533 - tool.dba - INFO - Read data with sql
2022-07-29 05:01:15,534 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:01:15,804 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:01:15,805 - tool.dba - INFO - Read data with sql
2022-07-29 05:01:15,805 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-29 05:01:15,822 - tool.dba - INFO - finish read total 2557 rows
2022-07-29 05:03:56,066 - tool.dba - INFO - Read data with sql
2022-07-29 05:03:56,067 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:03:56,339 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:03:56,340 - tool.dba - INFO - Delete data with sql
2022-07-29 05:03:56,402 - tool.dba - INFO - Create data with sql
2022-07-29 05:03:56,402 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint G20220729050356_pk primary key (STORE_ID,DS)
        )
        
2022-07-29 05:03:56,514 - tool.dba - INFO - Read data with sql
2022-07-29 05:03:56,515 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:03:56,755 - tool.dba - INFO - finish read total 8008 rows
2022-07-29 05:03:56,757 - tool.dba - INFO - create table finish
2022-07-29 05:03:56,757 - tool.dba - INFO - insert data with sql
2022-07-29 05:03:56,893 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:07,  6.15it/s]  4%|▍         | 2/46 [00:00<00:05,  7.64it/s]  7%|▋         | 3/46 [00:00<00:05,  8.46it/s]  9%|▊         | 4/46 [00:00<00:04,  8.76it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.51it/s] 17%|█▋        | 8/46 [00:00<00:04,  9.07it/s] 22%|██▏       | 10/46 [00:01<00:04,  8.72it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.59it/s] 28%|██▊       | 13/46 [00:01<00:03,  9.07it/s] 30%|███       | 14/46 [00:01<00:03,  8.60it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.05it/s] 37%|███▋      | 17/46 [00:01<00:03,  8.69it/s] 39%|███▉      | 18/46 [00:02<00:03,  8.90it/s] 43%|████▎     | 20/46 [00:02<00:02,  8.91it/s] 48%|████▊     | 22/46 [00:02<00:02,  9.49it/s] 52%|█████▏    | 24/46 [00:02<00:02, 10.04it/s] 57%|█████▋    | 26/46 [00:02<00:02,  9.75it/s] 61%|██████    | 28/46 [00:03<00:01,  9.78it/s] 63%|██████▎   | 29/46 [00:03<00:01,  9.08it/s] 67%|██████▋   | 31/46 [00:03<00:01,  9.84it/s] 70%|██████▉   | 32/46 [00:03<00:01,  9.77it/s] 74%|███████▍  | 34/46 [00:03<00:01,  9.04it/s] 78%|███████▊  | 36/46 [00:03<00:01,  9.65it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.99it/s] 87%|████████▋ | 40/46 [00:04<00:00,  9.41it/s] 91%|█████████▏| 42/46 [00:04<00:00,  9.59it/s] 96%|█████████▌| 44/46 [00:04<00:00,  9.22it/s] 98%|█████████▊| 45/46 [00:04<00:00,  9.24it/s]100%|██████████| 46/46 [00:04<00:00,  9.24it/s]
2022-07-29 05:04:01,871 - tool.dba - INFO - insert finish
2022-07-29 05:04:01,875 - tool.dba - INFO - Delete data with sql
2022-07-29 05:04:01,875 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-29 05:04:21,543 - tool.dba - INFO - Delete data finish
2022-07-29 05:04:21,712 - tool.dba - INFO - insert data with sql
2022-07-29 05:04:21,857 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:04,  9.83it/s]  7%|▋         | 3/46 [00:00<00:05,  8.10it/s]  9%|▊         | 4/46 [00:00<00:05,  8.28it/s] 11%|█         | 5/46 [00:00<00:04,  8.49it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.60it/s] 15%|█▌        | 7/46 [00:00<00:05,  7.55it/s] 17%|█▋        | 8/46 [00:00<00:04,  7.82it/s] 20%|█▉        | 9/46 [00:01<00:04,  7.98it/s] 22%|██▏       | 10/46 [00:01<00:04,  7.97it/s] 24%|██▍       | 11/46 [00:01<00:04,  8.17it/s] 26%|██▌       | 12/46 [00:01<00:04,  7.42it/s] 28%|██▊       | 13/46 [00:01<00:04,  7.80it/s] 30%|███       | 14/46 [00:01<00:03,  8.06it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.54it/s] 35%|███▍      | 16/46 [00:04<00:30,  1.03s/it] 37%|███▋      | 17/46 [00:05<00:22,  1.31it/s] 41%|████▏     | 19/46 [00:05<00:12,  2.19it/s] 46%|████▌     | 21/46 [00:05<00:07,  3.15it/s] 48%|████▊     | 22/46 [00:05<00:06,  3.51it/s] 50%|█████     | 23/46 [00:05<00:05,  4.10it/s] 52%|█████▏    | 24/46 [00:05<00:04,  4.70it/s] 54%|█████▍    | 25/46 [00:06<00:03,  5.32it/s] 57%|█████▋    | 26/46 [00:06<00:03,  5.42it/s] 59%|█████▊    | 27/46 [00:06<00:03,  6.09it/s] 61%|██████    | 28/46 [00:06<00:02,  6.59it/s] 63%|██████▎   | 29/46 [00:06<00:02,  6.94it/s] 65%|██████▌   | 30/46 [00:06<00:02,  7.30it/s] 67%|██████▋   | 31/46 [00:06<00:02,  6.82it/s] 70%|██████▉   | 32/46 [00:07<00:01,  7.22it/s] 72%|███████▏  | 33/46 [00:07<00:01,  7.54it/s] 74%|███████▍  | 34/46 [00:07<00:01,  7.86it/s] 76%|███████▌  | 35/46 [00:07<00:01,  7.90it/s] 78%|███████▊  | 36/46 [00:07<00:01,  7.45it/s] 83%|████████▎ | 38/46 [00:07<00:00,  8.19it/s] 85%|████████▍ | 39/46 [00:07<00:00,  8.26it/s] 87%|████████▋ | 40/46 [00:07<00:00,  8.38it/s] 89%|████████▉ | 41/46 [00:08<00:00,  7.50it/s] 91%|█████████▏| 42/46 [00:08<00:00,  7.66it/s] 93%|█████████▎| 43/46 [00:08<00:00,  7.81it/s] 96%|█████████▌| 44/46 [00:08<00:00,  8.30it/s] 98%|█████████▊| 45/46 [00:08<00:00,  7.40it/s]100%|██████████| 46/46 [00:08<00:00,  5.25it/s]
2022-07-29 05:04:30,614 - tool.dba - INFO - insert finish
2022-07-29 05:04:30,670 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-29 05:04:30,672 - tool.dba - INFO - Read data with sql
2022-07-29 05:04:30,672 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-29 05:05:16,921 - tool.dba - INFO - finish read total 4776447 rows
2022-07-29 05:05:17,768 - tool.dba - INFO - Read data with sql
2022-07-29 05:05:17,768 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-29 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-29 05:06:00,395 - tool.dba - INFO - finish read total 4577273 rows
2022-07-29 05:06:01,540 - tool.dba - INFO - Read data with sql
2022-07-29 05:06:01,541 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-29 05:06:01,560 - tool.dba - INFO - finish read total 825 rows
2022-07-29 05:06:01,560 - tool.dba - INFO - Read data with sql
2022-07-29 05:06:01,560 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-29 05:06:01,584 - tool.dba - INFO - finish read total 5170 rows
2022-07-29 05:07:05,187 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:05,188 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:07:05,451 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:07:05,452 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:05,452 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-29 05:07:05,467 - tool.dba - INFO - finish read total 2557 rows
2022-07-29 05:07:17,375 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:17,376 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-29 05:07:17,417 - tool.dba - INFO - finish read total 5455 rows
2022-07-29 05:07:17,724 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:17,724 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:07:17,966 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:07:17,967 - tool.dba - INFO - Delete data with sql
2022-07-29 05:07:17,975 - tool.dba - INFO - Create data with sql
2022-07-29 05:07:17,976 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint M20220729050717_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-29 05:07:18,006 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:18,007 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:07:18,247 - tool.dba - INFO - finish read total 8008 rows
2022-07-29 05:07:18,248 - tool.dba - INFO - create table finish
2022-07-29 05:07:18,248 - tool.dba - INFO - insert data with sql
2022-07-29 05:07:18,265 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 11.14it/s]
2022-07-29 05:07:18,355 - tool.dba - INFO - insert finish
2022-07-29 05:07:18,357 - tool.dba - INFO - Delete data with sql
2022-07-29 05:07:18,357 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-29 05:07:18,586 - tool.dba - INFO - Delete data finish
2022-07-29 05:07:18,624 - tool.dba - INFO - insert data with sql
2022-07-29 05:07:18,649 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.27it/s]100%|██████████| 1/1 [00:00<00:00,  4.03it/s]
2022-07-29 05:07:18,897 - tool.dba - INFO - insert finish
2022-07-29 05:07:18,908 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:18,908 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-29 05:07:33,110 - tool.dba - INFO - finish read total 12234 rows
2022-07-29 05:07:33,314 - tool.dba - INFO - Read data with sql
2022-07-29 05:07:33,314 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-29 05:09:24,394 - tool.dba - INFO - finish read total 5989241 rows
2022-07-29 05:09:36,425 - tool.dba - INFO - Read data with sql
2022-07-29 05:09:36,425 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:09:36,727 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:09:36,727 - tool.dba - INFO - Read data with sql
2022-07-29 05:09:36,727 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-29 05:09:36,743 - tool.dba - INFO - finish read total 2557 rows
2022-07-29 05:11:25,484 - tool.dba - INFO - Read data with sql
2022-07-29 05:11:25,484 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:11:25,737 - tool.dba - INFO - finish read total 8007 rows
2022-07-29 05:11:25,738 - tool.dba - INFO - Delete data with sql
2022-07-29 05:11:25,742 - tool.dba - INFO - Create data with sql
2022-07-29 05:11:25,743 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint T20220729051125_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-29 05:11:25,770 - tool.dba - INFO - Read data with sql
2022-07-29 05:11:25,770 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:11:26,015 - tool.dba - INFO - finish read total 8008 rows
2022-07-29 05:11:26,017 - tool.dba - INFO - create table finish
2022-07-29 05:11:26,017 - tool.dba - INFO - insert data with sql
2022-07-29 05:11:26,024 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 46.30it/s]
2022-07-29 05:11:26,047 - tool.dba - INFO - insert finish
2022-07-29 05:11:26,047 - tool.dba - INFO - Delete data with sql
2022-07-29 05:11:26,047 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-29 05:11:26,072 - tool.dba - INFO - Delete data finish
2022-07-29 05:11:26,100 - tool.dba - INFO - insert data with sql
2022-07-29 05:11:26,111 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 57.04it/s]
2022-07-29 05:11:26,129 - tool.dba - INFO - insert finish
2022-07-29 05:11:26,134 - tool.dba - INFO - Read data with sql
2022-07-29 05:11:26,134 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-29 05:11:27,297 - tool.dba - INFO - finish read total 169653 rows
2022-07-29 05:11:27,297 - tool.dba - INFO - Read data with sql
2022-07-29 05:11:27,297 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-29 05:11:45,561 - tool.dba - INFO - finish read total 98143 rows
2022-07-29 05:11:45,837 - tool.dba - INFO - Read data with sql
2022-07-29 05:11:45,837 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-29 05:11:57,717 - tool.dba - INFO - finish read total 934458 rows
2022-07-29 05:11:57,718 - tool.dba - INFO - Read data with sql
2022-07-29 05:11:57,718 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-29 05:12:08,002 - tool.dba - INFO - finish read total 1091261 rows
2022-07-29 05:12:08,002 - tool.dba - INFO - Read data with sql
2022-07-29 05:12:08,002 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-29 05:12:20,563 - tool.dba - INFO - finish read total 1241727 rows
2022-07-29 05:12:20,563 - tool.dba - INFO - Read data with sql
2022-07-29 05:12:20,563 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-29 05:12:28,900 - tool.dba - INFO - finish read total 1017986 rows
2022-07-29 05:12:28,900 - tool.dba - INFO - Read data with sql
2022-07-29 05:12:28,900 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-29 05:12:42,499 - tool.dba - INFO - finish read total 1418418 rows
2022-07-29 05:12:42,499 - tool.dba - INFO - Read data with sql
2022-07-29 05:12:42,500 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-29 05:12:52,487 - tool.dba - INFO - finish read total 1190686 rows
2022-07-29 05:13:22,002 - tool.dba - INFO - Read data with sql
2022-07-29 05:13:22,002 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-29 05:13:22,035 - tool.dba - INFO - finish read total 3254 rows
2022-07-29 05:13:25,567 - tool.dba - INFO - Delete data with sql
2022-07-29 05:13:25,719 - tool.dba - INFO - Create data with sql
2022-07-29 05:13:25,719 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint R20220729051325_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-29 05:13:25,748 - tool.dba - INFO - Read data with sql
2022-07-29 05:13:25,748 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-29 05:13:25,997 - tool.dba - INFO - finish read total 8008 rows
2022-07-29 05:13:25,998 - tool.dba - INFO - create table finish
2022-07-29 05:13:25,998 - tool.dba - INFO - insert data with sql
2022-07-29 05:13:26,366 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  7.40it/s]  7%|▋         | 2/30 [00:00<00:03,  7.26it/s] 10%|█         | 3/30 [00:00<00:03,  7.35it/s] 13%|█▎        | 4/30 [00:00<00:03,  7.49it/s] 17%|█▋        | 5/30 [00:00<00:03,  7.45it/s] 20%|██        | 6/30 [00:00<00:03,  7.09it/s] 23%|██▎       | 7/30 [00:00<00:03,  6.95it/s] 27%|██▋       | 8/30 [00:01<00:03,  6.81it/s] 30%|███       | 9/30 [00:01<00:03,  6.93it/s] 33%|███▎      | 10/30 [00:01<00:02,  6.96it/s] 37%|███▋      | 11/30 [00:01<00:02,  7.27it/s] 40%|████      | 12/30 [00:01<00:02,  7.57it/s] 43%|████▎     | 13/30 [00:01<00:02,  6.93it/s] 47%|████▋     | 14/30 [00:01<00:02,  7.17it/s] 50%|█████     | 15/30 [00:02<00:02,  7.29it/s] 53%|█████▎    | 16/30 [00:02<00:01,  7.28it/s] 57%|█████▋    | 17/30 [00:02<00:01,  7.16it/s] 60%|██████    | 18/30 [00:02<00:01,  6.40it/s] 63%|██████▎   | 19/30 [00:02<00:01,  6.51it/s] 67%|██████▋   | 20/30 [00:02<00:01,  6.75it/s] 70%|███████   | 21/30 [00:02<00:01,  7.08it/s] 73%|███████▎  | 22/30 [00:03<00:01,  6.39it/s] 77%|███████▋  | 23/30 [00:03<00:01,  6.70it/s] 80%|████████  | 24/30 [00:03<00:00,  6.66it/s] 83%|████████▎ | 25/30 [00:03<00:00,  6.32it/s] 87%|████████▋ | 26/30 [00:03<00:00,  6.47it/s] 90%|█████████ | 27/30 [00:03<00:00,  5.95it/s] 93%|█████████▎| 28/30 [00:04<00:00,  6.11it/s] 97%|█████████▋| 29/30 [00:04<00:00,  6.04it/s]100%|██████████| 30/30 [00:04<00:00,  6.97it/s]
2022-07-29 05:13:30,672 - tool.dba - INFO - insert finish
2022-07-29 05:13:30,682 - tool.dba - INFO - Delete data with sql
2022-07-29 05:13:30,682 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-29 05:13:41,428 - tool.dba - INFO - Delete data finish
2022-07-29 05:13:41,632 - tool.dba - INFO - insert data with sql
2022-07-29 05:13:42,117 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:07,  4.06it/s]  7%|▋         | 2/30 [00:00<00:08,  3.40it/s] 10%|█         | 3/30 [00:00<00:07,  3.58it/s] 13%|█▎        | 4/30 [00:01<00:07,  3.64it/s] 17%|█▋        | 5/30 [00:01<00:07,  3.37it/s] 20%|██        | 6/30 [00:01<00:06,  3.49it/s] 23%|██▎       | 7/30 [00:01<00:06,  3.53it/s] 27%|██▋       | 8/30 [00:02<00:06,  3.32it/s] 30%|███       | 9/30 [00:02<00:06,  3.41it/s] 33%|███▎      | 10/30 [00:02<00:05,  3.41it/s] 37%|███▋      | 11/30 [00:03<00:05,  3.42it/s] 40%|████      | 12/30 [00:03<00:05,  3.35it/s] 43%|████▎     | 13/30 [00:03<00:04,  3.50it/s] 47%|████▋     | 14/30 [00:04<00:04,  3.57it/s] 50%|█████     | 15/30 [00:04<00:04,  3.39it/s] 53%|█████▎    | 16/30 [00:04<00:04,  3.49it/s] 57%|█████▋    | 17/30 [00:04<00:03,  3.50it/s] 60%|██████    | 18/30 [00:05<00:03,  3.30it/s] 63%|██████▎   | 19/30 [00:05<00:03,  3.33it/s] 67%|██████▋   | 20/30 [00:07<00:08,  1.23it/s] 70%|███████   | 21/30 [00:07<00:05,  1.51it/s] 73%|███████▎  | 22/30 [00:08<00:04,  1.84it/s] 77%|███████▋  | 23/30 [00:08<00:03,  2.15it/s] 80%|████████  | 24/30 [00:08<00:02,  2.34it/s] 83%|████████▎ | 25/30 [00:09<00:01,  2.57it/s] 87%|████████▋ | 26/30 [00:09<00:01,  2.89it/s] 90%|█████████ | 27/30 [00:09<00:01,  3.00it/s] 93%|█████████▎| 28/30 [00:09<00:00,  3.08it/s] 97%|█████████▋| 29/30 [00:10<00:00,  3.32it/s]100%|██████████| 30/30 [00:10<00:00,  2.95it/s]
2022-07-29 05:13:52,283 - tool.dba - INFO - insert finish
2022-07-30 05:00:01,027 - tool.dba - INFO - Read data with sql
2022-07-30 05:00:01,027 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:00:01,287 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:00:01,287 - tool.store.predict - INFO - 开始执行销量预测任务
2022-07-30 05:00:01,288 - tool.dba - INFO - Read data with sql
2022-07-30 05:00:01,288 - tool.dba - INFO - 
        SELECT RPTDATE DS, ORGCODE STORE_ID, TRADETOTAL Y, (TRADETOTAL - DSCTOTAL) / TRADETOTAL DISCOUNT
        FROM TRPTSALORGRPT A -- INNER JOIN ORGVIEW B ON A.ORGCODE = B.PRODUCT_STORE_ID AND B.ORGTYPE='直营店' and B.GEO_NAME='武汉市'
        WHERE TRADETOTAL > 300
        
2022-07-30 05:01:02,842 - tool.dba - INFO - finish read total 6517001 rows
2022-07-30 05:01:18,061 - tool.dba - INFO - Read data with sql
2022-07-30 05:01:18,061 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:01:18,340 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:01:18,340 - tool.dba - INFO - Read data with sql
2022-07-30 05:01:18,340 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-30 05:01:18,357 - tool.dba - INFO - finish read total 2557 rows
2022-07-30 05:03:58,295 - tool.dba - INFO - Read data with sql
2022-07-30 05:03:58,295 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:03:58,664 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:03:58,665 - tool.dba - INFO - Delete data with sql
2022-07-30 05:03:58,724 - tool.dba - INFO - Create data with sql
2022-07-30 05:03:58,725 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_XS (
            STORE_ID		VARCHAR2(999),
DS		DATE,
            constraint W20220730050358_pk primary key (STORE_ID,DS)
        )
        
2022-07-30 05:03:58,769 - tool.dba - INFO - Read data with sql
2022-07-30 05:03:58,769 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:03:59,038 - tool.dba - INFO - finish read total 8008 rows
2022-07-30 05:03:59,039 - tool.dba - INFO - create table finish
2022-07-30 05:03:59,039 - tool.dba - INFO - insert data with sql
2022-07-30 05:03:59,178 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_XS(STORE_ID, DS) VALUES (:1, :2)
  0%|          | 0/46 [00:00<?, ?it/s]  2%|▏         | 1/46 [00:00<00:05,  7.61it/s]  4%|▍         | 2/46 [00:00<00:05,  8.80it/s]  9%|▊         | 4/46 [00:00<00:04,  9.54it/s] 13%|█▎        | 6/46 [00:00<00:04,  8.88it/s] 15%|█▌        | 7/46 [00:00<00:04,  9.13it/s] 20%|█▉        | 9/46 [00:00<00:03,  9.52it/s] 24%|██▍       | 11/46 [00:01<00:03,  8.94it/s] 26%|██▌       | 12/46 [00:01<00:03,  8.97it/s] 28%|██▊       | 13/46 [00:01<00:03,  8.85it/s] 30%|███       | 14/46 [00:01<00:03,  9.03it/s] 33%|███▎      | 15/46 [00:01<00:03,  8.36it/s] 35%|███▍      | 16/46 [00:01<00:03,  8.75it/s] 37%|███▋      | 17/46 [00:01<00:03,  8.97it/s] 41%|████▏     | 19/46 [00:02<00:02,  9.52it/s] 43%|████▎     | 20/46 [00:02<00:02,  8.69it/s] 46%|████▌     | 21/46 [00:02<00:02,  8.91it/s] 50%|█████     | 23/46 [00:02<00:02,  9.35it/s] 52%|█████▏    | 24/46 [00:02<00:02,  9.44it/s] 54%|█████▍    | 25/46 [00:02<00:02,  8.45it/s] 57%|█████▋    | 26/46 [00:02<00:02,  8.80it/s] 59%|█████▊    | 27/46 [00:03<00:02,  8.24it/s] 61%|██████    | 28/46 [00:03<00:02,  8.12it/s] 63%|██████▎   | 29/46 [00:03<00:02,  8.06it/s] 65%|██████▌   | 30/46 [00:03<00:02,  7.60it/s] 70%|██████▉   | 32/46 [00:03<00:01,  8.60it/s] 74%|███████▍  | 34/46 [00:03<00:01,  8.57it/s] 78%|███████▊  | 36/46 [00:04<00:01,  9.36it/s] 83%|████████▎ | 38/46 [00:04<00:00,  9.96it/s] 85%|████████▍ | 39/46 [00:04<00:00,  9.31it/s] 89%|████████▉ | 41/46 [00:04<00:00, 10.06it/s] 93%|█████████▎| 43/46 [00:04<00:00, 10.28it/s] 98%|█████████▊| 45/46 [00:04<00:00,  9.33it/s]100%|██████████| 46/46 [00:05<00:00,  9.10it/s]
2022-07-30 05:04:04,231 - tool.dba - INFO - insert finish
2022-07-30 05:04:04,236 - tool.dba - INFO - Delete data with sql
2022-07-30 05:04:04,236 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_XS A
            where exists (
                select 1 from DZCB_PREDICT_STORE_XS B where  A.STORE_ID = B.STORE_ID AND A.DS = B.DS )
            
2022-07-30 05:04:23,877 - tool.dba - INFO - Delete data finish
2022-07-30 05:04:24,036 - tool.dba - INFO - insert data with sql
2022-07-30 05:04:24,182 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_XS(STORE_ID, DS, TRUE, PREDICT) VALUES (:1, :2, :3, :4)
  0%|          | 0/46 [00:00<?, ?it/s]  4%|▍         | 2/46 [00:00<00:04, 10.36it/s]  9%|▊         | 4/46 [00:01<00:21,  2.00it/s] 11%|█         | 5/46 [00:01<00:15,  2.59it/s] 13%|█▎        | 6/46 [00:01<00:12,  3.27it/s] 15%|█▌        | 7/46 [00:02<00:09,  4.02it/s] 17%|█▋        | 8/46 [00:02<00:08,  4.48it/s] 20%|█▉        | 9/46 [00:02<00:07,  5.23it/s] 22%|██▏       | 10/46 [00:02<00:06,  5.95it/s] 24%|██▍       | 11/46 [00:02<00:05,  6.35it/s] 26%|██▌       | 12/46 [00:02<00:05,  6.23it/s] 28%|██▊       | 13/46 [00:02<00:04,  6.76it/s] 30%|███       | 14/46 [00:03<00:04,  7.24it/s] 33%|███▎      | 15/46 [00:03<00:04,  7.59it/s] 35%|███▍      | 16/46 [00:03<00:04,  7.40it/s] 37%|███▋      | 17/46 [00:03<00:04,  6.90it/s] 39%|███▉      | 18/46 [00:03<00:03,  7.38it/s] 41%|████▏     | 19/46 [00:03<00:03,  7.78it/s] 43%|████▎     | 20/46 [00:03<00:03,  7.91it/s] 46%|████▌     | 21/46 [00:03<00:03,  8.05it/s] 48%|████▊     | 22/46 [00:04<00:03,  7.32it/s] 50%|█████     | 23/46 [00:04<00:02,  7.71it/s] 52%|█████▏    | 24/46 [00:04<00:02,  7.93it/s] 54%|█████▍    | 25/46 [00:04<00:02,  8.12it/s] 57%|█████▋    | 26/46 [00:04<00:02,  8.27it/s] 59%|█████▊    | 27/46 [00:04<00:02,  7.50it/s] 61%|██████    | 28/46 [00:04<00:02,  7.84it/s] 63%|██████▎   | 29/46 [00:04<00:02,  8.07it/s] 65%|██████▌   | 30/46 [00:05<00:01,  8.26it/s] 67%|██████▋   | 31/46 [00:05<00:02,  7.45it/s] 70%|██████▉   | 32/46 [00:05<00:01,  7.75it/s] 72%|███████▏  | 33/46 [00:05<00:01,  8.04it/s] 74%|███████▍  | 34/46 [00:05<00:01,  8.13it/s] 76%|███████▌  | 35/46 [00:05<00:01,  8.27it/s] 78%|███████▊  | 36/46 [00:05<00:01,  7.44it/s] 80%|████████  | 37/46 [00:05<00:01,  7.77it/s] 83%|████████▎ | 38/46 [00:06<00:01,  7.74it/s] 85%|████████▍ | 39/46 [00:06<00:00,  7.98it/s] 87%|████████▋ | 40/46 [00:06<00:00,  8.15it/s] 89%|████████▉ | 41/46 [00:06<00:00,  7.02it/s] 91%|█████████▏| 42/46 [00:06<00:00,  7.43it/s] 93%|█████████▎| 43/46 [00:06<00:00,  8.05it/s] 96%|█████████▌| 44/46 [00:06<00:00,  8.29it/s] 98%|█████████▊| 45/46 [00:06<00:00,  8.45it/s]100%|██████████| 46/46 [00:08<00:00,  2.50it/s]100%|██████████| 46/46 [00:08<00:00,  5.73it/s]
2022-07-30 05:04:32,206 - tool.dba - INFO - insert finish
2022-07-30 05:04:32,264 - tool.factory.predict - INFO - Path exists: data/生产安排 
2022-07-30 05:04:32,265 - tool.dba - INFO - Read data with sql
2022-07-30 05:04:32,266 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-06-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-06-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-30 05:05:17,400 - tool.dba - INFO - finish read total 4776447 rows
2022-07-30 05:05:18,246 - tool.dba - INFO - Read data with sql
2022-07-30 05:05:18,246 - tool.dba - INFO - 
            SELECT ORGCODE STORE_ID, 
                    PLUCODE PRODUCT_ID, 
                    RPTDATE DS,
                    PLUCOUNT Y 
            FROM TZYPLUPRO_PS
            WHERE RPTDATE >= TO_DATE('2022-07-01 00:00:00','yyyy-mm-dd hh24:mi:ss') AND RPTDATE <= TO_DATE('2022-07-30 00:00:00','yyyy-mm-dd hh24:mi:ss')
            
2022-07-30 05:06:01,407 - tool.dba - INFO - finish read total 4743751 rows
2022-07-30 05:06:02,596 - tool.dba - INFO - Read data with sql
2022-07-30 05:06:02,597 - tool.dba - INFO - SELECT PRODUCT_ID FROM PLUVIEW WHERE PRODUCT_CATEGORY_NAME = '散装食品'
2022-07-30 05:06:02,620 - tool.dba - INFO - finish read total 838 rows
2022-07-30 05:06:02,620 - tool.dba - INFO - Read data with sql
2022-07-30 05:06:02,620 - tool.dba - INFO - SELECT FACTORY_ID, ORGCODE STORE_ID FROM TZYORG_YH_PS_MODE
2022-07-30 05:06:02,645 - tool.dba - INFO - finish read total 5168 rows
2022-07-30 05:07:05,045 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:05,045 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:07:05,330 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:07:05,330 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:05,330 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-30 05:07:05,346 - tool.dba - INFO - finish read total 2557 rows
2022-07-30 05:07:17,035 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:17,035 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID FACTORY_ID, PRODUCT_ID, PACK_WEGIHT YH_UNIT 
        FROM FACTORY_PRODUCT_ENABLE
        
2022-07-30 05:07:17,081 - tool.dba - INFO - finish read total 5456 rows
2022-07-30 05:07:17,387 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:17,387 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:07:17,585 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:07:17,586 - tool.dba - INFO - Delete data with sql
2022-07-30 05:07:17,595 - tool.dba - INFO - Create data with sql
2022-07-30 05:07:17,595 - tool.dba - INFO - 
        create table DZCB_PREDICT_FACTORY_YH (
            FACTORY_ID		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
RPTDATE		DATE,
            constraint T20220730050717_pk primary key (FACTORY_ID,PLUCODE,RPTDATE)
        )
        
2022-07-30 05:07:17,615 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:17,615 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:07:17,780 - tool.dba - INFO - finish read total 8008 rows
2022-07-30 05:07:17,781 - tool.dba - INFO - create table finish
2022-07-30 05:07:17,782 - tool.dba - INFO - insert data with sql
2022-07-30 05:07:17,797 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE) VALUES (:1, :2, :3)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 11.45it/s]
2022-07-30 05:07:17,885 - tool.dba - INFO - insert finish
2022-07-30 05:07:17,886 - tool.dba - INFO - Delete data with sql
2022-07-30 05:07:17,886 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_FACTORY_YH A
            where exists (
                select 1 from DZCB_PREDICT_FACTORY_YH B where  A.FACTORY_ID = B.FACTORY_ID AND A.PLUCODE = B.PLUCODE AND A.RPTDATE = B.RPTDATE )
            
2022-07-30 05:07:18,020 - tool.dba - INFO - Delete data finish
2022-07-30 05:07:18,055 - tool.dba - INFO - insert data with sql
2022-07-30 05:07:18,080 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_FACTORY_YH(FACTORY_ID, PLUCODE, RPTDATE, SUPPORT, TRUE, PREDICT, HOLIDAY_AFFECT, SAFE_STOCK, EXEDATE, ERROR, ABS_ERROR, ERROR_PERCENTAGE, ABS_ERROR_PERCENTAGE, LABEL, YH_UNIT) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  4.81it/s]100%|██████████| 1/1 [00:00<00:00,  4.79it/s]
2022-07-30 05:07:18,289 - tool.dba - INFO - insert finish
2022-07-30 05:07:18,302 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:18,302 - tool.dba - INFO - 
        -- noinspection SqlResolve
        SELECT LINE_NAME, LINE_ID, ORGCODE as STORE_ID, LINE_TYPE, TRANS_TIME
        FROM (
                 SELECT DESCRIPTION  AS LINE_NAME,
                        SCH_ID       AS LINE_ID,
                        CONSIGNEE_ID AS ORGCODE,
                        UNASSGN_END  AS TRANS_TIME,
                        SCH_TYPE     AS LINE_TYPE,
                        ROW_NUMBER()    OVER(PARTITION BY CONSIGNEE_ID, SCH_TYPE ORDER BY UNASSGN_END DESC) RN
                 FROM (
                          SELECT B.DESCRIPTION,
                                 C.LOG_LOCID,
                                 A.PARENT_KEY,
                                 -- D.SCH_TYPE,
                                 CASE WHEN D.SCH_TYPE IN ('ZS01', 'ZS02') THEN '干线' ELSE '市配' END AS SCH_TYPE,
                                 D.SCH_ID
                          FROM "/SCMTMS/D_TORITE" A
                                   INNER JOIN "/SCMTMS/D_SCHDSC" B ON B.PARENT_KEY = A.SCHED_KEY
                                   INNER JOIN "/SCMTMS/D_TORSTP" C ON A.PARENT_KEY = C.PARENT_KEY
                                   INNER JOIN "/SCMTMS/D_SCHROT" D ON D.DB_KEY = A.SCHED_KEY
                          --WHERE SCH_TYPE IN ('ZS01', 'ZS02') 
                          GROUP BY A.PARENT_KEY, C.LOG_LOCID, B.DESCRIPTION, D.SCH_TYPE, SCH_ID
                      ) E1
                          INNER JOIN (SELECT PARENT_KEY, CONSIGNEE_ID, MIN(UNASSGN_END) UNASSGN_END
                                      FROM "/SCMTMS/D_TORITE" A
                                      GROUP BY PARENT_KEY, CONSIGNEE_ID
                 ) E2 ON E1.PARENT_KEY = E2.PARENT_KEY
             )
        WHERE RN = 1
          AND LINE_NAME IS NOT NULL
          AND TRANS_TIME IS NOT NULL
          -- AND LINE_ID LIKE '%GX%'
          AND ORGCODE LIKE '%008%'
          -- AND LINE_NAME NOT LIKE '%机场%'
        ORDER BY TRANS_TIME DESC
        
2022-07-30 05:07:31,694 - tool.dba - INFO - finish read total 12255 rows
2022-07-30 05:07:31,900 - tool.dba - INFO - Read data with sql
2022-07-30 05:07:31,900 - tool.dba - INFO - 
        SELECT PRODUCT_STORE_ID_TO AS STORE_ID, POSTING_DATE DS, COUNT(*) NUMS
        FROM (SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
              UNION ALL
              SELECT DOC_ID, POSTING_DATE, PRODUCT_STORE_ID_TO
              FROM DELIVERY_DOC_HIS
              -- WHERE PRODUCT_STORE_ID_TO = '80010001'
             ) A
                 INNER JOIN (SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX
                             UNION ALL
                             SELECT DOC_ID, BOX_ID
                             FROM DELIVERY_BOX_HIS
        ) B ON A.DOC_ID = B.DOC_ID
        GROUP BY PRODUCT_STORE_ID_TO, POSTING_DATE
        
2022-07-30 05:09:36,127 - tool.dba - INFO - finish read total 5994295 rows
2022-07-30 05:09:48,061 - tool.dba - INFO - Read data with sql
2022-07-30 05:09:48,061 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:09:48,334 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:09:48,334 - tool.dba - INFO - Read data with sql
2022-07-30 05:09:48,334 - tool.dba - INFO - 
        SELECT RPTDATE DS, FESTIVALS_NL, FESTIVALS_GL
        FROM ZCB_DAY_INFO 
        ORDER BY RPTDATE
        
2022-07-30 05:09:48,349 - tool.dba - INFO - finish read total 2557 rows
2022-07-30 05:11:36,756 - tool.dba - INFO - Read data with sql
2022-07-30 05:11:36,756 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:11:37,048 - tool.dba - INFO - finish read total 8007 rows
2022-07-30 05:11:37,049 - tool.dba - INFO - Delete data with sql
2022-07-30 05:11:37,054 - tool.dba - INFO - Create data with sql
2022-07-30 05:11:37,054 - tool.dba - INFO - 
        create table DZCB_PREDICT_GX_KS (
            LINE_NAME		VARCHAR2(999),
POSTING_DATE		DATE,
            constraint I20220730051137_pk primary key (LINE_NAME,POSTING_DATE)
        )
        
2022-07-30 05:11:37,093 - tool.dba - INFO - Read data with sql
2022-07-30 05:11:37,093 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:11:37,334 - tool.dba - INFO - finish read total 8008 rows
2022-07-30 05:11:37,335 - tool.dba - INFO - create table finish
2022-07-30 05:11:37,335 - tool.dba - INFO - insert data with sql
2022-07-30 05:11:37,343 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_GX_KS(LINE_NAME, POSTING_DATE) VALUES (:1, :2)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 48.29it/s]
2022-07-30 05:11:37,364 - tool.dba - INFO - insert finish
2022-07-30 05:11:37,364 - tool.dba - INFO - Delete data with sql
2022-07-30 05:11:37,364 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_GX_KS A
            where exists (
                select 1 from DZCB_PREDICT_GX_KS B where  A.LINE_NAME = B.LINE_NAME AND A.POSTING_DATE = B.POSTING_DATE )
            
2022-07-30 05:11:37,391 - tool.dba - INFO - Delete data finish
2022-07-30 05:11:37,419 - tool.dba - INFO - insert data with sql
2022-07-30 05:11:37,429 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_GX_KS(LINE_NAME, LINE_ID, POSTING_DATE, TRUE, PREDICT, ADVICE) VALUES (:1, :2, :3, :4, :5, :6)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 60.89it/s]
2022-07-30 05:11:37,447 - tool.dba - INFO - insert finish
2022-07-30 05:11:37,451 - tool.dba - INFO - Read data with sql
2022-07-30 05:11:37,451 - tool.dba - INFO - 
        SELECT *
        FROM ZCB_PREDICT_STORE_XS
        WHERE DS > TRUNC(SYSDATE - 31)
        
2022-07-30 05:11:38,576 - tool.dba - INFO - finish read total 169667 rows
2022-07-30 05:11:38,577 - tool.dba - INFO - Read data with sql
2022-07-30 05:11:38,577 - tool.dba - INFO - 
        SELECT A.ORGCODE STORE_ID,
               A.PLUCODE YH_PRODUCT_ID,
               SUM(A.PLUCOUNT) 消耗量
        FROM (
                 SELECT PS.ORGCODE, PS.PLUCODE, PLUCOUNT
                 FROM TZYPLUPRO_PS PS
                 WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                SELECT DI.PRODUCT_STORE_ID_TO AS ORGCODE,
                       DI.PRODUCT_ID          AS PLUCODE,
                       SUM(DI.QUANTITY)       AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID_TO,
                         DI.PRODUCT_ID
                UNION ALL
                SELECT DI.PRODUCT_STORE_ID    AS DCORGCODE,
                         DI.PRODUCT_ID          AS PLUCODE,
                       -1 *SUM(DI.QUANTITY)   AS PLUCOUNT
                FROM ZY_DB_ITEM DI
                WHERE 1 = 1
                  AND DI.POSTING_DATE > TRUNC(SYSDATE - 31) and DI.POSTING_DATE <= TRUNC(SYSDATE - 1) AND DI.AMOUNT2 > 0
                GROUP BY DI.PRODUCT_STORE_ID,
                         DI.PRODUCT_ID
                 UNION ALL
                 SELECT TH.ORGCODE, TH.PLUCODE, PLUCOUNT * -1 PLUCOUNT
                 FROM TZYPLUPRO_TH TH
                 WHERE TH.DZ_DATE > TRUNC(SYSDATE - 31) and TH.DZ_DATE <= TRUNC(SYSDATE - 1)
                   AND YJTOTAL > 0
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 31)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
                 UNION ALL
                 SELECT PD.PRODUCT_STORE_ID AS ORGCODE,
                        PD.PRODUCT_ID AS PLUCODE, 
                        SUM(PD.QUANTITY) AS PLUCOUNT  
                 FROM ZY_PD_ITEM PD 
                 WHERE PD.POSTING_DATE = TRUNC(SYSDATE - 1)  and PD.AMOUNT > 0
                 GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID
             ) A INNER JOIN (
              SELECT PS.ORGCODE, PS.PLUCODE, COUNT(*)
              FROM TZYPLUPRO_PS PS
              WHERE PS.RPTDATE > TRUNC(SYSDATE - 31) and PS.RPTDATE <= TRUNC(SYSDATE - 1)
               AND YJTOTAL > 0
              GROUP BY PS.ORGCODE, PS.PLUCODE
              HAVING COUNT(*) >= 20
             ) B ON A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE
        GROUP BY A.ORGCODE, A.PLUCODE, A.PLUCODE
        
2022-07-30 05:11:57,021 - tool.dba - INFO - finish read total 98233 rows
2022-07-30 05:11:57,288 - tool.dba - INFO - Read data with sql
2022-07-30 05:11:57,289 - tool.dba - INFO - 
        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE DS,
               SUM(PD.QUANTITY) AS 今日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 7)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-30 05:12:09,713 - tool.dba - INFO - finish read total 936819 rows
2022-07-30 05:12:09,713 - tool.dba - INFO - Read data with sql
2022-07-30 05:12:09,713 - tool.dba - INFO - 

        SELECT PD.PRODUCT_STORE_ID AS STORE_ID,
               PD.PRODUCT_ID AS YH_PRODUCT_ID, 
               PD.POSTING_DATE + 1 AS DS,
               SUM(PD.QUANTITY) AS 昨日库存  
        FROM ZY_PD_ITEM PD 
        WHERE PD.POSTING_DATE > TRUNC(SYSDATE - 8)  and PD.AMOUNT > 0
        GROUP BY PD.PRODUCT_STORE_ID, PD.PRODUCT_ID, PD.POSTING_DATE
2022-07-30 05:12:19,268 - tool.dba - INFO - finish read total 1092031 rows
2022-07-30 05:12:19,269 - tool.dba - INFO - Read data with sql
2022-07-30 05:12:19,269 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, YH_UNIT, YH_UNIT*PLUCOUNT 今日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 7)
2022-07-30 05:12:31,907 - tool.dba - INFO - finish read total 1242413 rows
2022-07-30 05:12:31,907 - tool.dba - INFO - Read data with sql
2022-07-30 05:12:31,907 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE DS, PLUCOUNT 今日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 7) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
2022-07-30 05:12:39,646 - tool.dba - INFO - finish read total 1012640 rows
2022-07-30 05:12:39,646 - tool.dba - INFO - Read data with sql
2022-07-30 05:12:39,646 - tool.dba - INFO - 


        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS,YH_UNIT*PLUCOUNT 昨日要货
        FROM TZYPLUPRO_YH A
        WHERE A.RPTDATE > TRUNC(SYSDATE - 8)
2022-07-30 05:12:52,513 - tool.dba - INFO - finish read total 1419504 rows
2022-07-30 05:12:52,513 - tool.dba - INFO - Read data with sql
2022-07-30 05:12:52,513 - tool.dba - INFO - 

        SELECT ORGCODE STORE_ID, PLUCODE YH_PRODUCT_ID, RPTDATE + 1 DS, PLUCOUNT 昨日配送
        FROM (
        SELECT ORGCODE, PLUCODE , RPTDATE , PSCOUNT + DRCOUNT - DCCOUNT - THCOUNT PLUCOUNT
        FROM  TRPTSALPLUKC_RT
        WHERE RPTDATE = TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS
        WHERE RPTDATE > TRUNC(SYSDATE - 8) AND RPTDATE < TRUNC(SYSDATE)
        UNION ALL
        SELECT  ORGCODE, PLUCODE , RPTDATE , PLUCOUNT
        FROM TZYPLUPRO_PS_RT
        WHERE RPTDATE > TRUNC(SYSDATE)
            ) A
            
2022-07-30 05:13:01,711 - tool.dba - INFO - finish read total 1184400 rows
2022-07-30 05:13:31,349 - tool.dba - INFO - Read data with sql
2022-07-30 05:13:31,349 - tool.dba - INFO - 
        SELECT PRODUCT_ID YH_PRODUCT_ID,
               CASE WHEN PARENT_PRODUCT_ID IS NOT NULL THEN PARENT_PRODUCT_ID
               ELSE PRODUCT_ID END PLUCODE  
        FROM PLUVIEW
           
2022-07-30 05:13:31,382 - tool.dba - INFO - finish read total 3299 rows
2022-07-30 05:13:34,864 - tool.dba - INFO - Delete data with sql
2022-07-30 05:13:35,018 - tool.dba - INFO - Create data with sql
2022-07-30 05:13:35,019 - tool.dba - INFO - 
        create table DZCB_PREDICT_STORE_YY (
            RPTDATE		DATE,
ORGCODE		VARCHAR2(999),
PLUCODE		VARCHAR2(999),
YH_PRODUCT_ID		VARCHAR2(999),
            constraint S20220730051335_pk primary key (RPTDATE,ORGCODE,PLUCODE,YH_PRODUCT_ID)
        )
        
2022-07-30 05:13:35,048 - tool.dba - INFO - Read data with sql
2022-07-30 05:13:35,049 - tool.dba - INFO - SELECT * FROM all_tab_comments
2022-07-30 05:13:35,305 - tool.dba - INFO - finish read total 8008 rows
2022-07-30 05:13:35,306 - tool.dba - INFO - create table finish
2022-07-30 05:13:35,306 - tool.dba - INFO - insert data with sql
2022-07-30 05:13:35,675 - tool.dba - INFO - INSERT INTO DZCB_PREDICT_STORE_YY(RPTDATE, ORGCODE, PLUCODE, YH_PRODUCT_ID) VALUES (:1, :2, :3, :4)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:03,  8.26it/s]  7%|▋         | 2/29 [00:00<00:03,  7.46it/s] 10%|█         | 3/29 [00:00<00:03,  7.57it/s] 14%|█▍        | 4/29 [00:00<00:03,  7.65it/s] 17%|█▋        | 5/29 [00:00<00:03,  6.68it/s] 21%|██        | 6/29 [00:00<00:03,  6.69it/s] 24%|██▍       | 7/29 [00:00<00:03,  6.83it/s] 28%|██▊       | 8/29 [00:01<00:03,  6.47it/s] 31%|███       | 9/29 [00:01<00:03,  6.50it/s] 34%|███▍      | 10/29 [00:01<00:03,  5.95it/s] 38%|███▊      | 11/29 [00:01<00:02,  6.39it/s] 41%|████▏     | 12/29 [00:01<00:02,  6.86it/s] 45%|████▍     | 13/29 [00:01<00:02,  7.15it/s] 48%|████▊     | 14/29 [00:02<00:02,  7.38it/s] 52%|█████▏    | 15/29 [00:02<00:02,  6.64it/s] 55%|█████▌    | 16/29 [00:02<00:01,  6.75it/s] 59%|█████▊    | 17/29 [00:02<00:01,  6.77it/s] 62%|██████▏   | 18/29 [00:02<00:01,  6.89it/s] 66%|██████▌   | 19/29 [00:02<00:01,  6.18it/s] 69%|██████▉   | 20/29 [00:02<00:01,  6.50it/s] 72%|███████▏  | 21/29 [00:03<00:01,  6.90it/s] 76%|███████▌  | 22/29 [00:03<00:01,  6.98it/s] 79%|███████▉  | 23/29 [00:03<00:00,  7.00it/s] 83%|████████▎ | 24/29 [00:03<00:00,  6.53it/s] 86%|████████▌ | 25/29 [00:03<00:00,  6.70it/s] 90%|████████▉ | 26/29 [00:03<00:00,  6.83it/s] 93%|█████████▎| 27/29 [00:03<00:00,  6.94it/s] 97%|█████████▋| 28/29 [00:04<00:00,  6.99it/s]100%|██████████| 29/29 [00:04<00:00,  6.26it/s]100%|██████████| 29/29 [00:04<00:00,  6.72it/s]
2022-07-30 05:13:39,989 - tool.dba - INFO - insert finish
2022-07-30 05:13:40,001 - tool.dba - INFO - Delete data with sql
2022-07-30 05:13:40,001 - tool.dba - INFO - 
            DELETE FROM ZCB_PREDICT_STORE_YY A
            where exists (
                select 1 from DZCB_PREDICT_STORE_YY B where  A.RPTDATE = B.RPTDATE AND A.ORGCODE = B.ORGCODE AND A.PLUCODE = B.PLUCODE AND A.YH_PRODUCT_ID = B.YH_PRODUCT_ID )
            
2022-07-30 05:13:52,599 - tool.dba - INFO - Delete data finish
2022-07-30 05:13:52,732 - tool.dba - INFO - insert data with sql
2022-07-30 05:13:53,222 - tool.dba - INFO - INSERT INTO ZCB_PREDICT_STORE_YY(RPTDATE, SAFETY_STOCK_RATE, ORGCODE, PLUCODE, RATE, XSCOUNT_PREDICT, YH_PRODUCT_ID, YH_UNIT, YHCOUNT_PREDICT, YH_COUNT, MAX_YH_COUNT, MIN_YH_COUNT, CREATE_TIME, EXEDATE, TS) VALUES (:1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15)
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [00:00<00:07,  3.91it/s]  7%|▋         | 2/29 [00:00<00:06,  3.87it/s] 10%|█         | 3/29 [00:00<00:07,  3.51it/s] 14%|█▍        | 4/29 [00:01<00:06,  3.82it/s] 17%|█▋        | 5/29 [00:01<00:06,  3.92it/s] 21%|██        | 6/29 [00:01<00:06,  3.66it/s] 24%|██▍       | 7/29 [00:04<00:22,  1.01s/it] 28%|██▊       | 8/29 [00:04<00:16,  1.29it/s] 31%|███       | 9/29 [00:04<00:12,  1.61it/s] 34%|███▍      | 10/29 [00:05<00:10,  1.87it/s] 38%|███▊      | 11/29 [00:05<00:08,  2.22it/s] 41%|████▏     | 12/29 [00:05<00:06,  2.53it/s] 45%|████▍     | 13/29 [00:05<00:05,  2.68it/s] 48%|████▊     | 14/29 [00:06<00:05,  2.95it/s] 52%|█████▏    | 15/29 [00:06<00:04,  3.12it/s] 55%|█████▌    | 16/29 [00:06<00:04,  3.11it/s] 59%|█████▊    | 17/29 [00:07<00:03,  3.25it/s] 62%|██████▏   | 18/29 [00:07<00:03,  3.37it/s] 66%|██████▌   | 19/29 [00:07<00:03,  3.25it/s] 69%|██████▉   | 20/29 [00:07<00:02,  3.47it/s] 72%|███████▏  | 21/29 [00:08<00:02,  3.55it/s] 76%|███████▌  | 22/29 [00:10<00:06,  1.15it/s] 79%|███████▉  | 23/29 [00:10<00:04,  1.45it/s] 83%|████████▎ | 24/29 [00:10<00:02,  1.76it/s] 86%|████████▌ | 25/29 [00:11<00:02,  1.98it/s] 90%|████████▉ | 26/29 [00:11<00:01,  2.31it/s] 93%|█████████▎| 27/29 [00:11<00:00,  2.56it/s] 97%|█████████▋| 28/29 [00:12<00:00,  2.74it/s]100%|██████████| 29/29 [00:12<00:00,  2.76it/s]100%|██████████| 29/29 [00:12<00:00,  2.32it/s]
2022-07-30 05:14:05,721 - tool.dba - INFO - insert finish
